!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="2d9ad85d-362e-3c7c-be99-ef3e0923510a")}catch(e){}}();
define(["exports","./e_file_viewer_static_scl_page_file","./c_core_i18n","./e_core_exception","./c_api_v2_unauthed_client"],(function(e,a,t,s,i){"use strict";function r(e){return e.ns("stacks")}const n=t.defineMessage({id:"uR54m8",defaultMessage:"Adding files to stackâ€¦"}),c=t.defineMessage({id:"SblH86",defaultMessage:"Files added to stack"}),d=t.defineMessage({id:"675k9a",defaultMessage:"No files to add to stack"});const o=t.defineMessage({id:"1X8idd",defaultMessage:"You are not allowed to create stacks"}),l=t.defineMessage({id:"nYWQEx",defaultMessage:"Invalid stack name"}),_=t.defineMessage({id:"gvdY8i",defaultMessage:"Stack data too large"}),f=t.defineMessage({id:"gR/wup",defaultMessage:"Failed to create stack"}),g=t.defineMessage({id:"hL9qv1",defaultMessage:"Failed to add items to stack"}),u=e=>{switch(e){case"not_allowed":return o;case"invalid_name":return l;case"stack_data_too_large":return _;case"enqueue_error":return g;default:return f}};e.GetStacksRoutes=r,e.STACK_SIZE_LIMIT=200,e.addFilesToStack=async function(e,t,i,o){if(!o.length)return a.Snackbar.fail(e.formatMessage(d)),!1;a.Snackbar.sync(e.formatMessage(n));try{return await r(new a.ActiveUserApiV2Client).rpc("create_fss_stack_item_batch_async",{parent_ns_id:i.namespace_id,item_list:o},{}),await new Promise((e=>setTimeout(e,Math.min(100*o.length,1e4)))),a.Snackbar.complete(e.formatMessage(c)),t(`/stacks/${i.sharing_id}`),!0}catch(t){return s.reportException({err:t,tags:["add-to-stack"]}),a.Snackbar.fail(e.formatMessage(g)),!1}},e.canAddToStack=e=>e.length<=200,e.createStackAndAddFiles=async function(e,t,o,l){var _;if(!o.length)return a.Snackbar.fail(e.formatMessage(d)),!1;a.Snackbar.sync(e.formatMessage(n));const f=r(new a.ActiveUserApiV2Client);try{const{stack:s}=await f.rpc("create_stack",{stack_data:{...l,creation_type:{".tag":"fss_stack"}}},{});if(!s||!s.sharing_id||!s.namespace_id){const e=new i.ApiError;throw e.error={".tag":"other"},e}return await f.rpc("create_fss_stack_item_batch_async",{parent_ns_id:s.namespace_id,item_list:o},{}),await new Promise((e=>setTimeout(e,Math.min(100*o.length,1e4)))),a.Snackbar.complete(e.formatMessage(c)),t(`/stacks/${s.sharing_id}`),!0}catch(t){s.reportException({err:t,tags:["create-stack-and-add-files"]});const r=i.filterApiError(t),n=r?null===(_=r.error)||void 0===_?void 0:_[".tag"]:void 0;return a.Snackbar.fail(e.formatMessage(u(n))),!1}},e.isContentEligibleForStack=function(e){return!e.is_encrypted}}));
//# sourceMappingURL=c_stacks_lib_api.js-vflM3UHG_.map

//# debugId=2d9ad85d-362e-3c7c-be99-ef3e0923510a