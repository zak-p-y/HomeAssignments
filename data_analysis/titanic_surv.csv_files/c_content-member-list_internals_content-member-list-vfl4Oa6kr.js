!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="cb3fb815-88d6-3f0a-a010-31fbad43b8d9")}catch(e){}}();
define(["exports","react","./e_file_viewer_static_scl_page_file","./c_core_i18n","./c_inband-screen_internals_share-modal-share","./c_common_components_buttons","./c_dig-icons_assets_ui-icon_line_share","./c_utils_dsx_dsx-react","./c_dig-icons_assets_ui-icon_line_team","./e_data_modules_stormcrow","./c_chat_chat_constants","./c_dig-illustrations_spot_bowl-empty","./e_core_exception","./c_dig-content-icons_icons_folder-shared-default-small","./c_dig-icons_assets_ui-icon_line_settings"],(function(e,t,a,n,r,s,o,i,l,c,m,d,u,_,g){"use strict";function p(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(a){if("default"!==a){var n=Object.getOwnPropertyDescriptor(e,a);Object.defineProperty(t,a,n.get?n:{enumerable:!0,get:function(){return e[a]}})}})),t.default=e,Object.freeze(t)}var f=p(t);const E=e=>e.formatMessage({id:"R8tdDL",defaultMessage:"Can edit"}),h=e=>e.formatMessage({id:"2kS9ex",defaultMessage:"Can view"}),b=e=>e.formatMessage({id:"pI4aSB",defaultMessage:"View-only"}),M=e=>e.formatMessage({id:"UznKXK",defaultMessage:"People can edit, delete, comment, and add the files to their Dropbox"}),S=e=>e.formatMessage({id:"ScDA/0",defaultMessage:"People can edit, delete, comment, and add the file to their Dropbox"}),A=e=>e.formatMessage({id:"WlnggN",defaultMessage:"People can edit, delete, and add items to this collection"}),v=e=>e.formatMessage({id:"jSEExB",defaultMessage:"People can view, download, and comment"}),I=e=>e.formatMessage({id:"svq/mv",defaultMessage:"People can view and download items in this collection"}),y=e=>e.formatMessage({id:"5AmS1v",defaultMessage:"People can only view and download the file"}),C=e=>e.formatMessage({id:"b0sjjf",defaultMessage:"Learn more"}),R=e=>e.formatMessage({id:"O1FxvA",defaultMessage:"This folder can only be shared as a link."}),L=e=>e.formatMessage({id:"QpEuIr",defaultMessage:"You can view this folder, but you’ll need to ask the folder owner to give you permission to share it."}),T=e=>e.formatMessage({id:"/8sefF",defaultMessage:"You can view this folder, but only the folder owner can share it."});function w(e){return{class:"sharing_sender",action:"hover",object:"flexible_sharing_entrypoint_action",properties:e}}function N(e){return{class:"sharing_sender",action:"log",object:"flexible_sharing_entrypoint_action_dwell_time",properties:e}}const P=Symbol("ON_CLICK_PROGRESSIVE"),F=Symbol("ON_MOUSE_ENTER_PROGRESSIVE"),x=Symbol("ON_MOUSE_LEAVE_PROGRESSIVE"),{useEmitter:D,defaultEmitter:k}=a.defineLogger((async({event:e,getContextValue:t})=>{const n=t(a.Context$1),s=t(a.Context$2),o=t(a.Context$3),i={...a.getTags$4(n),...a.getTags$5(s),...a.getTags$6(o)},l={...a.getProperties$4(n),...a.getProperties$5(s),...a.getProperties$6(o)};if(e.key===P)return a.UDCL.logEvent(r.PAP_Select_FlexibleSharingEntrypointAction({...l,flexibleSharingEntryPointAction:"inband_progressive",flexibleSharingEntryPointTimeToAction:e.payload.timeSinceView}),{tags:{...i,action:"inband_progressive"}}),void a.UDCL.logEvent(N({...l,flexibleSharingEntryPointAction:"inband_progressive",flexibleSharingEntryPointDwellTime:e.payload.dwellTime,flexibleSharingEntryPointDwellActionSelected:!0}),{tags:{...i,action:"inband_progressive"}});if(e.key!==F){if(e.key!==x)return a.exhausts(e,void 0);a.UDCL.logEvent(N({...l,flexibleSharingEntryPointAction:"inband_progressive",flexibleSharingEntryPointDwellTime:e.payload.dwellTime,flexibleSharingEntryPointDwellActionSelected:!1}),{tags:{...i,action:"inband_progressive"}})}else a.UDCL.logEvent(w({...l,flexibleSharingEntryPointAction:"inband_progressive"}),{tags:{...i,action:"inband_progressive"}})})),O=({accountMetadata:e})=>{const t=n.useIntl(),s=r.useOpenUrl(),o=r.getIsTeamAdmin(e),i=o?(e=>e.formatMessage({id:"QV0fMP",defaultMessage:"To share this folder, manage access in the admin console."}))(t):(e=>e.formatMessage({id:"C87Oa/",defaultMessage:"Only admins can directly share this content. Reach out and ask them to share it."}))(t),l=o?(e=>e.formatMessage({id:"S839MU",defaultMessage:"Go to admin console"}))(t):(e=>e.formatMessage({id:"0KHhX0",defaultMessage:"Find admin"}))(t);return f.createElement(a.Box,null,f.createElement(a.Text,{size:"medium","data-testid":"tmr-team-folder-subtitle"},i),f.createElement(a.Box,{marginTop:"Micro Large"},f.createElement(a.Button,{variant:"transparent",onClick:()=>{s(o?"/team/admin/content/home":"/team?_tk=left_nav_team")}},l)))};O.displayName="TmrTeamFolder";const B=e=>{var t;const{objectMetadata:i,accountMetadata:l,onInbandButtonClicked:c,componentViewTime:m}=e,d=a.isNewApiMetadata(i),[u,_]=f.useState(!1),[g,p]=f.useState(!1),[E,h]=f.useState(0),b=f.useRef(null),M=D(),S=a.getCanInvite(i,r.VIEWER),A=a.getCanInvite(i,r.EDITOR)||S,v=a.getIsLinkOnlyMode(i),I=a.getIsNSLinkOnlyMode(i),y=a.getIsFolder(i),w=r.isUserOnSameTeamAsObject(l,i),N=r.isUserOnSameTeamAsTmrTeamFolder(l,i),k=!!a.getOwnerTeam(i),B=null!==(t=a.getOwnerTeamName(i))&&void 0!==t?t:"",j=a.getIsTeamSharedFolder(i),$="https://help.dropbox.com/files-folders/share/shared-folder-faq#cantcreate",U=r.useOpenUrl(),H=f.useCallback((e=>{U(e)}),[U]),Z=()=>{switch(a.getInviteDeniedReason(i)){case"mount_exceeded":return f.createElement(a.Text,null,((e,t)=>{if(!t.metadata_response||!a.getIsFolder(t))return;const n=t.metadata_response;if(n.invite_viewer_folder_perm.invite_viewer_folder_denied_reason&&"mount_exceeded"===n.invite_viewer_folder_perm.invite_viewer_folder_denied_reason[".tag"]){const t=n.invite_viewer_folder_perm.invite_viewer_folder_denied_reason,a=t.limit,r=t.new_count-a;return e.formatMessage({id:"f3Mx9B",defaultMessage:"This folder can only be shared as a link because your Dropbox folder is {number, plural, one{1 shared folder} other {{number} shared folders}} over limit."},{number:r})}})(n.intl,i),f.createElement(a.Link,{style:{marginLeft:3},hasNoUnderline:!0,onClick:()=>H($),href:"",isBold:!0},C(n.intl)));case"contains_app_folder":case"inside_app_folder":case"is_app_folder":case"is_family_folder":return f.createElement(a.Text,null,R(n.intl));default:return f.createElement(a.Text,null,w?L(n.intl):T(n.intl))}},W=f.useCallback((()=>{const e=g?Date.now()-E:void 0,t=Date.now()-m;M.select(P).emit({dwellTime:e,timeSinceView:t}),c()}),[m,M,g,c,E]),G=f.useCallback((()=>{h(Date.now()),p(!0),M.select(F).emit(null),_(!0)}),[M]),V=f.useCallback((()=>{const e=g?Date.now()-E:void 0;p(!1),M.select(x).emit({dwellTime:e}),_(!1)}),[M,g,E]),z=d?!A:v||!A;return f.createElement(f.Fragment,null,f.createElement(s.ButtonWrapper,{ref:b,onMouseEnter:G,onMouseLeave:V,"data-uxa-log":"sm24-inband-button."+(z?"disabled":"loaded"),"data-uxa-interactions":"shown click"},f.createElement(s.HorizontalButton,{onClick:W,disabled:z,"data-testid":"inband-sharing-entry-button"},f.createElement(s.ButtonIconContainer,null,f.createElement(a.UIIcon,{src:o.ShareLine,size:"medium"})),f.createElement(s.ButtonInnerColumn,null,f.createElement(s.ButtonTitle,{content:(Y=n.intl,Y.formatMessage({id:"SC4EWs",defaultMessage:"Add people"}))})))),(()=>{let e=null;return d?N&&!A?e=f.createElement(O,{accountMetadata:l}):A||(e=Z()):v?e=(()=>{switch(v?I?"isNSLinkOnlyMode":"isFamily":"isLimitedPermissions"){case"isNSLinkOnlyMode":return f.createElement(a.Text,null,((e,t)=>{if(t.tooManyMountsError&&("total_mounts_exceeded"===t.tooManyMountsError[".tag"]||"home_mounts_exceeded"===t.tooManyMountsError[".tag"]||"tree_size_exceeded"===t.tooManyMountsError[".tag"])){const a=t.tooManyMountsError.limits_info;if(a){const t=a.limit,n=a.new_count-t;return e.formatMessage({id:"f3Mx9B",defaultMessage:"This folder can only be shared as a link because your Dropbox folder is {number, plural, one{1 shared folder} other {{number} shared folders}} over limit."},{number:n})}}})(n.intl,i),f.createElement(a.Link,{style:{marginLeft:3},hasNoUnderline:!0,onClick:()=>H($),href:"",isBold:!0},C(n.intl)));case"isLimitedPermissions":return k&&!w?j?f.createElement(a.Text,null,(e=n.intl,void 0!==(t=B)?e.formatMessage({id:"ToMYBy",defaultMessage:"This folder can only be managed by the {ownerTeamName} team."},{ownerTeamName:t}):e.formatMessage({id:"ReqZ5Y",defaultMessage:"This folder can only be managed by the owner team."}))):y?f.createElement(a.Text,null,(e=>e.formatMessage({id:"5iJXBE",defaultMessage:"You don’t have permission to manage membership of this folder"}))(n.intl)):f.createElement(a.Text,null,(e=>e.formatMessage({id:"WVaUHn",defaultMessage:"You don’t have permission to manage membership of this file"}))(n.intl)):f.createElement(a.Text,null,(e=>e.formatMessage({id:"TnTBTY",defaultMessage:"This can only be shared with the link."}))(n.intl));case"isFamily":return f.createElement(a.Text,null,R(n.intl))}var e,t})():N&&!A?e=f.createElement(O,{accountMetadata:l}):A||(e=f.createElement(a.Text,null,w?L(n.intl):T(n.intl))),e?f.createElement(a.Tooltip.Control,{open:u,placement:"top",auto:!0,triggerRef:b,onMouseEnter:()=>_(!0),onMouseLeave:()=>_(!1)},e):null})());var Y};B.displayName="InbandEntryButtonInner";const j=e=>{const{oid:t,onInbandButtonClicked:n,componentViewTime:o}=e,i=a.useSharingObjectMetadata(t.fileId),l=r.useSharingAccountInfo(),c=i.isLoading,m=!i.isLoading&&i.isError,d=c||m?void 0:i.output,u=l.isLoading,_=!l.isLoading&&l.isError,g=u||_?void 0:l.output;return c||u?f.createElement(s.ButtonWrapper,{"data-uxa-log":"sm24-inband-button.loading","data-uxa-interactions":"shown click"},f.createElement(s.HorizontalButton,{disabled:!0},f.createElement(a.Skeleton.Avatar,{size:"medium",style:{marginRight:"var(--dig-spacing__dimension__12)"}}),f.createElement(a.Skeleton.Text,{size:"large",width:200}))):d&&g?f.createElement(B,{accountMetadata:g,objectMetadata:d,onInbandButtonClicked:n,componentViewTime:o}):null};j.displayName="InbandEntryButton";const $=({objectMetadata:e,accountMetadata:t,canInvite:i,handleButtonClick:l,componentViewTime:c})=>{const[m,d]=f.useState(!1),[u,_]=f.useState(0),[g,p]=f.useState(!1),E=f.useRef(null),h=D(),b=r.isUserOnSameTeamAsTmrTeamFolder(t,e),M=f.useCallback((()=>{const e=m?Date.now()-u:void 0,t=Date.now()-c;h.select(P).emit({dwellTime:e,timeSinceView:t}),l()}),[c,h,l,m,u]),S=f.useCallback((()=>{_(Date.now()),d(!0),h.select(F).emit(null),p(!0)}),[h]),A=f.useCallback((()=>{const e=m?Date.now()-u:void 0;d(!1),h.select(x).emit({dwellTime:e}),p(!1)}),[h,m,u]),v=r.getIsTeam(t);return f.createElement(f.Fragment,null,f.createElement(s.ButtonWrapper,{ref:E,onMouseEnter:S,onMouseLeave:A},f.createElement(s.HorizontalFlatButton,{onClick:M,disabled:!i,"data-testid":"inband-sharing-entry-button",autoFocus:!0},f.createElement(s.ButtonIconContainer,null,f.createElement(a.UIIcon,{src:o.ShareLine,size:"small"})),f.createElement(s.ButtonInnerColumn,null,f.createElement(a.Text,{color:"subtle",style:{marginLeft:-3,marginTop:4}},f.createElement(a.Truncate,{lines:2},v?n.intl.formatMessage({id:"I1N8uC",defaultMessage:"Add an email, name, or group"}):(e=>e.formatMessage({id:"RynZbM",defaultMessage:"Add an email or name"}))(n.intl)))))),(()=>{let s=null;if(b&&!i)s=f.createElement(O,{accountMetadata:t});else if(!i){const o=r.isUserOnSameTeamAsObject(t,e);s=f.createElement(a.Text,null,o?L(n.intl):T(n.intl))}return s?f.createElement(a.Tooltip.Control,{open:g,placement:"top",auto:!0,triggerRef:E,onMouseEnter:()=>p(!0),onMouseLeave:()=>p(!1)},s):null})())};$.displayName="Inner";const U=({oid:e,onTokenizerButtonClick:t,componentViewTime:n})=>{const o=a.useSharingObjectMetadata(e.fileId),i=r.useSharingAccountInfo(),l=o.isLoading,c=!o.isLoading&&o.isError,m=l||c?void 0:o.output,d=i.isLoading,u=!i.isLoading&&i.isError,_=d||u?void 0:i.output,g=l||d,p=!g&&m&&_;if(g)return f.createElement(s.ButtonWrapper,null,f.createElement(s.HorizontalButton,{disabled:!0},f.createElement(a.Skeleton.Avatar,{size:"medium",style:{marginRight:"var(--dig-spacing__dimension__12)"}}),f.createElement(a.Skeleton.Text,{size:"large",width:200})));if(p){const e=a.getCanInvite(m,r.VIEWER)||a.getCanInvite(m,r.EDITOR);return f.createElement($,{accountMetadata:_,objectMetadata:m,canInvite:e,handleButtonClick:t,componentViewTime:n})}return null};U.displayName="TokenizerButton";const H=e=>{const t=function(e){const{isNonUserRelativeContext:t}=a.useSharingApiContext(),n=a.getContentIdOrPathFromObjectIdentifier(e);return a.seenStateInfoPackage.useQuery({apiArg:{file_infos:[{file_identifier:n}],limit:150}},{staleTime:3e5,enabled:"file"===e[".tag"]&&!t})}(e),{isNonUserRelativeContext:n}=a.useSharingApiContext();return f.useMemo((()=>!t||"file"!==e[".tag"]||n?{isLoading:!1,isError:!1,output:{seen_state_info:{seen_states:[]},file_info:{}}}:t.isLoading||!t.data?{isLoading:!0}:t.error?{isLoading:!1,isError:!0,error:t.error.appError}:t.data.apiData&&0!==t.data.apiData.length?{output:t.data.apiData[0],isLoading:!1,isError:!1}:{isLoading:!1,isError:!1,output:{seen_state_info:{seen_states:[]},file_info:{}}}),[t,e,n])};const Z=(e,t)=>{const n=[],r=t&&null!==a.getEditLinkMetadata(t),s=t&&null!==a.getViewLinkMetadata(t);if(!e)return n;for(const t of e.seen_state_info.seen_states)if(!W.isAnonymousSeenState(t)){const e=t.seen_state_user.sharing_access_type;if(e)switch(e[".tag"]){case"link_only":n.push(t);break;case"view_link_access":s&&n.push(t);break;case"edit_link_access":r&&n.push(t)}}return n};var W;!function(e){function t(e){return e.startsWith("dbafvid:")}e.isAnonymousUserId=t,e.isAnonymousSeenState=e=>t(e.seen_state_user.user_id)}(W||(W={}));const G=e=>{const t=V(e);return f.useMemo((()=>{if(!t||t.isLoading)return{isLoading:!0};if(t.isError)return{isError:!0,isLoading:!1,error:t.error.appError};{const e={};return Object.values(t.data.apiData).forEach((t=>{e[t.account_id]=t})),{isError:!1,isLoading:!1,output:e}}}),[t])},V=e=>a.getAccountBatchPackage.useQuery({apiArg:{account_ids:e}},{enabled:e.length>0,staleTime:3e5,keepPreviousData:!0}),z=e=>{const t=Y(e),{isNonUserRelativeContext:n}=a.useSharingApiContext();return f.default.useMemo((()=>n?{isLoading:!1,isError:!1,output:{links:[],has_more:!1}}:!t||t.isLoading?{isLoading:!0}:t.isError?{isError:!0,isLoading:!1,error:t.error.appError}:{isError:!1,isLoading:!1,output:t.data.apiData}),[t,n])},Y=e=>{const{isNonUserRelativeContext:t}=a.useSharingApiContext(),n=a.getContentIdOrPathFromObjectIdentifier(e);return a.sharingListSharedLinksPackage.useQuery({apiArg:{path:n,direct_only:!0}},{staleTime:3e5,enabled:!t})};const q={$props:i.atom({onClick:()=>{},onView:()=>{},oid:{".tag":"file",fileId:""},disableRightChevron:!1,objectMetadataResult:{isLoading:!0},objectMembersResult:{isLoading:!0,isFirstPageLoaded:!1},listSharedLinksResult:{isLoading:!0},seenStateInfoResult:{isLoading:!0},accountDataBatchResult:{isLoading:!0},intl:n.createIntl({locale:"en"})})},{StoreProvider:Q,useStore:J}=i.defineStoreProvider((e=>({$props:e})),q),K=e=>{const t=n.useIntl(),{user:r}=a.useActiveUser(),s=a.useSharingObjectMetadata(e.oid.fileId),o=a.useObjectMembers(e.oid),i=z(e.oid),l=H(e.oid),c=((e,t)=>{const a=[];return e.isFirstPageLoaded&&e.isFirstPageOnly?(e.firstPage.users.map((e=>a.push(e.user.account_id))),0===e.firstPage.users.length&&t&&a.push(t.account_id),a):[]})(o,r),m=G(c);return f.createElement(Q,{intl:t,objectMetadataResult:s,objectMembersResult:o,listSharedLinksResult:i,seenStateInfoResult:l,accountDataBatchResult:m,...e})};a.injectInternalStyle("/static/metaserver/static/js/sharing/sharing-sdk/legos/content-member-facepile-button/internals/button.module.out-vflo0kUrj.css",(e=>"._base-button_pkzqg_1{background:var(--dig-color__background__base);border:1px solid var(--dig-color__border__subtle);border-radius:var(--dig-radius__large);cursor:pointer;width:100%;word-break:break-word}._base-button_pkzqg_1:focus-visible{box-shadow:var(--dig-utilities__boxshadow__focus-ring)!important}._base-button_pkzqg_1:hover:not(:disabled){background:var(--dig-color__secondary__surface)}._base-button_pkzqg_1:active:not(:disabled){background:var(--dig-color__secondary__surface--state-1)}._content-member-facepile-button_pkzqg_22{background-color:var(--dig-color__opacity__surface--state-1);border:0;border-radius:17px;color:var(--dig-color__text__subtle);height:34px;margin-right:8px}._content-member-facepile-button-facepile_pkzqg_31{padding-left:12px}._content-member-facepile-button-facepile-other-item_pkzqg_35>*>div{background:var(--dig-color__secondary__surface--state-1)}._content-member-facepile-button-icon-container_pkzqg_40{align-items:center;display:flex;height:100%;justify-content:center}"));const X="_base-button_pkzqg_1",ee="_content-member-facepile-button_pkzqg_22",te="_content-member-facepile-button-facepile_pkzqg_31",ae="_content-member-facepile-button-facepile-other-item_pkzqg_35",ne="_content-member-facepile-button-icon-container_pkzqg_40",re=(e,t)=>f.default.createElement(a.Facepile.Item,{key:e,alt:t.name.display_name,cursor:"pointer","aria-label":t.name.display_name,src:t.profile_photo_url,"data-testid":"content-member-avatar"},oe(t.name.display_name)),se=(e,t)=>f.default.createElement(a.Facepile.Item,{key:e,cursor:"pointer","aria-label":t.user.display_name+" "+t.user.email,"data-testid":"content-member-avatar"},oe(t.user.display_name));function oe(e){return function(e){if(null==e||!(e.length>0))return"";const t=e.split(" ");let a=t.map((e=>e.charAt(0).toLowerCase()));a.length>2&&(a=a.splice(0,2));return a.join("")}(e).toUpperCase()}const ie=({disableRightChevron:e})=>f.default.createElement("div",{className:te,style:{paddingLeft:e?"12px":"8px",paddingRight:e?"6px":"0px"}},f.default.createElement(a.Facepile,{size:"xsmall",isInteractive:!1,interactivity:"Avatar"},new Array(3).fill(0).map(((e,t)=>(e=>f.default.createElement(a.Facepile.Item,{key:e,"data-testid":"skeleton-avatar"},f.default.createElement(a.Skeleton.Avatar,{size:"xsmall"})))(t))))),le=e=>{const{accountData:t,objectMembers:n,disableRightChevron:r}=e,{user:s}=a.useActiveUser();let o=0,i=[];const{groups:c,users:m,invitees:d}=n,u=s?t[s.account_id]:void 0;var _;return u?i.push(re(o++,u)):s&&i.push(se(o++,(e=>({user:{account_id:e.account_id,email:e.email,display_name:e.display_name,same_team:!0,disabled:!1}}))(s))),c.forEach((e=>{i.push(((e,t)=>"team"===t.group.group_type[".tag"]?f.default.createElement(a.Facepile.Item,{key:e,cursor:"pointer",alt:t.group.group_name,"aria-label":t.group.group_name,"data-testid":"content-member-avatar"},f.default.createElement(a.UIIcon,{src:l.TeamLine,role:"presentation"})):f.default.createElement(a.Facepile.Item,{key:e,cursor:"pointer",alt:t.group.group_name,"aria-label":t.group.group_name,"data-testid":"content-member-avatar"},oe(t.group.group_name)))(o++,e))})),m.forEach((e=>{if(s&&e.user.account_id===s.account_id)return;const a=t[e.user.account_id];if(a){const e=re(o++,a);i.push(e)}else{const t=se(o++,e);i.push(t)}})),d.forEach((e=>{const t=((e,t)=>{var n,r;const s="email"===t.invitee[".tag"]?t.invitee.email:null===(n=t.user)||void 0===n?void 0:n.display_name;return f.default.createElement(a.Facepile.Item,{key:e,cursor:"pointer","aria-label":s,alt:null===(r=t.user)||void 0===r?void 0:r.display_name,"data-testid":"content-member-avatar"},oe(s))})(o++,e);i.push(t)})),i.length>3&&(i=i.slice(0,2),i.push((_=o++,f.default.createElement(a.Facepile.Item,{className:ae,key:_,cursor:"pointer",colorPalette:{background:"#00000000",foreground:"var(--dig-color__text__base)"},"data-testid":"content-member-avatar"},f.default.createElement(a.UIIcon,{src:a.PersonMultipleLine,role:"presentation"}))))),f.default.createElement("div",{className:te,style:{paddingRight:r?"6px":"0px"}},f.default.createElement(a.Facepile,{size:"xsmall",isInteractive:!1,interactivity:"Avatar"},i))};le.displayName="ContentMemberFacepileButtonFacepile";const ce=({children:e,accountData:t,objectMembers:r,objectMetadata:s})=>{const o=n.useIntl(),{user:i}=a.useActiveUser(),l=f.default.useMemo((()=>{if(a.getIsNonSharedFolder(s)&&a.getParentFolderName(s))return((e,t)=>e.formatMessage({id:"9P0o7J",defaultMessage:"All users with access to <b>{parentFolderName}</b> have access"},{parentFolderName:t,b:e=>f.default.createElement("b",null,e)}))(o,a.getParentFolderName(s));let e=!1,n=[];const{groups:l,users:c,invitees:m}=r;return c.forEach((e=>{if(!i||e.user.account_id!==i.account_id)if(Object.keys(t).length>0){const a=t[e.user.account_id];a&&n.push(a.name.display_name)}else n.push(e.user.display_name.split(" ")[0])})),l.forEach((e=>{var t;n.push(((e,t,a)=>"team"===a?e.formatMessage({id:"dQzOmZ",defaultMessage:"Everyone at {team_name}"},{team_name:t.replace(/^Everyone at /,"")}):t)(o,e.group.group_name,null===(t=e.group.group_type)||void 0===t?void 0:t[".tag"]))})),m.forEach((t=>{var a,r;"email"===t.invitee[".tag"]?n.push(null!==(r=null===(a=t.user)||void 0===a?void 0:a.display_name)&&void 0!==r?r:t.invitee.email):e=!0})),n.length>3&&(e=!0,n=n.slice(0,3)),0===n.length?e?(e=>e.formatMessage({id:"EHtbiI",defaultMessage:"Others have access"}))(o):(e=>e.formatMessage({id:"oW+UlP",defaultMessage:"Only you have access"}))(o):e?((e,t)=>1===t.length?e.formatMessage({id:"kK5uwj",defaultMessage:"{member} and others have access"},{member:t[0]}):e.formatMessage({id:"jf6sct",defaultMessage:"{listOfMembers}, and others have access"},{listOfMembers:t.join(", ")}))(o,n):((e,t)=>1===t.length?e.formatMessage({id:"eRyaP6",defaultMessage:"{memberName} has access"},{memberName:t[0]}):2===t.length?e.formatMessage({id:"xi7j54",defaultMessage:"{firstMember} and {secondMember} have access"},{firstMember:t[0],secondMember:t[1]}):e.formatMessage({id:"seGTYd",defaultMessage:"{allButLastMember}, and {lastMember} have access"},{allButLastMember:t.slice(0,-1).join(", "),lastMember:t[t.length-1]}))(o,n)}),[s,r,o,i,t]);return f.default.createElement(a.Tooltip,{title:l,placement:"bottom",maxWidth:160},f.default.createElement("div",null,e))};ce.displayName="ContentMemberFacepileButtonTooltip";const me=[{action:{".tag":"make_editor"},allow:!1},{action:{".tag":"make_owner"},allow:!1},{action:{".tag":"make_viewer"},allow:!1},{action:{".tag":"make_viewer_no_comment"},allow:!1},{action:{".tag":"remove"},allow:!1}],de=()=>{const e=J(),{disableRightChevron:t}=i.useAtom(e.$props);return f.default.createElement(a.StylelessButton,{"data-testid":"content-member-facepile-button",className:a.cx(X,ee)},f.default.createElement(ie,{disableRightChevron:t}),!0!==t&&f.default.createElement(a.Box,{className:ne},f.default.createElement(a.UIIcon,{size:"small",src:a.ChevronRightLine})))},ue=()=>{const e=J(),t=i.useAtom(e.$props),{objectMetadataResult:a,objectMembersResult:n,listSharedLinksResult:r,seenStateInfoResult:s,accountDataBatchResult:o,onView:l}=t,c=f.default.useRef(!1),m=a.isLoading,d=!a.isLoading&&!a.isError,u=n.isLoading,_=n.isFirstPageLoaded&&n.isFirstPageOnly,g=!r.isLoading&&!r.isError,p=g?r.output:void 0,E=r.isLoading,h=s.isLoading||s.isError?void 0:s.output,b=Z(h,p),M=(S=b)?S.map((e=>{const{seen_state_user:{user_id:t,display_name:a,email:n,sharing_access_type:r,same_team:s},when_last_seen:o}=e;let i={".tag":"viewer"};return r&&"edit_link_access"===r[".tag"]&&(i={".tag":"editor"}),{access_type:i,user:{account_id:t,display_name:a,email:n||"",same_team:s,disabled:!1},is_inherited:!1,permissions:me,time_last_seen:o?new Date(1e3*o).toString():void 0}})):[];var S;const A=(e=>{if(!e)return{};const t={};return e.forEach((e=>{const{seen_state_user:{user_id:a,display_name:n,email:r,photo_circle_url:s,same_team:o}}=e,i={account_id:a,name:{given_name:"",surname:"",familiar_name:"",display_name:n,abbreviated_name:""},email:r||"",email_verified:!0,profile_photo_url:s,is_teammate:o,disabled:!1};t[a]=i})),t})(b),v=!o.isLoading&&!o.isError,I=_&&d&&g,y=u||m||E;if(f.default.useEffect((()=>{!c.current&&I&&(c.current=!0,l())}),[I,l]),I){const e={...n.firstPage};e.users=[...e.users,...M];const t=v?{...o.output,...A}:A;return f.default.createElement(_e,{objectMetadata:a.output,objectMembers:e,accountData:t})}return y?f.default.createElement(de,null):null};ue.displayName="ContentMemberFacepileButtonWithStore";const _e=({objectMembers:e,accountData:t,objectMetadata:r})=>{const s=J(),{onClick:o,disableRightChevron:l}=i.useAtom(s.$props);return f.default.createElement(ce,{objectMembers:e,accountData:t,objectMetadata:r},f.default.createElement(a.StylelessButton,{className:a.cx(X,ee),onClick:o,"data-uxa-log":"content_member_facepile_button","data-testid":"content-member-facepile-button","aria-label":n.intl.formatMessage({id:"B+lBmk",defaultMessage:"Manage access"}),"aria-controls":"sm24-access-management-member-list"},f.default.createElement(le,{objectMembers:e,accountData:t,disableRightChevron:l}),!0!==l&&f.default.createElement(a.Box,{className:ne},f.default.createElement(a.UIIcon,{size:"small",src:a.ChevronRightLine}))))};_e.displayName="ContentMemberFacepileButtonInner";const ge=e=>f.default.createElement(n.Provider,{value:n.intl},f.default.createElement(K,{...e},f.default.createElement(ue,null)));var pe;function fe(e){return{class:"share",action:"view",object:"manage_access",properties:e}}ge.displayName="ContentMemberFacepileButton",function(e){e.SUCCESS="SUCCESS",e.ERROR="ERROR",e.FATAL="FATAL"}(pe||(pe={}));const Ee=["altText","inverse"];var he=e=>{let{altText:t,inverse:n}=e,r=m._objectWithoutProperties(e,Ee);const{getInverseProps:s}=a.useTheme(),{className:o}=s(),i="dig-Illustration dig-13or4mr1_4-5-0 dig-Illustration-spot"+(n?o+" dig-Illustration--inverse":"");return f.createElement("svg",m._objectSpread2(m._objectSpread2({role:"presentation"},r),{},{className:i,viewBox:"0 0 500 500",fill:"none",xmlns:"http://www.w3.org/2000/svg"}),f.createElement("title",null,t),f.createElement("g",{fillRule:"evenodd",clipRule:"evenodd"},f.createElement("path",{d:"M136.608 219.783c-.342.342-9.166.718-21.52.916-7.467.12-15.13.436-17.029.703-3.389.477-9.153 2.017-17.153 4.585-6.83 2.192-12.763 6.926-12.763 10.183 0 1.285.948 2.347 1.922 2.153.335-.068 1.23.205 1.99.604.76.398 4.653 1.698 8.653 2.888 4 1.189 7.935 2.426 8.745 2.748.81.322 3.957.95 6.995 1.396 3.038.447 6.766 1.109 8.285 1.472 1.519.363 6.179.859 10.355 1.102 4.177.243 11.323.694 15.879 1.001 4.557.307 13.877.571 20.712.585 8.356.017 13.439.225 15.519.636 3.939.776 5.306.256 6.821-2.6 1.333-2.514 2.347-3.199 6.052-4.092 3.643-.877 11.22-.573 18.783.754 2.912.511 6.743.935 8.515.941 3.191.012 4.857.217 12.887 1.585 2.278.388 7.456 1.117 11.507 1.621 10.391 1.293 17.48 3.696 23.671 8.026 2.213 1.547 4.645 2.044 10.21 2.082 2.18.015 5.079.239 6.443.498 1.363.258 8.044.572 14.844.696 6.801.124 12.567.351 12.814.503.247.153 5.245.251 11.108.218 7.33-.041 12.921.188 17.904.731 6.665.728 7.291.732 7.824.048.495-.635 1.152-.691 4.488-.383 7.189.664 11.632-.544 23.937-6.505 6.357-3.08 6.87-3.434 10.816-7.446 6.363-6.469 6.816-7.896 3.777-11.88-2.419-3.171-5.583-5.312-8.328-5.636-5.711-.673-60.96-3.99-80.826-4.853-12.024-.522-24.348-1.154-27.385-1.404-3.038-.251-9.05-.661-13.36-.913-4.309-.25-8.81-.59-10.001-.753-2.464-.337-2.424-.387-2.867 3.573-.354 3.163-2.526 7.021-4.839 8.594-1.379.938-2.011 1.065-4.386.882-3.063-.236-6.457-1.712-6.84-2.975-.136-.447-.29-2.946-.343-5.552-.052-2.607-.258-4.839-.456-4.962-.352-.218-14.986-.809-35.019-1.415l-9.993-.302.242 1.567c.133.861-.049 2.39-.405 3.397-.614 1.734-.791 1.862-3.366 2.419-2.754.595-6.588.424-8.051-.358-1.155-.618-2.849-3.547-3.16-5.464l-.269-1.649-11.603-.049c-6.381-.027-11.662.011-11.736.084Z",fill:"#14C8EB"}),f.createElement("path",{d:"M220.118 164.552c-1.416 1.416-.008 5.05 2.264 5.842 3.399 1.185 5.468.37 5.468-2.153 0-2.364-2.291-4.241-5.176-4.241-1.102 0-2.252.249-2.556.552Zm4.555.86c2.176 1.55 1.652 4.571-.793 4.571-1.146 0-2.933-1.981-2.933-3.25 0-.898 1.16-2.273 1.917-2.273.26 0 1.073.429 1.809.952Zm-15.348 2.998c-2.979 1.606-.271 4.964 3.809 4.723 2.868-.169 5.32 2.581 7.969 8.937.709 1.702.706 1.722-.225 1.224-.52-.279-1.702-.567-2.625-.642a37.632 37.632 0 0 1-3.431-.475c-1.47-.285-1.932-.17-2.876.718-1.563 1.468-1.425 2.99.44 4.854 1.799 1.799 2.38 1.89 3.914.613.849-.707 1.117-1.402 1.151-2.977.05-2.325.538-2.534 3.264-1.394 1.124.469 1.655 1.034 1.842 1.956.145.713.463 1.932.707 2.709.626 1.993.553 3.217-.233 3.869-.52.431-.707 1.959-.806 6.561l-.128 5.998-4.279 1.078c-3.882.978-4.608 1.345-7.825 3.954-1.949 1.58-3.782 3.191-4.072 3.578a40.945 40.945 0 0 1-1.507 1.822c-.991 1.133-1.06 1.916-.193 2.205.261.087 2.219-1.671 4.351-3.906 4.932-5.172 6.062-5.986 9.409-6.786 4.149-.99 4.369-.947 4.063.81-.144.823-.707 2.842-1.252 4.488-.857 2.588-.991 4.044-.993 10.816-.003 7.392.055 7.904 1.039 9.284 1.448 2.031 4.462 3.114 7.726 2.777 3.431-.354 5.138-1.466 6.672-4.344 1.703-3.199 1.934-4.452 1.886-10.263-.045-5.46-.716-7.418-4.039-11.769-1.241-1.627-1.683-2.704-1.844-4.498-.867-9.639-1.045-10.639-2.041-11.449-.544-.443-1.484-.806-2.089-.806-.965 0-1.099-.211-1.093-1.726.008-1.971 1.062-6.75 1.89-8.567.492-1.08.743-1.191 2.111-.934 2.852.535 4.598-2.579 2.333-4.165-1.554-1.089-2.493-.872-3.833.884-1.233 1.617-3.393 7.783-3.47 9.906-.035.98-.108.917-.494-.427-.249-.867-.593-4.785-.764-8.707-.221-5.066-.478-7.186-.886-7.321-.437-.145-.577 1.013-.58 4.795l-.004 4.986-1.372-2.391c-1.218-2.124-4.999-5.663-6.05-5.663-.217 0-.394-.586-.394-1.301 0-1.379-1.411-3.009-2.992-3.456-.506-.144-1.489.046-2.186.422Zm3.346 1.131c.276.515.369 1.355.207 1.867-.455 1.436-3.15 1.053-3.366-.478-.283-2.003 2.238-3.111 3.159-1.389Zm19.443 7.621c.46.46-.135 1.469-1.324 2.248-1.627 1.067-2.215.425-1.076-1.174.913-1.283 1.797-1.678 2.4-1.074Zm-16.235 6.393c.601.724.305 2.771-.549 3.8-.676.816-2.516.719-2.849-.15-.497-1.296-.299-2.299.659-3.327 1.097-1.177 1.947-1.278 2.739-.323Zm11.051 11.044 2.071.313.103 5.796.103 5.795 2.236 3.257c3.443 5.016 3.928 6.685 3.683 12.659-.189 4.568-.351 5.326-1.711 8.006-.834 1.643-2.008 3.231-2.637 3.568-2.686 1.437-6.559.071-8.074-2.849-.723-1.395-.874-2.811-.933-8.745-.062-6.189.053-7.418.91-9.759 1.15-3.142 1.831-13.434 1.125-16.98-.385-1.929-.351-2.125.31-1.772.409.219 1.675.539 2.814.711Zm5.983 10.339c0 .267.155.506.345.531 1.226.166 4.492.347 10.931.607 8.407.339 12.441.859 17.03 2.195 5.885 1.714 9.435 4.137 9.435 6.442 0 .485.282 1.44.625 2.124.345.684.761 2.267.925 3.519.281 2.145.965 3.223 1.742 2.743.399-.247.081-4.095-.586-7.09-1.054-4.73-6.5-8.094-16.336-10.093-5.298-1.077-24.111-1.84-24.111-.978Zm-70.375 2.927c-3.543 1.241-4.12 4.647-2.533 14.933.248 1.611 2.013 3.585 3.87 4.329 1.702.681 9.003.014 10.137-.927.783-.65.93-1.435 1.047-5.589.184-6.458-.328-9.563-1.835-11.136-1.902-1.986-7.295-2.798-10.686-1.61Zm6.766.313c1.022.004 1.915.405 2.738 1.228l1.222 1.221-1.127.433c-2.016.775-11.023-.419-11.023-1.461 0-.792 4.041-1.915 5.753-1.598.506.094 1.603.174 2.437.177Zm136.099 2.049c-3.668.451-5.489.965-8.972 2.534-5.127 2.309-6.987 3.685-9.657 7.145-1.628 2.11-1.866 2.665-1.392 3.237.315.379.747.69.961.69.213 0 1.862-1.536 3.663-3.412 2.474-2.576 4.124-3.825 6.739-5.1 5.876-2.866 6.506-2.996 14.354-2.974 9.574.027 31.69 1.174 33.426 1.734 5.941 1.914 6.559 2.316 8.849 5.752 1.213 1.82 2.609 4.293 3.101 5.496.94 2.295 1.048 2.393 1.969 1.808 1.267-.804-1.761-7.824-4.712-10.924-1.732-1.819-11.101-4.351-18.643-5.037-1.645-.15-3.923-.36-5.062-.466-1.14-.106-5.385-.311-9.436-.454-4.05-.143-8.089-.336-8.975-.428-.886-.092-3.682.087-6.213.399Zm-140.711 1.446c1.082.339 3.486.675 5.342.746l3.375.129.091 5.915c.116 7.589-.045 7.885-4.539 8.327-3.278.324-5.297.059-4.868-.637.128-.206-.09-.642-.483-.969-1.637-1.358-2.16-3.35-2.391-9.117-.22-5.477-.192-5.712.638-5.369.477.197 1.753.636 2.835.975Zm98.289 2.61c.877 1.075 1.916 2.733 2.309 3.682.636 1.536.894 1.726 2.349 1.726.899 0 1.634-.142 1.634-.315 0-1.308-2.172-4.277-4.063-5.554-3.264-2.204-4.236-2.003-2.229.461Zm160.707 13.759c-6.483 1.463-8.45 2.811-14.339 9.829-2.125 2.531-4.646 5.431-5.605 6.443-1.881 1.988-4.62 6.037-10.867 16.063-8.484 13.615-12.208 16.067-29.752 19.584a60.29 60.29 0 0 1-5.293.761c-1.497.135-4.379.438-6.404.672a183.82 183.82 0 0 1-7.824.688c-3.732.237-6.421.574-11.276 1.414-2.151.373-3.553 1.729-4.888 4.727-2.206 4.957-2.514 7.186-2.375 17.195.128 9.272.135 9.328 1.49 12.076 1.615 3.279 5.7 9.379 8.025 11.987a110.62 110.62 0 0 1 3.492 4.18c1.685 2.134 9.145 8.517 13.082 11.193.91.619 1.929 1.395 2.263 1.726.335.33.819.601 1.076.601.412 0-.358 1.553-4.451 8.975-.558 1.012-1.8 3.29-2.761 5.062-.96 1.772-2.232 3.995-2.826 4.939-.595.944-1.081 1.81-1.081 1.923 0 .114-.756 1.515-1.68 3.116-.925 1.6-2.447 4.256-3.383 5.901a1975.49 1975.49 0 0 1-3.553 6.214c-6.731 11.717-9.334 16.375-9.334 16.706 0 .924-1.219 1.967-1.965 1.681-.735-.282-.728-.392.103-1.559.492-.69 1.295-2.274 1.787-3.52.491-1.246 1.32-2.99 1.842-3.875.522-.885 2.177-4.509 3.677-8.053 1.501-3.544 4.329-9.861 6.285-14.037 1.956-4.177 4.078-8.734 4.715-10.126.637-1.392 2.605-5.61 4.371-9.372 2.909-6.198 3.143-6.908 2.493-7.559-.65-.651-.766-.591-1.229.628-.281.74-1.145 2.691-1.92 4.336-2.944 6.252-4.902 10.443-6.021 12.888-1.034 2.259-2.298 4.968-6.765 14.498-2.289 4.885-3.231 7.073-3.231 7.512 0 .236-.29.67-.645.965-.355.294-.786 1.096-.958 1.782-.172.686-.909 2.49-1.638 4.008a120.056 120.056 0 0 0-2.532 5.754 937.766 937.766 0 0 1-1.727 4.25c-.445 1.075-.389 1.359.383 1.953.497.383 1.509.645 2.248.583 1.446-.122.333 1.703 15.366-25.197 3.461-6.191 5.101-9.098 8.833-15.648a632.7 632.7 0 0 0 3.238-5.753 299.82 299.82 0 0 1 3.159-5.516c1.039-1.768 1.888-3.533 1.888-3.923 0-.389-.673-1.073-1.495-1.52-.823-.447-3.049-2.044-4.948-3.55a804.668 804.668 0 0 0-5.753-4.519c-4.362-3.377-13.17-13.57-14.381-16.642-.15-.38-.813-1.519-1.474-2.531-2.442-3.739-2.418-3.586-2.226-14.083.14-7.635.368-10.549 1.017-12.957.491-1.824 1.085-3.107 1.438-3.107.331 0 .933-.331 1.337-.735.95-.95 4.744-1.951 8.536-2.252 20.583-1.635 29.121-3.136 39.581-6.955 6.114-2.232 8.844-4.946 15.927-15.832.577-.886 1.681-2.543 2.455-3.682 3.048-4.491 4.768-7.214 5.662-8.964.514-1.007 2.512-3.781 4.44-6.166a620.193 620.193 0 0 0 4.779-5.974c4.829-6.203 9.561-8.057 20.587-8.065 5.227-.004 6.195.134 10.586 1.511 6.974 2.187 12.085 4.79 14.958 7.617 1.327 1.306 2.558 2.829 2.733 3.384.398 1.252.996 1.3 1.309.103.325-1.244-1.856-4.549-4.325-6.553-2.81-2.281-5.674-3.623-12.604-5.907-5.575-1.837-6.376-1.98-11.737-2.101-4.475-.1-6.673.079-9.895.805Zm-379.936 3.721c-.002.185-.78.736-1.729 1.225-.949.489-2.406 1.598-3.236 2.463-2.01 2.093-2.294 5.05-1.006 10.474.511 2.152 1.34 6.812 1.842 10.356.503 3.544 1.447 8.514 2.098 11.046a297.701 297.701 0 0 1 2.271 9.665c.598 2.785 1.52 6.306 2.05 7.824 1.115 3.201 2.277 8.3 2.57 11.277.112 1.139.498 2.899.857 3.912.36 1.012.78 2.469.934 3.238.353 1.761 3.942 8.89 5.51 10.947.652.853 1.184 1.789 1.184 2.081 0 .883 3.157 4.09 5.207 5.288 2.504 1.463 4.727 2.081 9.52 2.645 2.152.252 4.534.547 5.294.654.759.107 3.4.224 5.868.26 4.316.062 4.487.103 4.487 1.091 0 .565-.135 1.163-.3 1.329-.29.288-1.953 4.827-3.91 10.668-.508 1.519-1.095 3.176-1.302 3.682-.208.506-.59 1.542-.85 2.301-.905 2.654-3.402 9.673-3.765 10.586a72.791 72.791 0 0 0-.919 2.531c-.304.886-.738 2.025-.965 2.532-.226.506-.811 2.163-1.3 3.682-.489 1.519-1.643 4.832-2.564 7.364-3.235 8.889-8.068 23.807-8.177 25.243-.167 2.18 1.065 1.844 2.272-.62 1.18-2.411 1.394-2.272.35.228-.767 1.836-.618 2.994.385 2.994.548 0 2.203-3.122 4.148-7.824.366-.886 1.303-3.061 2.082-4.833.778-1.772 2.441-5.811 3.695-8.975 1.253-3.164 3.672-9.17 5.373-13.347 1.702-4.177 3.768-9.355 4.592-11.507.825-2.151 2.575-6.461 3.89-9.577 1.315-3.115 2.47-6.015 2.566-6.443.272-1.205 4.337-10.776 4.83-11.371.278-.335 2.581-.566 6.321-.634 3.235-.058 7.122-.179 8.638-.269 1.516-.089 5.655-.313 9.199-.496a889.42 889.42 0 0 0 8.054-.442c.886-.059 4.511-.259 8.055-.443 3.544-.184 6.598-.429 6.787-.544.572-.349 1.126 1.438 4.224 13.65 1.637 6.455 3.51 13.704 4.161 16.109a5226.94 5226.94 0 0 1 1.371 5.063c.102.38.524 2.037.939 3.682.796 3.166 1.505 5.842 2.744 10.356a1375.242 1375.242 0 0 1 4.461 16.799c2.625 10.132 3.555 13.597 4.507 16.799.527 1.772.86 3.481.739 3.797-.469 1.236-1.174.46-1.882-2.071-.407-1.456-1.527-5.132-2.488-8.169-8.761-27.679-10.16-32.053-11.264-35.21a320.568 320.568 0 0 1-2.495-7.594c-.797-2.531-2.698-8.427-4.225-13.101a1403.312 1403.312 0 0 1-4.398-13.693c-1.336-4.281-1.779-5.193-2.516-5.193-1.173 0-1.13.736.257 4.421.634 1.684 1.239 3.501 1.345 4.038.105.537.824 2.84 1.598 5.118.773 2.278 2.561 7.87 3.973 12.427 1.412 4.556 3.061 9.734 3.664 11.506.603 1.772 2.156 6.639 3.451 10.816 1.296 4.177 2.951 9.355 3.679 11.506.728 2.152 2.812 8.469 4.631 14.038 3.903 11.947 4.224 12.657 5.707 12.657 1.704 0 2.557-.477 2.557-1.429 0-.956-3.196-14.133-5.792-23.885-.91-3.417-1.921-7.352-2.247-8.745-.325-1.392-1.563-6.259-2.751-10.816-1.189-4.556-2.324-9.009-2.523-9.895-.2-.886-1.234-4.925-2.298-8.975l-3.568-13.577c-.899-3.418-1.892-7.198-2.206-8.4l-.572-2.186h7.229l.01 2.646c.043 11.533.632 17.859 1.701 18.27 1.25.48 1.611-.253 1.317-2.677-.157-1.298-.388-5.467-.513-9.264-.126-3.797-.345-7.473-.487-8.17-.196-.952-.081-1.265.462-1.265.396 0 2.639-.621 4.984-1.381 3.756-1.216 4.412-1.593 5.522-3.172 1.813-2.577 2.357-5.795 2.073-12.243-.436-9.906-3.131-15.038-9.479-18.047l-2.463-1.168.286-2.821c.571-5.617.504-28.314-.084-28.903-.304-.303-.711-.393-.905-.201-.527.525-.891 9.772-.85 21.586l.037 10.491-1.15-.288c-.632-.159-1.175-.323-1.206-.366-.03-.043-.407-3.495-.836-7.672a3123.368 3123.368 0 0 0-1.671-15.773c-.489-4.498-.89-8.381-.89-8.629 0-.248-.238-.451-.528-.451-.383 0-.435 1.105-.186 4.027.188 2.215.425 5.166.526 6.558.101 1.393.395 4.499.655 6.904.755 7.015 1.378 14.418 1.224 14.571-.077.078-1.81.013-3.849-.145l-3.708-.285-.05-2.353c-.071-3.307-.422-4.655-2.185-8.386-2.173-4.602-6.083-7.894-12.037-10.136-2.362-.889-3.805-1.091-8.054-1.123-2.847-.022-6.471.107-8.053.286-2.284.259-2.888.195-2.932-.309-.031-.349-.024-2.291.014-4.317.039-2.025-.056-4.976-.211-6.558-.252-2.582-.386-2.877-1.304-2.877-1.011 0-1.021.067-.849 5.638.095 3.102.348 6.311.562 7.134l.389 1.496h-5.91l-.07-3.797c-.038-2.089-.118-4.004-.177-4.257-.059-.253-.131-1.873-.16-3.599-.05-2.979-.106-3.132-1.088-2.992-.984.14-1.029.32-.894 3.599.078 1.899.336 5.093.572 7.099.237 2.005.38 3.69.319 3.743-.062.054-2.62-.034-5.682-.194l-5.57-.292-2.485-2.097c-3.82-3.223-9.364-6.73-15.948-10.088-2.09-1.065-3.674-2.137-3.522-2.383.384-.622-12.006-12.679-14.16-13.778-2.565-1.308-6.83-2.298-9.287-2.155-1.175.068-2.137.275-2.139.46Zm7.064 2.04c4.047 2.064 15.642 11.658 14.94 12.361-.29.289-8.763-1.798-13.35-3.289-4.192-1.362-5.904-2.89-6.984-6.231-.901-2.793-.95-3.924-.177-4.182.806-.27 3.848.461 5.571 1.341Zm-7.776 2.328c.28 1.882.683 2.863 2.103 5.116 1.207 1.916 5.368 3.603 13.334 5.407 1.899.43 4.902 1.295 6.674 1.922 3.51 1.242 14.167 6.612 15.649 7.885.506.435 1.852 1.382 2.991 2.106 1.14.723 3.084 2.162 4.322 3.197 3.092 2.585 14.067 13.388 16.159 15.907.941 1.133 2.983 2.979 4.538 4.103 1.554 1.124 2.938 2.209 3.074 2.411.675 1.007 6.103 1.399 21.021 1.517 9.486.075 16.95.334 18.313.635 1.266.279 3.234.687 4.373.905 2.507.48 3.759 1.113 6.359 3.214 4.273 3.454 5.456 6.81 5.883 16.683l.289 6.673-1.778 1.671c-1.801 1.693-5.362 3.27-8.696 3.852-1.005.176-4.416.386-7.58.468-3.165.081-7.618.261-9.896.399a978.55 978.55 0 0 1-10.125.539c-3.291.157-7.123.352-8.515.432-1.392.079-5.12.288-8.285.464-3.164.175-6.478.391-7.364.48-5.254.528-16.43.896-26.234.865-9.86-.032-11.495-.141-13.017-.865-1.77-.843-5.854-4.399-5.854-5.098 0-.211-1.119-2.262-2.487-4.557-1.368-2.295-2.742-4.984-3.053-5.976-.311-.992-.934-2.442-1.385-3.222-.974-1.687-2.566-6.763-2.97-9.474-.159-1.064-.464-2.396-.679-2.96-.215-.565-.513-1.803-.664-2.751-.15-.948-.454-2.071-.673-2.494-.219-.422-.965-3.15-1.657-6.061-.692-2.912-1.873-7.779-2.624-10.816-.75-3.038-1.858-8.423-2.46-11.967-.602-3.544-1.316-7.168-1.586-8.054-.27-.886-.796-3.333-1.167-5.436-.58-3.281-.584-4.035-.036-5.293.61-1.4 2.965-4.22 3.269-3.914.08.079.275 1.019.434 2.087Zm141.528 6.284c-.119.119-1.459.349-2.976.51-3.14.333-7.363 2.279-8.597 3.961-.855 1.165-1.982 8.604-2.436 16.068-.203 3.358.193 9.622.917 14.498.113.76.411 8.63.663 17.49.252 8.86.66 16.937.906 17.95.585 2.401 3.83 9.142 5.574 11.579.753 1.053 2.248 2.867 3.323 4.032 1.72 1.865 2.395 2.234 5.636 3.086 2.025.533 4.149.996 4.718 1.031.569.035 1.035.113 1.035.175 0 .061-2.47 9.071-5.49 20.021-5.579 20.226-9.726 35.504-9.888 36.428-.05.28-.33 1.235-.624 2.121-.293.886-.629 2.129-.747 2.762-.117.632-.977 4.05-1.911 7.594-2.169 8.233-2.274 9.05-1.381 10.776.649 1.255.966 1.42 2.728 1.42h1.993l2.078-5.408c1.143-2.974 2.957-8.1 4.032-11.391 1.075-3.291 2.218-6.604 2.541-7.364.588-1.382 10.497-30.591 15.888-46.831l2.864-8.629 1.898.014c1.044.008 3.348.201 5.12.431 1.772.229 7.571.754 12.887 1.165 5.316.411 10.567.89 11.669 1.065l2.003.316.143 3.912c.174 4.727.613 17.491.926 26.925.354 10.667.669 19.677.917 26.235.125 3.29.328 8.986.451 12.657.591 17.59 1.084 23.59 2.014 24.52.236.236 1.246.291 2.246.122l1.816-.307.295-5.609c1.234-23.479 1.839-36.705 2.384-52.095.134-3.797.333-8.353.443-10.125.11-1.772.329-7.157.487-11.967.158-4.81.359-9.211.448-9.78.106-.68-.158-1.207-.768-1.533-1.474-.789-1.288-2.246-1.974 15.455-.138 3.544-.36 9.654-.495 13.578-.136 3.924-.336 9.205-.447 11.736-.11 2.532-.329 9.263-.486 14.959-.158 5.695-.357 11.598-.443 13.117-.086 1.519-.173 6.865-.192 11.882l-.035 9.12-1.185-.145-1.185-.146-.163-8.054c-.216-10.645-.666-25.502-.92-30.377-.112-2.152-.32-8.365-.462-13.808-.141-5.442-.349-11.034-.461-12.426-.113-1.393-.336-7.917-.496-14.498-.238-9.855-.416-12.109-1.002-12.772-.674-.762-.426-.807 4.537-.829 6.573-.029 8.473-.262 13.073-1.601 4.435-1.29 11.912-3.609 14.827-4.599 1.165-.396 2.264-.555 2.442-.355.178.201 4.693 13.309 10.033 29.131 5.34 15.821 10.23 30.155 10.866 31.854 1.855 4.959.561 4.027-1.583-1.139-2.081-5.016-3.376-7.957-5.621-12.766-.768-1.645-2.485-5.477-3.815-8.514a494.486 494.486 0 0 0-4.253-9.435 448.306 448.306 0 0 1-4.14-9.206c-2.15-4.938-3.231-7.314-6.642-14.613-1.324-2.83-1.841-3.247-3.067-2.47-.709.449-.166 1.812 6.16 15.473.587 1.265 2.318 5.143 3.849 8.616 1.53 3.474 2.964 6.684 3.187 7.134.454.918 1.324 2.834 2.987 6.572.619 1.392 1.75 3.883 2.512 5.536.763 1.653 1.95 4.345 2.639 5.984.688 1.638 2.483 5.536 3.988 8.662 2.174 4.516 2.897 5.634 3.515 5.438 2.967-.94 2.678-1.401 3.025 4.836.174 3.121.38 6.192.458 6.824.078.633.174 2.121.214 3.306.059 1.759.252 2.212 1.05 2.466 1.455.462 1.798-.505 1.562-4.391-.115-1.898-.328-7.076-.472-11.506-.145-4.43-.35-9.504-.455-11.276a767.566 767.566 0 0 1-.449-8.975c-.143-3.165-.361-7.825-.487-10.356-.126-2.531-.433-8.952-.682-14.268a2796.74 2796.74 0 0 0-.678-13.807c-.123-2.279-.335-6.628-.471-9.666-.355-7.894-.665-14.526-.916-19.561-.119-2.404-.326-7.168-.46-10.585a734.676 734.676 0 0 0-.466-10.126c-.123-2.152-.334-6.294-.47-9.205-.136-2.911-.447-6.944-.692-8.963a257.663 257.663 0 0 1-.444-3.797c0-.07-.524-.127-1.163-.127h-1.163l.288 6.05c.255 5.367.207 6.019-.43 5.775-.91-.35-6.698 1.602-9.335 3.148-3.611 2.116-2.053 2.864 1.907.916 1.266-.623 2.638-1.139 3.049-1.147.411-.008 1.706-.549 2.876-1.204 1.171-.655 2.139-1.12 2.15-1.035.011.084.139 2.38.284 5.102.303 5.661.608 5.34-4.225 4.447-4.666-.863-8.303-2.967-12.65-7.318-4.499-4.504-3.973-3.839-12.3-15.57-2.319-3.268-8.704-10.065-10.711-11.404a198.794 198.794 0 0 1-3.661-2.524c-2.182-1.544-10.832-4.544-13.142-4.558-.76-.005-2.107-.23-2.991-.5-.884-.27-4.922-.786-8.972-1.146-4.05-.36-8.814-.873-10.586-1.139-9.439-1.42-29.738-3.462-30.165-3.035Zm265.692 1.284c.699 1.821-3.769 17.342-6.368 22.12-.375.69-.672 1.364-.66 1.498.044.505-3.35 7.039-5.195 9.999-1.057 1.696-2.807 4.112-3.888 5.369l-1.967 2.284 1.459.32c1.328.292 1.64.12 3.477-1.917 3.779-4.19 10.251-16.359 12.342-23.206a192.2 192.2 0 0 1 1.656-5.101c.49-1.428 1-3.5 1.133-4.603.134-1.103.338-2.457.455-3.009.298-1.415-.486-3.217-1.679-3.855-.829-.444-.967-.425-.765.101Zm-250.485 2.005c8.383.836 10.447 1.088 11.574 1.414 1.123.325 11.573 1.551 15.811 1.854 2.025.145 4.806.544 6.179.887 1.373.343 2.659.523 2.857.401.438-.271 6.965 1.362 9.232 2.309 2.341.978 10.371 7.591 12.717 10.473 1.094 1.344 4.1 5.26 6.679 8.702 4.029 5.375 5.922 7.597 11.023 12.935 1.42 1.485 5.621 3.96 8.354 4.921 1.622.57 4.01.957 6.239 1.011l3.611.087.256 2.582c.244 2.461.423 5.953.967 18.921.133 3.165.343 7.825.465 10.356.341 7.026.645 13.655.929 20.251.142 3.291.347 7.641.455 9.666.108 2.025.31 6.995.447 11.046.139 4.05.345 8.399.46 9.665.114 1.266.322 6.029.461 10.586l.253 8.284-1.789-5.753c-4.706-15.133-18.616-55.981-19.223-56.45-.562-.434-.244-.672 1.756-1.314 3.213-1.031 7.968-3.312 8.671-4.158.307-.37.824-.672 1.149-.672.897 0 5.739-4.099 5.739-4.858 0-.894-.111-.865-2.393.637-5.933 3.903-11.829 6.747-18.548 8.947-8.698 2.846-18.782 5.779-20.942 6.09-3.363.483-14.698.589-18.18.169l-5.062-.613c-1.862-.227-27.244-2.837-31.068-3.195-6.747-.632-8.289-.852-10.495-1.5-1.343-.393-3.036-1.216-3.762-1.827-3.472-2.921-7.976-10.881-9.732-17.198-.387-1.389-.615-6.536-.694-15.648-.065-7.468-.346-15.235-.624-17.26-.904-6.575-1.042-16.146-.326-22.483.738-6.529 1.247-7.67 4.081-9.141 1.928-1 9.119-1.689 12.578-1.205 1.265.178 5.718.664 9.895 1.081Zm258.443 7.845c-2.684 9.234-2.756 10.053-2.795 31.728-.038 22.003-.287 24.839-2.725 31.039-.64 1.63-1.165 3.267-1.165 3.637 0 .962-3.887 7.588-6.558 11.179-2.939 3.951-3.307 4.124-15.764 7.442-8.127 2.164-9.976 2.423-20.711 2.9-3.544.157-6.705.497-7.024.755-.805.652-15.133 1.606-22.742 1.515l-6.293-.076-.922 3.482c-.506 1.915-1.851 6.9-2.987 11.077-1.137 4.177-3.443 12.668-5.125 18.87-1.682 6.202-3.557 12.933-4.165 14.958-.609 2.025-1.958 6.893-2.999 10.816a2019.844 2019.844 0 0 1-2.274 8.515c-3.278 11.889-3.707 14.15-2.794 14.713.632.392 1.997-4.248 10.831-36.805 5.384-19.846 9.878-36.354 10.927-40.144l1.048-3.783 14.268-.209c7.847-.115 15.368-.422 16.713-.681 1.345-.259 3.727-.495 5.293-.522 3.304-.059 6.52-.526 14.814-2.152l8.217-1.609c1.228-.24 2.367-.303 2.531-.14.164.163.642 1.781 1.062 3.597.421 1.814 3.174 12.93 6.12 24.701 2.945 11.771 6.402 25.596 7.681 30.723 2.78 11.143 3.621 13.636 4.672 13.838.558.108.782-.156.777-.918-.008-1.014-2.136-9.846-4.806-19.94a2654.17 2654.17 0 0 1-3.983-15.418 5810.775 5810.775 0 0 0-4.559-17.72 1944.06 1944.06 0 0 1-3.236-12.657c-.794-3.164-1.739-5.985-2.099-6.269-.529-.417-.235-.71 1.539-1.53 5.14-2.379 6.432-3.485 9.947-8.513 7.179-10.269 10.47-22.793 9.744-37.077-.433-8.503-.455-21.314-.045-25.774.198-2.152.752-5.569 1.23-7.594 1.001-4.231 1.12-7.168.325-7.963-.926-.926-1.194-.652-1.968 2.009Zm-100.327 11.418c.096 3.559-.088 7.054-.493 9.32l-.648 3.626 1.189 1.059c.655.582 1.282.967 1.395.854.464-.465 1.134-6.798 1.127-10.668-.009-5.683-1.016-9.886-2.368-9.886-.196 0-.287 2.563-.202 5.695Zm-249.937-.549c2.785.037 7.946.028 11.469-.02 5.809-.079 6.741.025 10.012 1.114 3.624 1.207 7.74 3.849 10.082 6.47 1.641 1.837 3.492 6.352 3.847 9.383l.296 2.531-13.48-.017c-9.265-.011-14.056-.192-15.322-.579-2.64-.806-3.169-1.27-14.01-12.291-2.24-2.278-4.635-4.82-5.322-5.648l-1.248-1.506 4.307.248c2.369.137 6.585.279 9.369.315Zm192.937-.198c-.107.19-.145.863-.084 1.496.061.633.242 4.671.404 8.975.16 4.303.388 9.895.505 12.427.197 4.271.433 9.663.925 21.171.109 2.532.318 7.917.465 11.967.148 4.05.353 9.435.457 11.966.104 2.532.306 8.331.451 12.888.144 4.556.355 10.252.469 12.657.115 2.404.32 8.1.458 12.656.137 4.557.349 10.77.471 13.808.123 3.038.33 8.216.461 11.506.291 7.285.619 13.252.952 17.329.176 2.151.083 3.164-.313 3.409-.856.528-4.619.266-5.416-.378-.581-.47-.635-.45-.314.122 1.327 2.357 3.096 2.865 6.205 1.781l1.491-.52-.279-11.561c-.154-6.36-.368-13.53-.476-15.935-.108-2.405-.327-8.1-.486-12.657-.16-4.556-.363-9.838-.451-11.736-.089-1.899-.289-7.077-.444-11.506-.155-4.43-.373-10.023-.484-12.427-.112-2.405-.319-7.894-.461-12.197-.141-4.303-.347-10.103-.457-12.887-.11-2.785-.315-8.687-.456-13.117-.141-4.43-.348-10.333-.459-13.118a1851.69 1851.69 0 0 1-.503-15.418c-.164-5.696-.39-10.511-.502-10.701-.112-.19-.593-.345-1.069-.345s-.954.155-1.06.345Zm27.408 4.212-3.338 4.072-4.026-.229c-3.401-.195-4.742-.037-8.629 1.01-4.207 1.134-8.492 3.192-7.893 3.791.135.135 1.966-.284 4.07-.929 6.865-2.109 9.577-2.65 12.58-2.512l2.944.135-1.376 2.045c-2.215 3.292-3.562 10.033-3.971 19.87-.198 4.775-.179 4.893.844 5.16.576.151 1.103.218 1.171.15.068-.067.216-2.493.33-5.389.295-7.512 1.084-14.068 1.878-15.602.375-.726 1.98-3.013 3.567-5.081 5.309-6.919 6.817-9.321 6.267-9.984-.276-.332-.632-.598-.79-.591-.16.006-1.792 1.845-3.628 4.084Zm95.562 26.491c-.315.315-5.271 1.561-7.218 1.815-1.708.223-8.855.781-12.286.96-4.413.231-10.847 1.319-14.012 2.372-5.61 1.866-12.935 5.861-15.725 8.576-1.364 1.329-3.045 2.778-3.735 3.219-1.533.981-4.672 5.717-5.693 8.586-1.07 3.008-4.418 9.921-6.356 13.125-1.396 2.308-2.208 5.32-1.434 5.32.121 0 1.673-1.43 3.45-3.178 3.014-2.967 5.074-6.3 5.074-8.208 0-.92 4.244-9.331 5.962-11.817 2.842-4.112 8.171-7.948 15.21-10.948 7.189-3.064 9.812-3.568 24.49-4.709 6.409-.498 8.94-.896 11.846-1.864 3.943-1.314 4.328-1.583 3.888-2.728-.258-.674-2.909-1.073-3.461-.521Zm-104.037 8.304c-.293.293-8.703 1.542-11.354 1.686-1.761.096-1.899.179-1.178.707.467.341 2.066.598 3.722.598 1.985 0 2.922.182 2.963.576l.174 1.725c.064.633.257 4.983.431 9.666.174 4.683.394 9.757.489 11.276.094 1.519.292 5.765.439 9.435.521 13.019 1.053 24.168 1.407 29.456.11 1.646.326 4.959.482 7.362.163 2.52.508 4.515.817 4.711.825.525 3.434.415 3.789-.159.393-.637.506-5.555.921-40.145l.33-27.541-1.102.156-1.102.156-.064 32.799c-.064 32.607-.164 34.793-1.544 33.939-.194-.119-.393-3.793-.441-8.164-.048-4.371-.155-8.878-.239-10.017-.083-1.14-.281-5.696-.44-10.126-.303-8.419-.577-14.735-.96-22.092-.126-2.405-.348-7.79-.494-11.967-.146-4.177-.323-8.347-.393-9.267l-.127-1.674 3.335-.537c1.834-.296 3.462-.666 3.617-.821.49-.49-1.197-1.969-2.245-1.969-.551 0-1.106.104-1.233.231Zm45.872 3.503c-11.696 2.441-16.481 3.149-21.348 3.161-4.301.01-7.418.737-7.418 1.73 0 .541 1.007.618 5.869.448 5.849-.205 10.487-.823 19.215-2.562 5.348-1.065 8.27-1.556 9.927-1.67 1.509-.102 2.27-.577 2.27-1.416 0-.911-3.231-.793-8.515.309ZM135.17 323.165c-.727.145-.821.469-.609 2.083.139 1.051.367 2.418.506 3.036.14.619.673 3.208 1.185 5.753.512 2.546 1.131 5.457 1.375 6.47s.961 4.549 1.592 7.858c.632 3.309 1.255 6.312 1.384 6.674.128.361.335 1.278.46 2.037.364 2.224 2.157 10.245 3.289 14.722.752 2.971.9 4.226.526 4.457-.801.495-1.081.124-1.702-2.253a522.549 522.549 0 0 0-1.939-7.03 877.496 877.496 0 0 0-3.118-10.816c-2.25-7.667-9.672-31.67-9.847-31.845-.125-.125-.626-.101-1.113.054-.833.265-.848.423-.261 2.688.343 1.325.835 3.051 1.094 3.837.259.785.547 1.826.641 2.312.179.929 2.239 8.093 3.054 10.622.262.811.559 1.908.661 2.436.102.529.404 1.625.67 2.436.268.812 1.313 4.376 2.322 7.92 1.01 3.544 2.127 7.375 2.484 8.515l2.345 7.522 1.698 5.451 1.618-.303c3.382-.634 3.799-.96 3.383-2.637-.207-.835-.733-3.59-1.169-6.121-.435-2.532-1.172-6.26-1.636-8.285a293.625 293.625 0 0 1-1.61-7.594 260.83 260.83 0 0 0-1.131-5.523c-.202-.886-.585-2.646-.852-3.912a1430.05 1430.05 0 0 0-1.436-6.674 484.274 484.274 0 0 1-2.106-10.125c-.693-3.491-.901-3.935-1.758-3.765Zm-40.333 1.618c0 .208-3.093 7.694-5.736 13.883-1.19 2.785-2.744 6.616-3.456 8.515-.711 1.898-2.236 5.626-3.39 8.284a351.416 351.416 0 0 0-3.98 9.647c-2.8 7.15-7.986 19.348-8.154 19.179-.081-.08.148-.956.508-1.944 2.825-7.755 4.515-12.454 4.618-12.844.066-.253.243-.771.394-1.151.465-1.178 3.134-8.936 3.324-9.665.099-.38.692-2.14 1.318-3.912 4.822-13.658 6.351-18.041 6.502-18.64.095-.38.983-2.956 1.973-5.724 1.224-3.423 2.08-5.142 2.674-5.375.887-.348 3.405-.536 3.405-.253Zm9.67 4.103c.002 2.088.199 7.214.437 11.391.237 4.177.555 11.529.705 16.339.15 4.81.359 10.298.464 12.197.105 1.898.321 7.697.478 12.887.158 5.189.425 10.979.595 12.867.343 3.823.557 4.02 4.45 4.115l1.842.045.08-4.716c.043-2.594.199-12.277.345-21.516.147-9.24.377-23.468.513-31.617.241-14.562.229-14.828-.692-15.32-.515-.276-.959-.339-.986-.14-.292 2.145-.99 45.104-.998 61.46-.006 10.403-.048 10.931-.875 10.931-.478 0-.951-.259-1.052-.576-.1-.316-.407-5.339-.682-11.161-.613-12.978-.83-17.608-1.397-29.686-.243-5.19-.553-12.749-.689-16.799-.417-12.44-.655-14.498-1.67-14.498-.786 0-.872.374-.868 3.797Zm-33.414-2.119a89.746 89.746 0 0 1-.974 2.694c-.382 1.013-1.07 2.98-1.53 4.372-.459 1.393-2.002 5.846-3.43 9.896-4.114 11.677-6.025 17.237-9.714 28.266-3.485 10.42-3.582 11.055-1.688 11.079.525.006 9.323-17.369 9.323-18.411 0-.249.207-.453.46-.453s.46-.198.46-.44 1.573-3.712 3.494-7.71c12.716-26.457 13.287-27.75 12.261-27.75-.25 0-.712.311-1.027.691-.315.38-4.794 9.127-9.952 19.438-5.158 10.311-9.378 18.609-9.378 18.44 0-.169.228-.891.506-1.603.454-1.162 2.318-6.381 6.46-18.095a896.684 896.684 0 0 0 2.717-7.825c.732-2.151 1.87-5.362 2.53-7.134 1.74-4.684 2.037-5.753 1.6-5.753-.215 0-.716-.125-1.115-.278-.461-.176-.825.033-1.003.576Zm129.948 6.886c1.075.13 1.956.419 1.956.642 0 .429-2.102 6.486-2.795 8.053-1.016 2.299-21.089 62.584-22.336 67.082-.705 2.539-1.034 3.107-1.801 3.107-1.389 0-3.128-1.343-2.588-1.998.556-.675 4.291-14.289 18.075-65.89 1.014-3.797 2.153-7.985 2.531-9.307l.687-2.403 2.157.239c1.187.131 3.038.345 4.114.475Zm10.652 6.953c-.026 2.73-.126 6.103-.222 7.495-.096 1.392-.229 11.065-.297 21.495-.12 18.499-.1 18.981.798 19.662 1.014.768 3.327.937 4.31.314.357-.226.7-1.436.796-2.801.093-1.322.467-3.884.832-5.694.365-1.809 1.948-11.972 3.518-22.584 2.759-18.649 2.826-19.317 1.998-19.922-.472-.345-.906-.465-.965-.266-.18.607-5.571 37.01-5.882 39.713-.841 7.325-1.732 10.585-2.892 10.585-.184.001-.266-11.685-.183-25.968.152-25.907.15-25.97-.805-26.481-.941-.503-.958-.427-1.006 4.452Zm200.469 10.142c.168 3.227.381 6.179.474 6.558.094.38.296 3.694.449 7.364.154 3.671.37 8.02.481 9.666l.201 2.991-1.345-4.602c-.741-2.532-2.639-9.729-4.219-15.994-2.869-11.378-2.874-11.391-4.122-11.391h-1.25l1.301 4.947c3.785 14.399 9.795 38.19 9.824 38.892.025.589.423.805 1.483.805h1.448l-.126-5.105c-.07-2.808-.246-6.278-.392-7.71-.348-3.406-.554-5.842-1.672-19.818-.515-6.429-1.045-11.866-1.178-12.081-.132-.215-.56-.391-.951-.391-.618 0-.671.756-.406 5.869Zm-30.703-3.727c-.123.214-2.336 6.707-4.917 14.428-2.582 7.72-4.81 14.348-4.951 14.728-2.807 7.527-16.251 47.621-16.251 48.464 0 .368.298.917.662 1.219 1.127.936 1.288.511 10.419-27.591a9469.999 9469.999 0 0 1 11.293-34.505c4.444-13.465 5.14-15.961 4.603-16.499-.348-.348-.734-.458-.858-.244Zm46.601 3.181c0 .143.394 1.231.875 2.417a1840.646 1840.646 0 0 1 6.71 16.884c6.249 15.961 8.105 19.673 9.257 18.521.219-.219-1.195-4.972-2.087-7.015a81.891 81.891 0 0 1-1.172-2.991c-.424-1.139-1.06-2.693-1.413-3.452-.782-1.68-6.075-14.503-8.406-20.365-1.433-3.604-1.851-4.256-2.728-4.257-.569-.001-1.036.115-1.036.258ZM67.278 392.596c-.542.933-.673.634-.229-.523.157-.411.384-.651.502-.532.119.118-.004.593-.273 1.055Z",fill:"currentColor"}),f.createElement("path",{d:"M68.659 236.623c-.392.634 1.335 2.549 3.032 3.364 5.129 2.461 9.96 3.95 19.257 5.934 17.174 3.667 22.188 4.348 35.209 4.779 6.875.228 11.02.334 37.166.944 10.209.238 10.719.162 9.658-1.44-.368-.556-9.91-.906-37.159-1.362-15.334-.257-19.661-.5-28.075-1.581-3.671-.471-11.901-1.988-14.958-2.757a113.98 113.98 0 0 0-3.682-.839l-2.071-.434 2.543-.055c1.4-.031 4.195.144 6.213.387 2.019.243 6.57.662 10.114.932 3.544.268 8.1.694 10.126.945 7.297.905 21.775 1.734 28.765 1.649 3.924-.049 11.069.133 15.879.402 12.128.681 13.769.607 13.955-.631.08-.538.08-.998 0-1.023-.081-.024-3.254-.127-7.051-.228-3.797-.102-7.164-.283-7.481-.402-.317-.12-5.184-.231-10.816-.247-5.631-.016-12.931-.221-16.222-.456-3.291-.235-9.297-.65-13.347-.922-4.051-.273-8.4-.688-9.666-.921-1.265-.234-5.408-.543-9.205-.687-3.797-.143-9.182-.555-11.966-.914-2.785-.36-6.41-.687-8.055-.727-3.905-.095-6.8-.941-9.223-2.696-2.08-1.506-2.538-1.665-2.94-1.014Zm186.484 17.914c-1.438.092-2.186.349-2.186.75 0 .454 1.382.69 5.408.923 2.974.173 6.65.395 8.169.495 1.519.1 5.972.297 9.896.437 19.412.696 31.286 1.19 33.368 1.39 1.266.121 6.133.335 10.816.475 4.683.141 12.036.466 16.339.723 4.303.256 9.171.354 10.816.216l2.992-.25-2.992.704c-3.188.749-9.451.879-21.402.442a24727.77 24727.77 0 0 1-43.724-1.641c-14.681-.565-23.534-.467-23.367.258.134.589 11.67 1.414 24.978 1.786 5.696.159 12.53.39 15.188.511 2.658.121 8.561.329 13.118.462 12.828.374 21.818.71 24.947.931 5.239.371 15.995-1.416 17.856-2.965.506-.422 1.49-1.051 2.186-1.399.697-.347 1.266-.935 1.266-1.305 0-.542-.334-.594-1.726-.267-2.477.582-27.318.429-37.626-.232-4.809-.308-11.644-.642-15.188-.742-5.815-.163-9.687-.341-20.479-.938-3.058-.17-17.062-.66-23.935-.839a63.932 63.932 0 0 0-4.718.075Z",fill:"#1E1919"})))};const be=(e,t,n)=>{const s=a.getName(n),o=a.getParentFolderName(n);return t?e.formatMessage({id:"5xCeTo",defaultMessage:"Removing members from <strong>{folderName}</strong>…"},{folderName:r.Emstring.em_snippet(s,a.SNIPPET_SIZES.FOLDER_NAME),strong:e=>f.default.createElement("strong",null,e)}):""===o?e.formatMessage({id:"90I244",defaultMessage:"Sharing <strong>{folderName}</strong> with everyone…"},{folderName:r.Emstring.em_snippet(s,a.SNIPPET_SIZES.FOLDER_NAME),strong:e=>f.default.createElement("strong",null,e)}):e.formatMessage({id:"16RnmU",defaultMessage:"Sharing <strong>{folderName}</strong> with members of <strong>{parentFolderName}</strong>…"},{folderName:r.Emstring.em_snippet(s,a.SNIPPET_SIZES.FOLDER_NAME),parentFolderName:r.Emstring.em_snippet(o,a.SNIPPET_SIZES.FOLDER_NAME),strong:e=>f.default.createElement("strong",null,e)})},Me=(e,t)=>t?e.formatMessage({id:"1HgFQB",defaultMessage:"Couldn’t remove members. Try again."}):e.formatMessage({id:"ypun4U",defaultMessage:"Couldn’t share folder. Try sharing again."}),Se=e=>e.formatMessage({id:"sKbWSj",defaultMessage:"Couldn’t load member list. Please try again."}),Ae=(e,t,n)=>{const s=a.getName(n),o=a.getParentFolderName(n);return t?e.formatMessage({id:"7POTZF",defaultMessage:"Members removed from <strong>{folderName}</strong>."},{folderName:r.Emstring.em_snippet(s,a.SNIPPET_SIZES.FOLDER_NAME),strong:e=>f.default.createElement("strong",null,e)}):void 0===o||""===o?e.formatMessage({id:"nni9pE",defaultMessage:"<strong>{folderName}</strong> shared with everyone."},{folderName:r.Emstring.em_snippet(s,a.SNIPPET_SIZES.FOLDER_NAME),strong:e=>f.default.createElement("strong",null,e)}):e.formatMessage({id:"qvP8A+",defaultMessage:"<strong>{folderName}</strong> shared with members of <strong>{parentFolderName}</strong>."},{folderName:r.Emstring.em_snippet(s,a.SNIPPET_SIZES.FOLDER_NAME),parentFolderName:r.Emstring.em_snippet(o,a.SNIPPET_SIZES.FOLDER_NAME),strong:e=>f.default.createElement("strong",null,e)})},ve=e=>e.formatMessage({id:"2kS9ex",defaultMessage:"Can view"}),Ie=(e,t)=>"editor"===t[".tag"]?(e=>e.formatMessage({id:"R8tdDL",defaultMessage:"Can edit"}))(e):"owner"===t[".tag"]?(e=>e.formatMessage({id:"/epRg4",defaultMessage:"Owner"}))(e):"viewer"===t[".tag"]?ve(e):"viewer_no_comment"===t[".tag"]?(e=>e.formatMessage({id:"pI4aSB",defaultMessage:"View-only"}))(e):ve(e),ye=e=>e.formatMessage({id:"uiUfVo",defaultMessage:"People with a link might still have access."}),Ce=e=>e.formatMessage({id:"J9wEBS",defaultMessage:"Manage Links"}),Re=e=>e.formatMessage({id:"6K7VUR",defaultMessage:"Close"}),Le=e=>e.formatMessage({id:"Tmil/1",defaultMessage:"Couldn’t remove member. Try removing them again."}),Te=(e,t)=>e.formatMessage({id:"Ye9pDs",defaultMessage:"Removing member from <b>{currentFolder}</b>…"},{currentFolder:r.Emstring.em_snippet(t,a.SNIPPET_SIZES.DISPLAY_NAME),b:e=>f.default.createElement("b",{style:{fontWeight:500}},e)}),we=(e,t)=>e.formatMessage({id:"vhAme6",defaultMessage:"Member removed from <b>{currentFolder}</b>."},{currentFolder:r.Emstring.em_snippet(t,a.SNIPPET_SIZES.DISPLAY_NAME),b:e=>f.default.createElement("b",{style:{fontWeight:500}},e)}),Ne=e=>e.formatMessage({id:"/4HTAy",defaultMessage:"Updating member access…"}),Pe=e=>e.formatMessage({id:"OpE7PX",defaultMessage:"Member access updated."}),Fe=e=>e.formatMessage({id:"qMG/h/",defaultMessage:"Couldn’t change access."}),xe=(e,t)=>e.formatMessage({id:"zzQ4WU",defaultMessage:"Changing access for <b>{currentFolder}</b>…"},{currentFolder:r.Emstring.em_snippet(t,a.SNIPPET_SIZES.DISPLAY_NAME),b:e=>f.default.createElement("b",{style:{fontWeight:500}},e)}),De=e=>e.formatMessage({id:"ad6tQw",defaultMessage:"Couldn’t change access. Try changing access again."}),ke=(e,t)=>e.formatMessage({id:"PAzrUg",defaultMessage:"Removing members from <b>{currentFolder}</b>…"},{currentFolder:r.Emstring.em_snippet(t,a.SNIPPET_SIZES.DISPLAY_NAME),b:e=>f.default.createElement("b",{style:{fontWeight:500}},e)}),Oe=e=>e.formatMessage({id:"OyDuPN",defaultMessage:"Couldn’t remove members. Try removing them again."}),Be=e=>e.formatMessage({id:"idUNYc",defaultMessage:"Checkbox"}),je=(e,t,n)=>e.formatMessage({id:"/7+vx5",defaultMessage:"Because {memberName} can edit the parent folder, their access to <b>{contentName}</b> can't be changed."},{memberName:r.Emstring.em_snippet(t,a.SNIPPET_SIZES.DISPLAY_NAME),contentName:r.Emstring.em_snippet(n,a.SNIPPET_SIZES.FILENAME),b:e=>f.default.createElement("b",{style:{fontWeight:500}},e)}),$e=(e,t)=>e.formatMessage({id:"b2R7ut",defaultMessage:"Can't change access for {memberName}"},{memberName:r.Emstring.em_snippet(t,a.SNIPPET_SIZES.DISPLAY_NAME)}),Ue=(e,t)=>e.formatMessage({id:"fP62vP",defaultMessage:"Couldn't change access for {memberName}"},{memberName:r.Emstring.em_snippet(t,a.SNIPPET_SIZES.DISPLAY_NAME)}),He=(e,t,n,s)=>e.formatMessage({id:"kQXitL",defaultMessage:"{count, plural, one{To change their access to <b>{contentName}</b>, you'll need to change their access to the parent folder <b>{singleParentFolderName}</b>.} other{To change their access to <b>{contentName}</b>, you'll need to change their access to the parent folders listed.}}"},{count:t,contentName:r.Emstring.em_snippet(n,a.SNIPPET_SIZES.FILENAME),singleParentFolderName:r.Emstring.em_snippet(s,a.SNIPPET_SIZES.FILENAME),b:e=>f.default.createElement("b",{style:{fontWeight:500}},e)}),Ze=e=>e.formatMessage({id:"DzCuYI",defaultMessage:"Okay"}),We=e=>e.formatMessage({id:"9CMIle",defaultMessage:"Cancel"}),Ge=(e,t)=>e.formatMessage({id:"jc0mkL",defaultMessage:"Couldn't remove {memberName}"},{memberName:r.Emstring.em_snippet(t,a.SNIPPET_SIZES.DISPLAY_NAME)}),Ve=(e,t,n)=>e.formatMessage({id:"1NJLE0",defaultMessage:"Because {memberName} has access to the parent folder, they can't be removed from <b>{contentName}</b>."},{memberName:r.Emstring.em_snippet(t,a.SNIPPET_SIZES.DISPLAY_NAME),contentName:r.Emstring.em_snippet(n,a.SNIPPET_SIZES.FILENAME),b:e=>f.default.createElement("b",{style:{fontWeight:500}},e)}),ze=(e,t,n,s)=>e.formatMessage({id:"wslHDy",defaultMessage:"{count, plural, one{To remove them from <b>{contentName}</b>, you'll need to remove them from the parent folder <b>{singleParentFolderName}</b>.} other{To remove them from <b>{contentName}</b>, you'll need to remove them from the parent folders listed.}}"},{count:t,contentName:r.Emstring.em_snippet(n,a.SNIPPET_SIZES.FILENAME),singleParentFolderName:r.Emstring.em_snippet(s,a.SNIPPET_SIZES.FILENAME),b:e=>f.default.createElement("b",{style:{fontWeight:500}},e)});function Ye(e){return{class:"share",action:"select",object:"manage_access_action",properties:e}}const qe=Symbol("ON_VIEW_MANAGE_ACCESS"),Qe=Symbol("ON_VIEW_PARENT_FOLDER_REMOVE_ACCESS_MODAL"),Je=Symbol("ON_VIEW_PARENT_FOLDER_CHANGE_ACCESS_MODAL"),Ke=Symbol("ON_VIEW_PARENT_FOLDER_CHANGE_INHERITANCE_MODAL"),Xe=Symbol("ON_VIEW_CONFIRMATION_MODAL"),et=Symbol("ON_VIEW_REMOVE_ALL_INHERITED_MEMBERS_CONFIRMATION_MODAL"),tt=Symbol("ON_MEMBER_ACTION_START"),at=Symbol("ON_MEMBER_ACTION_CANCEL"),nt=Symbol("ON_MEMBER_ACTION_SUCCESS"),rt=Symbol("ON_REMOVE_ALL_INHERITED_MEMBERS_START"),st=Symbol("ON_REMOVE_ALL_INHERITED_MEMBERS_CANCEL"),ot=Symbol("ON_REMOVE_ALL_INHERITED_MEMBERS_SUCCESS"),it=Symbol("ON_FAILURE_RENDER"),{useEmitter:lt,defaultEmitter:ct}=a.defineLogger((async({event:e,getContextValue:t})=>{const n=t(a.Context$1),r=t(a.Context$2),s=t(a.Context$3),o={...a.getTags$4(n),...a.getTags$5(r),...a.getTags$6(s),isSm24:"true"},i={...a.getProperties$4(n),...a.getProperties$5(r),...a.getProperties$6(s)};if(e.key!==qe)if(e.key!==Qe)if(e.key!==Je)if(e.key!==Xe)if(e.key!==et)if(e.key!==tt)if(e.key!==at)if(e.key!==nt)if(e.key!==rt)if(e.key!==st)if(e.key!==ot)if(e.key!==Ke){if(e.key!==it)return a.exhausts(e,void 0);a.UDCL.logEvent("ops.view_manage_access_failure",{tags:{...o,eventState:"failed"}})}else a.UDCL.logEvent(fe({...i,manageAccessElement:"parent_folder_change_inheritance_modal"}),{tags:{...o,element:"parent_folder_change_inheritance_modal"}});else a.UDCL.logEnd(Ye({...i,eventState:"success",memberActionType:e.payload.memberActionType}),{tags:{...o,action:e.payload.memberActionType,eventState:"success"}});else a.UDCL.logEnd(Ye({...i,eventState:"canceled",memberActionType:e.payload.memberActionType}),{tags:{...o,action:e.payload.memberActionType,eventState:"canceled"}});else a.UDCL.logStart(Ye({...i,eventState:"start",memberActionType:e.payload.memberActionType}),{tags:{...o,action:e.payload.memberActionType,eventState:"start"}});else a.UDCL.logEnd(Ye({...i,eventState:"success",memberActionType:e.payload.memberActionType,newAccessLevel:e.payload.newAccessLevel?e.payload.newAccessLevel[".tag"]:void 0}),{tags:{...o,action:e.payload.memberActionType,eventState:"success"}});else a.UDCL.logEnd(Ye({...i,eventState:"canceled",memberActionType:e.payload.memberActionType}),{tags:{...o,action:e.payload.memberActionType,eventState:"canceled"}});else a.UDCL.logStart(Ye({...i,eventState:"start",memberActionType:e.payload.memberActionType,prevAccessLevel:e.payload.prevAccessLevel[".tag"]}),{tags:{...o,action:e.payload.memberActionType,eventState:"start"}});else a.UDCL.logEvent(fe({...i,manageAccessElement:"remove_all_inherited_members_confirmation_modal"}),{tags:{...o,element:"remove_all_inherited_members_confirmation_modal"}});else a.UDCL.logEvent(fe({...i,manageAccessElement:"manage_access_confirmation_modal"}),{tags:{...o,element:"manage_access_confirmation_modal"}});else a.UDCL.logEvent(fe({...i,manageAccessElement:"parent_folder_change_access_modal"}),{tags:{...o,element:"parent_folder_change_access_modal"}});else a.UDCL.logEvent(fe({...i,manageAccessElement:"parent_folder_remove_access_modal"}),{tags:{...o,element:"parent_folder_remove_access_modal"}});else a.UDCL.logEvent(fe({...i,manageAccessElement:"manage_access_screen"}),{tags:{...o,element:"manage_access_screen"}})})),mt=(e,t)=>{var a;return!!(null!==(a=e.permissions)&&void 0!==a?a:[]).find((e=>e.action[".tag"]===t[".tag"]&&e.allow))},dt=(e,t)=>{var a;return"user"in e&&null!=e.user?e.user.display_name:"group"in e&&void 0!==e.group?t?((e,t,a)=>"team"===a?e.formatMessage({id:"dQzOmZ",defaultMessage:"Everyone at {team_name}"},{team_name:t.replace(/^Everyone at /,"")}):t)(t,e.group.group_name,null===(a=e.group.group_type)||void 0===a?void 0:a[".tag"]):e.group.group_name:"invitee"in e&&void 0!==e.invitee&&"email"===e.invitee[".tag"]?e.invitee.email:""},ut=(e,t)=>!!t&&("user"in e&&null!=e.user&&e.user.account_id===t.account_id),_t=e=>"user"in e&&null!=e.user?{".tag":"dropbox_id",dropbox_id:e.user.account_id}:"group"in e&&void 0!==e.group?{".tag":"dropbox_id",dropbox_id:e.group.group_id}:"invitee"in e&&void 0!==e.invitee&&"email"===e.invitee[".tag"]?{".tag":"email",email:e.invitee.email}:{".tag":"other"};var gt;!function(e){e[e.RemoveAccess=0]="RemoveAccess",e[e.DowngradeAccess=1]="DowngradeAccess"}(gt||(gt={}));const pt=e=>e.sort(((e,t)=>{const a=dt(e).toLowerCase(),n=dt(t).toLowerCase();return a<n?-1:a>n?1:0})),ft=(e,t,a)=>{const n=((e,t)=>e.formatMessage({id:"b+NGsd",defaultMessage:"{time_str}"},{time_str:t}))(e,It(e,a));return`${t} · ${n}\n`},Et=(e,t)=>t<=0?"":((e,t)=>e.formatMessage({id:"+8e1lg",defaultMessage:"{count, plural, one{and # other} other{and # others}}"},{count:t}))(e,t),ht=[{action:{".tag":"make_editor"},allow:!1},{action:{".tag":"make_owner"},allow:!1},{action:{".tag":"make_viewer"},allow:!1},{action:{".tag":"make_viewer_no_comment"},allow:!1},{action:{".tag":"remove"},allow:!1}],bt=e=>e?e.map((e=>{const{seen_state_user:{user_id:t,display_name:a,email:n,sharing_access_type:r,same_team:s},when_last_seen:o}=e;let i={".tag":"viewer"};return r&&"edit_link_access"===r[".tag"]&&(i={".tag":"editor"}),{access_type:i,user:{account_id:t,display_name:a,email:n||"",same_team:s,disabled:!1},is_inherited:!1,permissions:ht,time_last_seen:o?new Date(1e3*o).toString():void 0}})):[],Mt=6e4,St=36e5,At=864e5,vt=2592e6,It=(e,t,a=new Date)=>{const n=Number(a)-Number(t);if(n>=31536e6)return e.formatDate(t,{year:"numeric",month:"short",day:"numeric"});let r=0,s="minute";switch(n<Mt?(r=0,s="minute"):n<St?(r=Math.floor(n/Mt),s="minute"):n<At?(r=Math.floor(n/St),s="hour"):n<vt?(r=Math.floor(n/At),s="day"):(r=Math.min(11,Math.floor(n/vt)),s="month"),s){case"minute":return 0===r?(e=>e.formatMessage({id:"XP0b1q",defaultMessage:"just now"}))(e):((e,t)=>e.formatMessage({id:"wKaToF",defaultMessage:"{value, plural, one{# minute ago} other{# minutes ago}}"},{value:t}))(e,r);case"hour":return((e,t)=>e.formatMessage({id:"Tq1+vX",defaultMessage:"{value, plural, one{# hour ago} other{# hours ago}}"},{value:t}))(e,r);case"day":return 1===r?(e=>e.formatMessage({id:"YDw317",defaultMessage:"Yesterday"}))(e):((e,t)=>e.formatMessage({id:"jN1kbT",defaultMessage:"{value, plural, one{# day ago} other{# days ago}}"},{value:t}))(e,r);case"month":return 1===r?(e=>e.formatMessage({id:"aCaq4h",defaultMessage:"Last month"}))(e):((e,t)=>e.formatMessage({id:"RfkWNk",defaultMessage:"{value, plural, one{# month ago} other{# months ago}}"},{value:t}))(e,r)}},yt={$props:i.atom({objectIdentifier:{".tag":"file",fileId:""},openLinkSettings:()=>{},onRequestClose:()=>{},onConfirmationModalShownChange:()=>{},onTransferFolderOwnership:()=>{},onChangeConfidentiality:()=>{},onObjectIdentifierChanged:()=>{},objectMetadataResult:{isLoading:!0},objectMembersResult:{isFirstPageLoaded:!1,isLoading:!0},listSharedLinksResult:{isLoading:!0},accountMetadataResult:{isLoading:!0},seenStateInfoResult:{isLoading:!0},customNoOtherMembersScreen:void 0,customErrorScreen:void 0,customErrorScreenWrapper:void 0,useSimpleDowngradeBanner:!1,onMemberListDataLoading:()=>{}}),$showSecurityBanner:i.atom(!1),$securityBannerType:i.atom(gt.DowngradeAccess),$objectIdentifier:i.atom({".tag":"file",fileId:""}),$memberActionsInProgress:i.atom({}),$removeFileMemberFailureData:i.atom(null),$removeFileMemberWarningData:i.atom(null),$changeFileMemberAccessFailureData:i.atom(null),$changeFolderMemberAccessFailureData:i.atom(null),$removeFolderMemberFailureData:i.atom(null),$changeMemberAccessLevelData:i.atom(null),$removeMemberAccessLevelData:i.atom(null),$tempMemberAccessLevelData:i.atom(null),$objectMetadata:i.atom(void 0),$objectMembers:i.atom(void 0),$linksMetadata:i.atom(void 0),$accountMetadata:i.atom(void 0),$seenStateInfo:i.atom(void 0)},{StoreProvider:Ct,useStore:Rt}=i.defineStoreProvider((e=>{const t=i.store(!1),a=i.store(gt.DowngradeAccess),n=i.store({}),r=i.store(null),s=i.store(null),o=i.store(null),l=i.store(null),c=i.store(null),m=i.store(null),d=i.store(null),u=i.store(null),_=i.store(void 0),g=i.store(void 0),p=i.store(void 0),f=i.store(void 0),E=i.store(void 0),h=i.store(e.get().objectIdentifier);return{$props:e,$showSecurityBanner:t,$securityBannerType:a,$objectIdentifier:h,$memberActionsInProgress:n,$removeFileMemberFailureData:r,$removeFileMemberWarningData:o,$changeFileMemberAccessFailureData:s,$changeFolderMemberAccessFailureData:l,$removeFolderMemberFailureData:c,$changeMemberAccessLevelData:m,$removeMemberAccessLevelData:d,$tempMemberAccessLevelData:u,$objectMetadata:_,$objectMembers:g,$linksMetadata:p,$accountMetadata:f,$seenStateInfo:E}}),yt),Lt=e=>{const t=a.useSharingObjectMetadata(e.objectIdentifier.fileId),n=a.useObjectMembers(e.objectIdentifier,!1),s=z(e.objectIdentifier),o=r.useSharingAccountInfo(),i=H(e.objectIdentifier);return f.createElement(Ct,{objectMetadataResult:t,objectMembersResult:n,listSharedLinksResult:s,accountMetadataResult:o,seenStateInfoResult:i,...e})};Lt.displayName="Provider";const Tt=()=>{const e=Rt(),t=n.useIntl(),a=i.useAtom(e.$objectMetadata),s=i.useAtom(e.$objectMembers),o=i.useAtom(e.$linksMetadata),l=i.useAtom(e.$accountMetadata),c=i.useAtom(e.$seenStateInfo);return f.useMemo((()=>{if(!(a&&s&&o&&l&&c))throw u.reportStack("Resolved data for the Content Member List didn't load properly.",{severity:u.SEVERITY.CRITICAL,tags:["content-member-list"]}),r.fail(Se(t)),new Error("Resolved data for the Content Member List is not loaded.");return{objectMetadata:a,objectMembers:s,linksMetadata:o,accountMetadata:l,seenStateInfo:c}}),[a,s,o,l,c,t])},wt=()=>{const e=n.useIntl(),t=Rt(),{objectMetadata:r,linksMetadata:s}=Tt(),{useSimpleDowngradeBanner:o}=i.useAtom(t.$props),l=i.useAtom(t.$showSecurityBanner),c=i.useAtom(t.$securityBannerType),{openLinkSettings:m}=i.useAtom(t.$props),d=s&&null!==a.getEditLinkMetadata(s),u=s&&null!==a.getViewLinkMetadata(s),_=()=>{t.$showSecurityBanner.set(!1)};if(!(a.getCanInvite(r,{".tag":"editor"})||a.getCanInvite(r,{".tag":"viewer"})))return f.createElement(Nt,null);if(d&&l){let t;switch(c){case gt.RemoveAccess:t=ye(e);break;case gt.DowngradeAccess:default:t=(e=>e.formatMessage({id:"Sy/4UA",defaultMessage:"People who can view could still edit via link."}))(e)}return f.createElement(a.Box,{marginBottom:"Micro Small"},f.createElement(Pt,{header:t,transparentButtonLabel:Ce(e),onClickOutlineButton:_,openLinkSettings:m,isSimpleDowngradeBanner:o}))}return u&&l&&c===gt.RemoveAccess?f.createElement(a.Box,{marginBottom:"Micro Small"},f.createElement(Pt,{header:ye(e),transparentButtonLabel:Ce(e),onClickOutlineButton:_,openLinkSettings:m,isSimpleDowngradeBanner:o})):null};wt.displayName="ManageAccessDowngradeBanner";const Nt=()=>{const e=n.useIntl(),t=r.useOpenUrl(),{objectMetadata:s,objectMembers:o,accountMetadata:i}=Tt(),l=r.getIsTeam(i)&&i.team_id===a.getOwnerTeamId(s),c=a.getOwnerTeamName(s),m=r.getIsTeamAdmin(i),d=a.getIsTeamSharedFolder(s),u=a.getIsFolder(s),_=()=>o.groups.some((e=>"team"===(e.group.group_type||{})[".tag"]&&mt(e,{".tag":"make_editor"})&&mt(e,{".tag":"make_viewer"})))&&null!=c?((e,t)=>e.formatMessage({id:"ifarDl",defaultMessage:"This folder is automatically shared with all members of {team_name}."},{team_name:t}))(e,c):l?m?((e,t)=>e.formatMessage({id:"9MdxEb",defaultMessage:"You can manage access in the admin console. <adminLink>Go to admin console</adminLink>"},{adminLink:e=>f.default.createElement(a.Button,{variant:"transparent",size:"small",onClick:()=>t("/team/admin/content/home")},e)}))(e,t):((e,t)=>e.formatMessage({id:"MSVH3B",defaultMessage:"Only admins and group managers can change team folder membership. <findAdminLink>Find admin</findAdminLink>"},{findAdminLink:e=>f.default.createElement(a.Button,{variant:"transparent",size:"small",onClick:()=>t("/team?_tk=left_nav_team")},e)}))(e,t):null!=c?((e,t)=>e.formatMessage({id:"ToMYBy",defaultMessage:"This folder can only be managed by the {ownerTeamName} team."},{ownerTeamName:t}))(e,c):(e=>e.formatMessage({id:"ReqZ5Y",defaultMessage:"This folder can only be managed by the owner team."}))(e),g=()=>u?(e=>e.formatMessage({id:"qQ/mzN",defaultMessage:"You don’t have permission to manage membership of this folder."}))(e):(e=>e.formatMessage({id:"+xrZUw",defaultMessage:"You don’t have permission to manage membership of this file."}))(e);return f.createElement(a.Box,{marginBottom:"Micro Small"},f.createElement(a.Banner,null,f.createElement(a.Banner.Message,null,d?_():g())))};Nt.displayName="NoPermissionBanner";const Pt=({header:e,onClickOutlineButton:t,openLinkSettings:r,transparentButtonLabel:s,isSimpleDowngradeBanner:o})=>{const i=n.useIntl(),l=o?Re(i):void 0,c=o?f.createElement(a.Box,{style:{display:"flex",flexDirection:"column",marginRight:"16px"}},f.createElement(a.Text,null,(e=>e.formatMessage({id:"38tA2b",defaultMessage:"People with a link might still have access. Delete the link to remove access."}))(i))):f.createElement(a.Box,{style:{display:"flex",flexDirection:"column",marginBottom:"8px"}},f.createElement(a.Text,null,e),f.createElement(a.Text,null,(e=>e.formatMessage({id:"ov3n4T",defaultMessage:"Delete the link to restrict access."}))(i)));return f.createElement(a.Banner,{style:{padding:"12px"},withCloseButton:l,onRequestClose:t},c,!o&&f.createElement(a.Box,{style:{gap:"8px",display:"flex",flexDirection:"row",alignItems:"center"}},f.createElement(a.Button,{variant:"outline",onClick:t},f.createElement(a.Text,{size:"small",isBold:!0},(e=>e.formatMessage({id:"YCTkuR",defaultMessage:"Got It"}))(i))),f.createElement(a.Button,{variant:"transparent",onClick:()=>{r&&r({initialTab:"edit_link_settings"})}},f.createElement(a.Text,{size:"small",isBold:!0},s))))};Pt.displayName="DowngradeBanner";const Ft=r.define({name:"sharing.relinquishFolderMembership"},(e=>t=>r.handler(e.sharingRelinquishFolderMembership(t)))),xt=r.define({name:"sharing.sharingCheckJobStatus"},(e=>t=>r.handler(e.sharingCheckJobStatus(t)))),Dt=r.create({name:"CheckRelinquishFolderMembershipJobStatus"},(()=>{const e=r.useEndpoint(xt);return f.useCallback((async({asyncJobId:t})=>{const a=await e({async_job_id:t});return"FATAL"===a.status?r.failure("NetworkFailure",{response:a}):"ERROR"===a.status?r.failure("ApiError",{response:a}):"in_progress"===a.output[".tag"]?r.success("InProgress",{response:{...a,output:a.output}}):"failed"===a.output[".tag"]?r.failure("Failed",{response:{...a,output:a.output}}):"complete"===a.output[".tag"]?r.success("Complete",{response:{...a,output:a.output}}):r.failureExhaustsAllTypes(a.output)}),[e])})),kt=r.create({name:"PollCheckRelinquishFolderMembershipJobStatus"},(()=>{const e=r.useAction(Dt);return f.useCallback((async({asyncJobId:t,timeout:a,interval:n})=>{const s=await r.poll((async()=>{const a=await e({asyncJobId:t});return"InProgress"===a.type?{status:"RETRY"}:{status:"COMPLETE",output:a}}),{timeout:a,interval:n});return"TIMEOUT"===s.status?r.failure("Timeout",null):"ERROR"===s.status?r.failureUncaughtException(s.error):s.output.success?r.success("Complete",s.output.value):s.output}),[e])})),Ot=r.create({name:"RelinquishFolderMembership"},(()=>{const e=r.useEndpoint(Ft),t=r.useAction(kt);return f.useCallback((async({relinquishFolderMembershipArg:a,timeout:n,interval:s})=>{const o=await e(a);if("ERROR"===o.status)return r.failure("ApiError",{response:o});if("FATAL"===o.status)return r.failure("NetworkFailure",{response:o});if("complete"===o.output[".tag"])return r.success("Complete",{response:{...o,output:o.output}});if("async_job_id"!==o.output[".tag"])return r.failureExhaustsAllTypes(o.output);const i=await t({asyncJobId:o.output.async_job_id,timeout:n,interval:s});return i.success?r.success("PollingComplete",i.value):"ApiError"===i.type?r.failure("PollingApiError",i.value):"NetworkFailure"===i.type?r.failure("PollingNetworkFailure",i.value):"Failed"===i.type?r.failure("PollingFailed",i.value):"Timeout"===i.type?r.failure("PollingTimeout",i.value):i}),[e,t])})),Bt=r.define({name:"sharing.removeFolderMember"},(e=>t=>r.handler(e.sharingRemoveFolderMemberV2(t)))),jt=r.define({name:"sharing.checkRemoveMemberJobStatus"},(e=>t=>r.handler(e.sharingCheckRemoveMemberJobStatus(t)))),$t=r.create({name:"CheckRemoveFolderMemberJobStatus"},(()=>{const e=r.useEndpoint(jt);return f.useCallback((async({asyncJobId:t})=>{const a=await e({async_job_id:t});return"FATAL"===a.status?r.failure("NetworkFailure",{response:a}):"ERROR"===a.status?r.failure("ApiError",{response:a}):"in_progress"===a.output[".tag"]?r.success("InProgress",{response:{...a,output:a.output}}):"failed"===a.output[".tag"]?r.failure("Failed",{response:{...a,output:a.output}}):"complete"===a.output[".tag"]?r.success("Complete",{response:{...a,output:a.output}}):r.failureExhaustsAllTypes(a.output)}),[e])})),Ut=r.create({name:"PollCheckRemoveFolderMemberJobStatus"},(()=>{const e=r.useAction($t);return f.useCallback((async({asyncJobId:t,timeout:a,interval:n})=>{const s=await r.poll((async()=>{const a=await e({asyncJobId:t});return"InProgress"===a.type?{status:"RETRY"}:{status:"COMPLETE",output:a}}),{timeout:a,interval:n});return"TIMEOUT"===s.status?r.failure("Timeout",null):"ERROR"===s.status?r.failureUncaughtException(s.error):s.output.success?r.success("Complete",s.output.value):s.output}),[e])})),Ht=r.create({name:"RemoveFolderMember"},(()=>{const e=r.useEndpoint(Bt),t=r.useAction(Ut);return f.useCallback((async({removeFolderMemberArg:a,timeout:n,interval:s})=>{const o=await e(a);if("ERROR"===o.status)return r.failure("ApiError",{response:o});if("FATAL"===o.status)return r.failure("NetworkFailure",{response:o});const i=await t({asyncJobId:o.output.async_job_id,timeout:n,interval:s});return i.success?r.success("PollingComplete",i.value):"ApiError"===i.type?r.failure("PollingApiError",i.value):"NetworkFailure"===i.type?r.failure("PollingNetworkFailure",i.value):"Failed"===i.type?r.failure("PollingFailed",i.value):"Timeout"===i.type?r.failure("PollingTimeout",i.value):i}),[e,t])})),Zt=r.define({name:"sharing.getParentFolderAccess"},(e=>t=>r.handler(e.sharingGetParentFolderAccess(t)))),Wt=r.define({name:"sharing.relinquishFileMembership"},(e=>t=>r.handler(e.sharingRelinquishFileMembership(t)))),Gt=r.define({name:"sharing.removeFileMember2"},(e=>t=>r.handler(e.sharingRemoveFileMember2(t)))),Vt=r.define({name:"sharing.transferFolder"},(e=>t=>r.handler(e.sharingTransferFolderV2(t)))),zt=r.define({name:"sharing.updateFileMember"},(e=>t=>r.handler(e.sharingUpdateFileMember(t)))),Yt=r.define({name:"sharing.updateFolderMember"},(e=>t=>r.handler(e.sharingUpdateFolderMemberV2(t)))),qt=e=>{const t=Rt(),a=lt();return f.useCallback((n=>{a.select(tt).emit({memberActionType:e,prevAccessLevel:n.access_type});const s=_t(n),o=t.$memberActionsInProgress.get();t.$memberActionsInProgress.set({...o,[r.getUniqueId(s)]:!0})}),[a,e,t.$memberActionsInProgress])},Qt=e=>{const t=Rt(),n=lt();return f.useCallback((async(s,o)=>{n.select(at).emit({memberActionType:e});const i=t.$memberActionsInProgress.get(),l=_t(s),c={...i};delete c[r.getUniqueId(l)],await a.invalidateObjectMembers(o),window.requestAnimationFrame((()=>{t.$memberActionsInProgress.set({...c})}))}),[n,e,t.$memberActionsInProgress])},Jt=()=>{const e=n.useIntl();return f.useCallback((()=>{r.fail((e=>e.formatMessage({id:"xn+a8/",defaultMessage:"An unexpected error has occurred."}))(e))}),[e])},Kt=()=>{const e=Rt();return f.useCallback((t=>{e.$props.get().onConfirmationModalShownChange(t)}),[e])},Xt=async(e,t=6,a=1e4)=>{let n=0,r={};for(;!(null==r?void 0:r.success)&&n<t;){if(r=await e(),r.success)return r;n++,n<t&&await new Promise((e=>setTimeout(e,a)))}return r},ea=()=>{const e=Rt(),t=r.useLogger(),a=r.useAction(r.action);return f.useCallback((async({sharedFolderId:e,inProgressMessage:n,setToConfidential:s,keepInheritedMembers:o=!1})=>{r.inProgress(n),t("SHARE_MODAL_MANAGE_ACCESS__SET_ACCESS_INHERITANCE__API_START",null);const i=await a({setAccessInheritanceArg:{shared_folder_id:e,access_inheritance:s?{".tag":"no_inherit"}:{".tag":"inherit"},keep_inherited_members:s?o:void 0},timeout:12e4,interval:1e3});return i.success?t("SHARE_MODAL_MANAGE_ACCESS__SET_ACCESS_INHERITANCE__API_SUCCESS",null):t("SHARE_MODAL_MANAGE_ACCESS__SET_ACCESS_INHERITANCE__API_FAILURE",{output:i}),i}),[e.$props,t,a])},ta=()=>{const e=Rt(),t=r.useLogger(),a=i.useAtom(e.$objectIdentifier),n=r.useAction(r.action$1);return f.useCallback((async({onStart:e,onInProgress:r,onCancel:s,onSuccess:o,onError:i,setToConfidential:l})=>{if(t("SHARE_MODAL_MANAGE_ACCESS__SHARE_FILE_FOLDER__API_START",null),e(),"file_folder"!==a[".tag"])return i(),null;r();const c=void 0!==l?l?{".tag":"confidential"}:{".tag":"not_confidential"}:void 0,m=await n({path:a.path,timeout:12e4,interval:1e3,confidentiality:c});if(!m.success)return"ApiError"===m.type&&"bad_path"===m.value.response.error[".tag"]&&"already_shared"===m.value.response.error.bad_path[".tag"]&&m.value.response.error.bad_path.shared_folder_id?(t("SHARE_MODAL_MANAGE_ACCESS__SHARE_FILE_FOLDER__API_FAILURE",{output:m}),m.value.response.error.bad_path.shared_folder_id):(t("SHARE_MODAL_MANAGE_ACCESS__SHARE_FILE_FOLDER__API_FAILURE",{output:m}),s(),i(),null);t("SHARE_MODAL_MANAGE_ACCESS__SHARE_FILE_FOLDER__API_SUCCESS",null);const d=m.value.response.output.shared_folder_id;return o(d),d}),[t,a,n])},aa=()=>{const e=Rt(),t=i.useAtom(e.$objectIdentifier),a=Jt(),n=ta(),s=qt("share_folder"),o=Qt("share_folder"),l=(()=>{const e=lt();return f.useCallback((()=>{e.select(nt).emit({memberActionType:"share_folder"})}),[e])})();return f.useCallback((async(e,i)=>await n({onStart:()=>{s(e)},onInProgress:()=>{r.inProgress(i)},onCancel:()=>{o(e,t)},onSuccess:()=>{l()},onError:()=>{a()}})),[n,s,o,t,l,a])},na=()=>{const e=Rt(),{objectMetadata:t}=Tt(),s=r.useLogger(),o=n.useIntl(),l=i.useAtom(e.$objectIdentifier),{onObjectIdentifierChanged:c}=i.useAtom(e.$props),m=Jt(),d=aa(),_=ea(),g=r.useEndpoint(zt),p=r.useEndpoint(Yt),E=r.useEndpoint(Zt),h=Qt("change_member_access"),b=(()=>{const e=Rt(),t=lt();return f.useCallback((async(n,s,o)=>{t.select(nt).emit({memberActionType:"change_member_access",newAccessLevel:o});const l=e.$memberActionsInProgress.get(),c=_t(n),m={...l};delete m[r.getUniqueId(c)],i.batch((()=>{e.$tempMemberAccessLevelData.set({accessLevel:o,member:c}),e.$memberActionsInProgress.set(m)})),await a.invalidateObjectMembers(s)}),[t,e.$memberActionsInProgress,e.$tempMemberAccessLevelData])})(),M=qt("change_member_access");return f.useCallback((async(n,i,f)=>{var S,A;const v=f.is_inherited&&"viewer"===n[".tag"]&&"viewer"!==(null===(S=f.inherited_access_type)||void 0===S?void 0:S[".tag"]);if(M(f),t&&a.getIsFile(t)){const i=_t(f),c={file:a.isNewApiMetadata(t)?(null===(A=t.common_metadata)||void 0===A?void 0:A.file_id)||"":t.id,member:i,access_level:n};s("SHARE_MODAL_MANAGE_ACCESS__UPDATE_FILE_MEMBER_ACCESS__API_START",null),v||r.inProgress(Ne(o));const d=await g(c);"SUCCESS"===d.status?(s("SHARE_MODAL_MANAGE_ACCESS__UPDATE_FILE_MEMBER_ACCESS__API_SUCCESS",{response:d}),d.output.access_level&&d.output.access_level!==n?(h(f,l),e.$changeFileMemberAccessFailureData.set({error:d.output,member:i})):(b(f,l,n),r.complete(Pe(o)))):("ERROR"===d.status?(r.fail(Fe(o)),s("SHARE_MODAL_MANAGE_ACCESS__UPDATE_FILE_MEMBER_ACCESS__API_ERROR",{response:d})):s("SHARE_MODAL_MANAGE_ACCESS__UPDATE_FILE_MEMBER_ACCESS__API_FATAL",{response:d}),h(f,l),m())}else if(t&&(a.getIsSharedFolder(t)||a.getIsNonSharedFolder(t)&&i)){const g=a.getName(t);let E=a.getIsNonSharedFolder(t)?null:a.getSharedFolderId(t);if(a.getIsNonSharedFolder(t)&&(E=await d(f,xe(o,g))),!E)return a.invalidateSharingObjectMetadata(l),void u.reportException({err:new Error("Failed to update member access level. Shared folder ID is null."),tags:["sharing","content-member-list","update-member-action"],severity:u.SEVERITY.CRITICAL});const M={".tag":"shared_folder",sharedFolderId:E,fileId:l.fileId};if(i){const t=await Xt((()=>_({sharedFolderId:E,inProgressMessage:xe(o,g),setToConfidential:!0,keepInheritedMembers:!0})));if(e.$props.get().onChangeConfidentiality(),!t.success)return r.fail(De(o)),u.reportException({err:new Error("Failed to update member access level. Access inheritance response is not successful."),tags:["sharing","content-member-list","update-member-action"],severity:u.SEVERITY.CRITICAL}),void c(M);a.invalidateSharingObjectMetadata(M)}s("SHARE_MODAL_MANAGE_ACCESS__UPDATE_FOLDER_MEMBER_ACCESS__API_START",null),v||r.inProgress(Ne(o));const S=_t(f),A=await p({shared_folder_id:E,member:S,access_level:n});"SUCCESS"===A.status?(s("SHARE_MODAL_MANAGE_ACCESS__UPDATE_FOLDER_MEMBER_ACCESS__API_SUCCESS",{response:A}),A.output.access_level&&A.output.access_level!==n?(a.invalidateObjectMembers(M),h(f,M),e.$changeMemberAccessLevelData.set({data:A.output||[],member:S})):(b(f,M,n),r.complete(Pe(o)))):"ERROR"===A.status?(s("SHARE_MODAL_MANAGE_ACCESS__UPDATE_FOLDER_MEMBER_ACCESS__API_ERROR",{response:A}),r.fail(Fe(o)),e.$changeFolderMemberAccessFailureData.set({error:A.error,member:S}),h(f,M)):(s("SHARE_MODAL_MANAGE_ACCESS__UPDATE_FOLDER_MEMBER_ACCESS__API_FATAL",{response:A}),h(f,M),m(),r.fail(De(o))),c(M)}else if(t&&a.getIsNonSharedFolder(t)){if("viewer"===n[".tag"]){s("SHARE_MODAL_MANAGE_ACCESS__GET_PARENT_FOLDER_ACCESS__API_START",null);const r=_t(f),o=await E({shared_folder_id:a.getParentSharedFolderId(t)||"",member:r,access_level:n});return void("SUCCESS"===o.status?(s("SHARE_MODAL_MANAGE_ACCESS__GET_PARENT_FOLDER_ACCESS__API_SUCCESS",{response:o}),e.$changeMemberAccessLevelData.set({member:r,data:o.output})):("ERROR"===o.status?s("SHARE_MODAL_MANAGE_ACCESS__GET_PARENT_FOLDER_ACCESS__API_ERROR",{response:o}):s("SHARE_MODAL_MANAGE_ACCESS__GET_PARENT_FOLDER_ACCESS__API_FATAL",{response:o}),m()))}const i=await d(f,Ne(o));if(!i)return a.invalidateSharingObjectMetadata(l),void u.reportException({err:new Error("Failed to update member access level. Shared folder ID is null."),tags:["sharing","content-member-list","update-member-action"],severity:u.SEVERITY.CRITICAL});const _={".tag":"shared_folder",sharedFolderId:i};c(_),s("SHARE_MODAL_MANAGE_ACCESS__UPDATE_FOLDER_MEMBER_ACCESS__API_START",null);const g=_t(f),M=await p({shared_folder_id:i||"",member:g,access_level:n});"SUCCESS"===M.status?(s("SHARE_MODAL_MANAGE_ACCESS__UPDATE_FOLDER_MEMBER_ACCESS__API_SUCCESS",{response:M}),M.output.access_level&&M.output.access_level!==n?(h(f,_),e.$changeMemberAccessLevelData.set({data:M.output||[],member:g})):(b(f,_,n),r.complete(Pe(o)))):("ERROR"===M.status?s("SHARE_MODAL_MANAGE_ACCESS__UPDATE_FOLDER_MEMBER_ACCESS__API_ERROR",{response:M}):s("SHARE_MODAL_MANAGE_ACCESS__UPDATE_FOLDER_MEMBER_ACCESS__API_FATAL",{response:M}),h(f,_),m(),r.fail(De(o)))}}),[M,t,s,g,o,h,l,e,b,m,c,p,d,_,E])},ra=()=>{const e=Rt(),{objectMetadata:t}=Tt(),s=r.useLogger(),o=n.useIntl(),l=r.useEndpoint(Wt),c=r.useAction(Ot),m=i.useAtom(e.$objectIdentifier),{onObjectIdentifierChanged:d}=i.useAtom(e.$props),_=aa(),g=ea(),p=Jt(),E=qt("relinquish_folder_membership"),h=Qt("relinquish_folder_membership"),b=(()=>{const e=Rt(),t=lt();return f.useCallback((async()=>{t.select(nt).emit({memberActionType:"relinquish_folder_membership"}),e.$props.get().onRequestClose()}),[t,e.$props])})();return f.useCallback((async(n,i,f)=>{var M;if(t&&a.getIsFile(t)){E(n),s("SHARE_MODAL_MANAGE_ACCESS__RELINQUISH_FILE_MEMBERSHIP__API_START",null);const e=await l({file:a.isNewApiMetadata(t)?(null===(M=t.common_metadata)||void 0===M?void 0:M.file_id)||"":t.id});h(n,m),"SUCCESS"===e.status?(s("SHARE_MODAL_MANAGE_ACCESS__RELINQUISH_FILE_MEMBERSHIP__API_SUCCESS",{response:e}),b()):("ERROR"===e.status?s("SHARE_MODAL_MANAGE_ACCESS__RELINQUISH_FILE_MEMBERSHIP__API_ERROR",{response:e}):s("SHARE_MODAL_MANAGE_ACCESS__RELINQUISH_FILE_MEMBERSHIP__API_FATAL",{response:e}),p())}if(t&&(a.getIsSharedFolder(t)||a.getIsNonSharedFolder(t)&&i)){const l=a.getName(t);let M=a.getIsNonSharedFolder(t)?null:a.getSharedFolderId(t);if(a.getIsNonSharedFolder(t)&&(M=await _(n,Te(o,l))),!M)return void u.reportException({err:new Error("Failed to remove member. Shared folder ID is null."),tags:["sharing","content-member-list","remove-member-action"],severity:u.SEVERITY.CRITICAL});const S={".tag":"shared_folder",sharedFolderId:M,fileId:m.fileId};if(d(S),i){const t=await g({sharedFolderId:M,inProgressMessage:Te(o,l),setToConfidential:!0,keepInheritedMembers:!0});if(e.$props.get().onChangeConfidentiality(),!t.success)return h(n,S),p(),r.fail(Le(o)),void u.reportException({err:new Error("Failed to update member access level. Access inheritance response is not successful."),tags:["sharing","content-member-list","update-member-action"],severity:u.SEVERITY.CRITICAL});a.invalidateSharingObjectMetadata(S)}if(null!==M&&void 0!==f){E(n),s("SHARE_MODAL_MANAGE_ACCESS__RELINQUISH_FOLDER_MEMBERSHIP__API_START",null);const e=await c({relinquishFolderMembershipArg:{shared_folder_id:M,leave_a_copy:f},timeout:12e4,interval:1e3});h(n,S),e.success?(s("SHARE_MODAL_MANAGE_ACCESS__RELINQUISH_FOLDER_MEMBERSHIP__API_SUCCESS",null),b(),r.complete(we(o,l))):(s("SHARE_MODAL_MANAGE_ACCESS__RELINQUISH_FOLDER_MEMBERSHIP__API_FAILURE",{output:e}),p(),r.fail(Le(o)))}}}),[t,E,s,l,h,m,b,p,d,_,o,g,c])},sa=()=>{const e=Rt(),{objectMetadata:t}=Tt(),s=r.useLogger(),o=n.useIntl(),l=r.useEndpoint(Gt),c=r.useEndpoint(Zt),m=r.useAction(Ht),d=i.useAtom(e.$objectIdentifier),{onObjectIdentifierChanged:_}=i.useAtom(e.$props),g=aa(),p=ea(),E=Jt(),h=Qt("remove_member"),b=qt("remove_member"),M=(()=>{const e=Rt(),t=lt();return f.useCallback((async(n,s)=>{t.select(nt).emit({memberActionType:"remove_member"});const o=_t(n),i={...e.$memberActionsInProgress.get()};delete i[r.getUniqueId(o)],await a.invalidateObjectMembers(s),window.requestAnimationFrame((()=>{e.$memberActionsInProgress.set(i)}))}),[t,e.$memberActionsInProgress])})();return f.useCallback((async(n,i,S,A)=>{var v;const I=_t(n);if(t&&a.getIsFile(t)){b(n),s("SHARE_MODAL_MANAGE_ACCESS__REMOVE_FILE_MEMBER__API_START",null);const r=await l({file:a.isNewApiMetadata(t)?(null===(v=t.common_metadata)||void 0===v?void 0:v.file_id)||"":t.id,member:I});"SUCCESS"===r.status?s("SHARE_MODAL_MANAGE_ACCESS__REMOVE_FILE_MEMBER__API_SUCCESS",{response:r}):"ERROR"===r.status?s("SHARE_MODAL_MANAGE_ACCESS__REMOVE_FILE_MEMBER__API_ERROR",{response:r}):s("SHARE_MODAL_MANAGE_ACCESS__REMOVE_FILE_MEMBER__API_FATAL",{response:r}),"SUCCESS"===r.status?"success"===r.output[".tag"]&&r.output.access_level?(h(n,d),e.$removeFileMemberWarningData.set({error:r.output,member:I})):M(n,d):"ERROR"===r.status&&"no_explicit_access"===r.error[".tag"]?(h(n,d),e.$removeFileMemberFailureData.set({error:r.error,member:I})):(h(n,d),E())}if(t&&(a.getIsSharedFolder(t)||a.getIsNonSharedFolder(t)&&i)){let l=a.getIsNonSharedFolder(t)?null:a.getSharedFolderId(t);const c=a.getName(t);if(a.getIsNonSharedFolder(t)&&(l=await g(n,S?ke(o,c):Te(o,c))),!l)return void u.reportException({err:new Error("Failed to remove member. Shared folder ID is null."),tags:["sharing","content-member-list","remove-member-action"],severity:u.SEVERITY.CRITICAL});const v={".tag":"shared_folder",sharedFolderId:l,fileId:d.fileId};if(i){const t=await Xt((()=>p({sharedFolderId:l,inProgressMessage:S?ke(o,c):Te(o,c),setToConfidential:!0,keepInheritedMembers:!0})));if(e.$props.get().onChangeConfidentiality(),!t.success)return h(n,v),E(),r.fail(S?Oe(o):Le(o)),u.reportException({err:new Error("Failed to update member access level. Access inheritance response is not successful."),tags:["sharing","content-member-list","update-member-action"],severity:u.SEVERITY.CRITICAL}),_(v),void h(n,v)}if(null!==l&&void 0!==A){b(n),s("SHARE_MODAL_MANAGE_ACCESS__REMOVE_FOLDER_MEMBER__API_START",null);const t=await m({removeFolderMemberArg:{shared_folder_id:l,member:I,leave_a_copy:A},timeout:12e4,interval:1e3});if(t.success){if(s("SHARE_MODAL_MANAGE_ACCESS__REMOVE_FOLDER_MEMBER__API_SUCCESS",null),"complete"===t.value.response.output[".tag"]&&t.value.response.output.access_level)return h(n,v),void e.$removeMemberAccessLevelData.set({member:I,data:t.value.response.output});M(n,v),r.complete(S?((e,t)=>e.formatMessage({id:"yqWm25",defaultMessage:"Members removed from <b>{currentFolder}</b>."},{currentFolder:r.Emstring.em_snippet(t,a.SNIPPET_SIZES.DISPLAY_NAME),b:e=>f.default.createElement("b",{style:{fontWeight:500}},e)}))(o,c):we(o,c))}else"ApiError"===t.type?(s("SHARE_MODAL_MANAGE_ACCESS__REMOVE_FOLDER_MEMBER__API_FAILURE",{output:t}),e.$removeFolderMemberFailureData.set({error:t.value.response.error,member:I}),h(n,v)):(s("SHARE_MODAL_MANAGE_ACCESS__REMOVE_FOLDER_MEMBER__API_FAILURE",{output:t}),h(n,v),E(),r.fail(S?Oe(o):Le(o)))}_(v)}else if(t&&a.getIsNonSharedFolder(t)){s("SHARE_MODAL_MANAGE_ACCESS__GET_PARENT_FOLDER_ACCESS__API_START",null);const n=await c({shared_folder_id:a.getParentSharedFolderId(t)||"",member:I});"SUCCESS"===n.status?(s("SHARE_MODAL_MANAGE_ACCESS__GET_PARENT_FOLDER_ACCESS__API_SUCCESS",{response:n}),e.$removeMemberAccessLevelData.set({member:I,data:n.output})):("ERROR"===n.status?s("SHARE_MODAL_MANAGE_ACCESS__GET_PARENT_FOLDER_ACCESS__API_ERROR",{response:n}):s("SHARE_MODAL_MANAGE_ACCESS__GET_PARENT_FOLDER_ACCESS__API_FATAL",{response:n}),E())}}),[t,b,s,l,h,d,e,M,E,_,g,o,p,m,c])},oa=()=>{const e=Rt(),{objectMetadata:t}=Tt(),s=r.useLogger(),o=r.useEndpoint(Vt),l=Jt(),c=n.useIntl(),m=i.useAtom(e.$objectIdentifier),d=qt("transfer_folder_ownership"),u=Qt("transfer_folder_ownership"),_=(()=>{const e=Rt(),t=lt();return f.useCallback((async()=>{t.select(nt).emit({memberActionType:"transfer_folder_ownership"}),await e.$props.get().onTransferFolderOwnership()}),[t,e.$props])})();return f.useCallback((async(e,n,i)=>{if(!t||t&&!a.getIsSharedFolder(t))throw new Error("Unsupported file type.");d(n),s("SHARE_MODAL_MANAGE_ACCESS__TRANSFER_FOLDER__API_START",null);const g=await o({shared_folder_id:a.getSharedFolderId(t),to_dropbox_id:e});"SUCCESS"===g.status?(s("SHARE_MODAL_MANAGE_ACCESS__TRANSFER_FOLDER__API_SUCCESS",null),await _(),r.complete(((e,t)=>e.formatMessage({id:"BNpXMo",defaultMessage:"Made {displayName} the owner."},{displayName:t}))(c,i))):(u(n,m),"ERROR"===g.status?s("SHARE_MODAL_MANAGE_ACCESS__TRANSFER_FOLDER__API_ERROR",{response:g}):"FATAL"===g.status&&s("SHARE_MODAL_MANAGE_ACCESS__TRANSFER_FOLDER__API_FATAL",{response:g}),l())}),[t,d,s,o,u,m,_,c,l])},ia=()=>{const e=Rt(),{objectMetadata:t}=Tt(),s=n.useIntl(),o=i.useAtom(e.$objectIdentifier),{onObjectIdentifierChanged:l}=i.useAtom(e.$props),c=Jt(),m=(()=>{const e=lt();return f.useCallback((()=>{e.select(rt).emit({memberActionType:"remove_all_inherited_members"})}),[e])})(),d=(()=>{const e=lt();return f.useCallback((()=>{e.select(st).emit({memberActionType:"remove_all_inherited_members"})}),[e])})(),_=(()=>{const e=Rt(),t=lt();return f.useCallback((async(n,r=!1)=>{r||t.select(ot).emit({memberActionType:"remove_all_inherited_members"}),await a.invalidateObjectMembers(n),e.$props.get().onChangeConfidentiality()}),[t,e.$props])})(),g=ta(),p=ea();return f.useCallback((async n=>{if(!t)return c(),null;const i=async()=>{const a=e.$objectIdentifier.get();if("shared_folder"!==a[".tag"])return void u.reportException({err:new Error("Failed to remove all inherited members. Object identifier is not a shared folder."),tags:["sharing","content-member-list","remove-all-inherited-members-action"],severity:u.SEVERITY.CRITICAL});const n=await p({sharedFolderId:a.sharedFolderId,inProgressMessage:be(s,!1,t),setToConfidential:!1});e.$props.get().onChangeConfidentiality(),n.success?(r.complete(Ae(s,!1,t)),_(a,!0)):r.fail(Me(s,!1))};if("shared_folder"===o[".tag"]){m();const l=await p({sharedFolderId:o.sharedFolderId,inProgressMessage:be(s,n,t),setToConfidential:!0,keepInheritedMembers:!1});return e.$props.get().onChangeConfidentiality(),l.success?(r.completeWithUndo({title:Ae(s,n,t),onUndoClick:i}),await a.invalidateObjectMembers(o),_(o)):(r.fail(Me(s,!0)),d()),o.sharedFolderId}{const n=n=>{r.completeWithUndo({title:Ae(s,!0,t),onUndoClick:i});const c={".tag":"shared_folder",sharedFolderId:n,fileId:o.fileId};a.invalidateSharingObjectMetadata(o),e.$objectIdentifier.set(c),_(c),l(c)},c=()=>{r.inProgress(be(s,!0,t))},u=()=>{r.fail(Me(s,!0))};return await g({onStart:()=>{m()},onInProgress:c,onCancel:()=>{d()},onSuccess:n,onError:u,setToConfidential:!0})}}),[t,o,c,e.$objectIdentifier,p,s,m,_,d,g,l])},la=({isOpen:e,onClose:t})=>{const{objectMetadata:s}=Tt(),o=lt(),i=n.useIntl(),l=r.usePlatform()!==r.Platforms.DESKTOP,c=Kt(),m=ia();if(f.useEffect((()=>{c(e)}),[e,c]),f.useEffect((()=>{e&&o.select(et).emit(null)}),[e,o]),!e)return null;const d=a.getName(s),u=a.getParentFolderName(s);return f.createElement(f.Fragment,null,f.createElement(a.Modal,{open:e,isCentered:!0,withCloseButton:l?Re(i):void 0,onRequestClose:()=>{t()}},f.createElement(a.Modal.Header,{hasBottomSpacing:"title-standard"},f.createElement(a.Modal.Title,null,((e,t)=>e.formatMessage({id:"V8posb",defaultMessage:"Remove members of “{parentFolderName}” folder?"},{parentFolderName:r.Emstring.em_snippet(t,a.SNIPPET_SIZES.FOLDER_NAME)}))(i,u))),f.createElement(a.Modal.Body,null,((e,t,n)=>e.formatMessage({id:"YMtvO3",defaultMessage:"Members of <b>{parentFolderName}</b> folder won’t be able to access <b>{folderName}</b>."},{parentFolderName:r.Emstring.em_snippet(t,a.SNIPPET_SIZES.FOLDER_NAME),folderName:r.Emstring.em_snippet(n,a.SNIPPET_SIZES.FOLDER_NAME),b:e=>f.default.createElement("b",{style:{fontWeight:500}},e)}))(i,u,d)),f.createElement(a.Modal.Footer,null,f.createElement(a.Button,{variant:"opacity",onClick:()=>{t()}},(e=>e.formatMessage({id:"JJWPQC",defaultMessage:"Cancel"}))(i)),f.createElement(a.Button,{variant:"primary",onClick:()=>{t(),m(!0)}},(e=>e.formatMessage({id:"0BoZ69",defaultMessage:"Remove"}))(i)))))};la.displayName="RemoveAllInheritedMembersConfirmationModal";const ca=e=>{if("member_error"===e[".tag"]){const t=e.member_error;if("no_explicit_access"===t[".tag"]){return t.access_details||[]}}return[]},ma=e=>{const{intl:t,folderName:n,folderPath:r,role:s,isPaired:o,onManageAccessClicked:i}=e,l=((e,t)=>e?`/${t}`:"/home")(o,s),c=`${l}${r}?share_manage_access=true`;return f.createElement(a.Menu.Row,{preferComposition:!0,style:{height:"57px",alignItems:"center"}},f.createElement(a.Menu.RowAccessory,null,f.createElement(_.FolderSharedDefaultSmall,null)),f.createElement(a.Menu.RowContent,null,f.createElement(a.Truncate,{location:.5},f.createElement(a.Menu.RowTitle,null,n))),f.createElement(a.Menu.RowAccessory,null,f.createElement(a.Button,{variant:"transparent",onClick:()=>{i(c)},size:"small"},(e=>e.formatMessage({id:"Ca+R4I",defaultMessage:"Manage Access"}))(t))))},da=e=>{const t=Rt(),a=Kt(),n=Qt("change_member_access"),r=i.useAtom(t.$props).objectIdentifier;return f.useCallback((()=>{t.$changeFileMemberAccessFailureData.set(null),t.$changeFolderMemberAccessFailureData.set(null),t.$changeMemberAccessLevelData.set(null),a(!1),n(e,r)}),[e,r,a,n,t])},ua=({member:e})=>{var t;const s=Rt(),o=lt(),l=n.useIntl(),{objectMetadata:c}=Tt(),m=i.useAtom(s.$changeFileMemberAccessFailureData),d=dt(e,l),u=r.usePlatform()!==r.Platforms.DESKTOP,_=f.useRef(!1),g=m&&m.error.access_details;f.useEffect((()=>{_.current||g&&(_.current=!0,o.select(Je).emit(null))}),[g,o]);const p=da(e),E=Kt();if(!g)return null;const h=m.error.access_details,b=h?h[0]:void 0;return E(!0),b?f.createElement(a.Modal,{open:!0,isCentered:!0,withCloseButton:u?Re(l):void 0,onRequestClose:p},f.createElement(a.Modal.Header,{hasBottomSpacing:"title-standard"},f.createElement(a.Modal.Title,null,Ue(l,d))),f.createElement(a.Modal.Body,null,He(l,null!==(t=null==h?void 0:h.length)&&void 0!==t?t:0,a.getName(c),b.folder_name)),f.createElement(a.Modal.Footer,null,f.createElement(a.Button,{variant:"primary",onClick:p},Ze(l)))):f.createElement(a.Modal,{open:!0,isCentered:!0,withCloseButton:u?Re(l):void 0,onRequestClose:p},f.createElement(a.Modal.Header,{hasBottomSpacing:"title-standard"},f.createElement(a.Modal.Title,null,$e(l,d))),f.createElement(a.Modal.Body,null,je(l,d,a.getName(c))),f.createElement(a.Modal.Footer,null))};ua.displayName="NoExplicitAccessOnAccessChangeModal";const _a=({member:e})=>{const t=Rt(),s=n.useIntl(),o=lt(),{objectMetadata:l,accountMetadata:c}=Tt(),m=i.useAtom(t.$changeFolderMemberAccessFailureData),d=i.useAtom(t.$changeMemberAccessLevelData),u=(()=>{const e=r.useOpenUrl();return f.useCallback((t=>e(t)),[e])})(),_=da(e),g=dt(e,s),p=r.usePlatform()!==r.Platforms.DESKTOP,E=f.useRef(!1),h=m||d,b=_t(e),M=(null==d?void 0:d.member)||(null==m?void 0:m.member),S=r.getAreMemberSelectorsEqual(M,b);if(f.useEffect((()=>{const e=h&&S;E.current||e&&(E.current=!0,o.select(Je).emit(null))}),[h,S,o]),!h)return null;if(!S)return null;const A=m?ca(m.error):(null==d?void 0:d.data.access_details)||[];if(!(0!==A.length))return f.createElement(a.Modal,{open:!0,isCentered:!0,withCloseButton:p?Re(s):void 0,onRequestClose:_},f.createElement(a.Modal.Header,{hasBottomSpacing:"title-standard"},f.createElement(a.Modal.Title,null,$e(s,g))),f.createElement(a.Modal.Body,null,je(s,g,a.getName(l))),f.createElement(a.Modal.Footer,null,f.createElement(a.Button,{variant:"opacity",onClick:_},We(s))));const v=He(s,A.length,a.getName(l),A[0].folder_name);return f.createElement(a.Modal,{open:!0,isCentered:!0,withCloseButton:p?Re(s):void 0,onRequestClose:_},f.createElement(a.Modal.Header,{hasBottomSpacing:"title-standard"},f.createElement(a.Modal.Title,null,Ue(s,g))),f.createElement(a.Modal.Body,null,v,f.createElement(a.Box,{style:{height:"100%",maxHeight:"150px",border:"1px solid #DFDCD8",borderRadius:"5px",overflow:"auto",marginTop:"var(--spacing__unit--3)"}},A.slice(0,15).map(((e,t)=>f.createElement(ma,{key:t,intl:s,folderName:e.folder_name,folderPath:e.path,onManageAccessClicked:u,role:c.role,isPaired:c.is_paired}))))),f.createElement(a.Modal.Footer,null,f.createElement(a.Button,{variant:"opacity",onClick:_},We(s))))};_a.displayName="ParentFolderAccessModal";const ga=e=>{const t=Rt(),a=Kt(),n=Qt("remove_member"),r=i.useAtom(t.$objectIdentifier);return f.useCallback((()=>{t.$removeFileMemberFailureData.set(null),t.$removeFileMemberWarningData.set(null),t.$removeFolderMemberFailureData.set(null),t.$removeMemberAccessLevelData.set(null),a(!1),n(e,r)}),[e,r,a,n,t])},pa=({member:e})=>{var t,s,o,l;const c=Rt(),{objectMetadata:m}=Tt(),d=n.useIntl(),u=lt(),_=i.useAtom(c.$removeFileMemberFailureData),g=i.useAtom(c.$removeFileMemberWarningData),p=ga(e),E=dt(e,d),h=Kt(),b=r.usePlatform()!==r.Platforms.DESKTOP,M=f.useRef(!1),S=_||g,A="no_explicit_access"===(null===(t=null==_?void 0:_.error)||void 0===t?void 0:t[".tag"])&&("success"!==(null===(s=null==g?void 0:g.error)||void 0===s?void 0:s[".tag"])||null!=(null===(o=null==g?void 0:g.error)||void 0===o?void 0:o.access_details));let v=null;"success"===(null==g?void 0:g.error[".tag"])?v=g.error.access_details||[]:_&&"no_explicit_access"===_.error[".tag"]&&(v=_.error.access_details||[]);const I=null!=v;if(f.useEffect((()=>{const e=S&&A&&I;M.current||e&&(M.current=!0,u.select(Qe).emit(null))}),[u,M,S,A,I]),!S)return null;if(!A)return null;if(!I)return null;const y=v?v[0]:null;return h(!0),y?f.createElement(a.Modal,{open:!0,isCentered:!0,withCloseButton:b?Re(d):void 0,onRequestClose:p},f.createElement(a.Modal.Header,{hasBottomSpacing:"title-standard"},f.createElement(a.Modal.Title,null,Ge(d,E))),f.createElement(a.Modal.Body,null,ze(d,null!==(l=null==v?void 0:v.length)&&void 0!==l?l:0,a.getName(m),y.folder_name)),f.createElement(a.Modal.Footer,null,f.createElement(a.Button,{variant:"primary",onClick:p},Ze(d)))):f.createElement(a.Modal,{open:!0,isCentered:!0,withCloseButton:b?Re(d):void 0,onRequestClose:p},f.createElement(a.Modal.Header,{hasBottomSpacing:"title-standard"},f.createElement(a.Modal.Title,null,Ge(d,E))),f.createElement(a.Modal.Body,null,Ve(d,E,a.getName(m))),f.createElement(a.Modal.Footer,null,f.createElement(a.Button,{variant:"primary",onClick:p},Ze(d))))};pa.displayName="NoExplicitAccessOnRemoveModal";const fa=({member:e})=>{const t=Rt(),{objectMetadata:s,accountMetadata:o}=Tt(),l=n.useIntl(),c=lt(),m=i.useAtom(t.$removeMemberAccessLevelData),d=i.useAtom(t.$removeFolderMemberFailureData),u=(()=>{const e=r.useOpenUrl();return f.useCallback((t=>e(t)),[e])})(),_=ga(e),g=dt(e,l),p=r.usePlatform()!==r.Platforms.DESKTOP,E=f.useRef(!1),h=d||m;if(f.useEffect((()=>{if(!E.current){h&&(E.current=!0,c.select(Qe).emit(null))}}),[c,h]),!h)return null;const b=d?ca(d.error):(null==m?void 0:m.data.access_details)||[];if(!(0!==b.length))return f.createElement(a.Modal,{open:!0,isCentered:!0,withCloseButton:p?Re(l):void 0,onRequestClose:_},f.createElement(a.Modal.Header,{hasBottomSpacing:"title-standard"},f.createElement(a.Modal.Title,null,Ge(l,g))),f.createElement(a.Modal.Body,null,Ve(l,g,a.getName(s))),f.createElement(a.Modal.Footer,null,f.createElement(a.Button,{variant:"opacity",onClick:_},We(l))));const M=ze(l,b.length,a.getName(s),b[0].folder_name);return f.createElement(a.Modal,{open:!0,isCentered:!0,withCloseButton:p?Re(l):void 0,onRequestClose:_},f.createElement(a.Modal.Header,{hasBottomSpacing:"title-standard"},f.createElement(a.Modal.Title,null,Ge(l,g))),f.createElement(a.Modal.Body,null,M,f.createElement("div",{style:{height:"100%",maxHeight:"150px",border:"1px solid #DFDCD8",borderRadius:"5px",overflow:"auto",marginTop:"var(--spacing__unit--3)"}},b.slice(0,15).map(((e,t)=>f.createElement(ma,{key:t,intl:l,folderName:e.folder_name,folderPath:e.path,onManageAccessClicked:u,role:o.role,isPaired:o.is_paired}))))),f.createElement(a.Modal.Footer,null,f.createElement(a.Button,{variant:"opacity",onClick:_},We(l))))};fa.displayName="ParentFolderAccessModal";var Ea;!function(e){e[e.RemoveAccess=0]="RemoveAccess",e[e.DowngradeAccess=1]="DowngradeAccess"}(Ea||(Ea={}));var ha;!function(e){function t(e){return e.startsWith("dbafvid:")}e.isAnonymousUserId=t,e.isAnonymousSeenState=e=>t(e.seen_state_user.user_id)}(ha||(ha={}));const ba=({isOpen:e,member:t,selectedAccessLevel:s,onClose:o})=>{const i=lt(),l=n.useIntl(),c=r.usePlatform()!==r.Platforms.DESKTOP,{user:m}=a.useActiveUser(),d=Kt(),u=na(),_=ra(),g=sa(),{objectMetadata:p}=Tt();f.useEffect((()=>{d(e)}),[e,d]);const E=f.useRef(!1);if(f.useEffect((()=>{E.current||e&&(E.current=!0,i.select(Ke).emit(null))}),[e,i]),!e)return null;const h=ut(t,m),b=a.getName(p),M=a.getParentFolderName(p),S=a.getOwnerTeamName(p),A=""===M,v=h,I="remove"!==s,y=(e=>{let t="";return"user"in e&&void 0!==e.user&&(t=e.user.display_name),"group"in e&&void 0!==e.group&&(t=e.group.group_name),"invitee"in e&&void 0!==e.invitee&&"email"==e.invitee[".tag"]&&(t=e.invitee.email),t})(t),C=Ma(l,I,A),R=Sa(l,S,b,M,v,I,A),L=Aa(l,S,b,M,y,v,I,A);return f.createElement(f.Fragment,null,f.createElement(a.Modal,{open:e,isCentered:!0,withCloseButton:c?Re(l):void 0,onRequestClose:()=>{o()}},f.createElement(a.Modal.Header,{hasBottomSpacing:"title-standard"},f.createElement(a.Modal.Title,null,R)),f.createElement(a.Modal.Body,null,L),f.createElement(a.Modal.Footer,null,f.createElement(a.Button,{variant:"opacity",onClick:()=>{o()}},(e=>e.formatMessage({id:"TnNYmK",defaultMessage:"Cancel"}))(l)),f.createElement(a.Button,{variant:"primary",onClick:()=>{o();const e="group"in t&&void 0!==t.group;if(I){u({".tag":s},!0,t)}else v?_(t,!0,!1):g(t,!0,e,!1)}},C))))};ba.displayName="ChangeInheritanceConfirmationModal";const Ma=(e,t,a)=>t?(e=>e.formatMessage({id:"Mq03yj",defaultMessage:"Change access"}))(e):a?(e=>e.formatMessage({id:"PjD4Vl",defaultMessage:"Remove everyone"}))(e):(e=>e.formatMessage({id:"poGJG/",defaultMessage:"Remove"}))(e),Sa=(e,t,n,s,o,i,l)=>o?((e,t)=>e.formatMessage({id:"gODx5K",defaultMessage:"Remove yourself from <b>{parentFolderName}</b>?"},{parentFolderName:r.Emstring.em_snippet(t,a.SNIPPET_SIZES.FOLDER_NAME),b:e=>f.default.createElement("b",{style:{fontWeight:500}},e)}))(e,s):i?((e,t)=>e.formatMessage({id:"gBVsYr",defaultMessage:"Change how members can access “{currentFolder}”?"},{currentFolder:r.Emstring.em_snippet(t,a.SNIPPET_SIZES.DISPLAY_NAME)}))(e,n):l?t?((e,t)=>e.formatMessage({id:"n/U4N5",defaultMessage:"Remove everyone at “{teamName}”?"},{teamName:r.Emstring.em_snippet(t,a.SNIPPET_SIZES.DISPLAY_NAME)}))(e,t):(e=>e.formatMessage({id:"u5fnTi",defaultMessage:"Remove everyone on your team?"}))(e):((e,t)=>e.formatMessage({id:"Ca5nCo",defaultMessage:"Remove a member of “{parentFolderName}”?"},{parentFolderName:r.Emstring.em_snippet(t,a.SNIPPET_SIZES.DISPLAY_NAME)}))(e,s),Aa=(e,t,n,s,o,i,l,c)=>i?((e,t)=>e.formatMessage({id:"cowZmX",defaultMessage:"You won’t be able to see future changes to this shared folder, and new members of <b>{parentFolderName}</b> won’t have access to this folder automatically."},{parentFolderName:r.Emstring.em_snippet(t,a.SNIPPET_SIZES.DISPLAY_NAME),b:e=>f.default.createElement("b",{style:{fontWeight:500}},e)}))(e,s):l?c?((e,t,n)=>e.formatMessage({id:"a6N9uo",defaultMessage:"{memberName} will only be able to view this folder, and new {teamName} members won’t be able to access it automatically.{br}{br}To add more people to this folder in the future, you’ll need to invite them directly."},{memberName:r.Emstring.em_snippet(t,a.SNIPPET_SIZES.DISPLAY_NAME),teamName:r.Emstring.em_snippet(n||"team",a.SNIPPET_SIZES.DISPLAY_NAME),br:f.default.createElement("br",null)}))(e,o,t):((e,t,n)=>e.formatMessage({id:"39gzeK",defaultMessage:"{memberName} will only be able to view this folder, and new members of <b>{parentFolderName}</b> won’t be able to access it automatically.{br}{br}To add more people to this folder in the future, you’ll need to invite them directly."},{memberName:r.Emstring.em_snippet(t,a.SNIPPET_SIZES.DISPLAY_NAME),parentFolderName:r.Emstring.em_snippet(n,a.SNIPPET_SIZES.DISPLAY_NAME),b:e=>f.default.createElement("b",{style:{fontWeight:500}},e),br:f.default.createElement("br",null)}))(e,o,s):c?((e,t,n)=>e.formatMessage({id:"4qLIy8",defaultMessage:"{teamName} members won’t be able to see future changes to <b>{currentFolderName}</b> automatically.{br}{br}To give people access to this folder in the future, you’ll need to invite them directly."},{teamName:r.Emstring.em_snippet(t||"Team",a.SNIPPET_SIZES.DISPLAY_NAME),currentFolderName:r.Emstring.em_snippet(n,a.SNIPPET_SIZES.DISPLAY_NAME),b:e=>f.default.createElement("b",{style:{fontWeight:500}},e),br:f.default.createElement("br",null)}))(e,t,n):((e,t,n)=>e.formatMessage({id:"5HeI0Z",defaultMessage:"{memberName} and new members of the <b>{parentFolderName}</b> folder won’t be able to see future changes to this shared folder.{br}{br}To add more people to this folder in the future, you’ll need to invite them directly."},{memberName:r.Emstring.em_snippet(t,a.SNIPPET_SIZES.DISPLAY_NAME),parentFolderName:r.Emstring.em_snippet(n,a.SNIPPET_SIZES.DISPLAY_NAME),b:e=>f.default.createElement("b",{style:{fontWeight:500}},e),br:f.default.createElement("br",null)}))(e,o,s),va=(e,t,n,r,s,o,i,l)=>{const c=a.getIsFolder(t),m=a.getParentSharedFolderId(t),d=a.getParentFolderName(t),u=a.getIsSharedFolder(t)&&!a.getIsConfidentialFolder(t)&&m,_=mt(e,{".tag":"leave_a_copy"})&&!i,g=l.formatMessage({id:"YRtFe9",defaultMessage:"Cancel"});let p=null,E=null,h=null,b=null,M=!1,S=null,A="";const v=()=>{A="https://help.dropbox.com/files-folders/share/remove-link",S=l.formatMessage({id:"SwVT41",defaultMessage:"More about links"}),M=!0};return"remove"===r&&(o?(h=(e=>e.formatMessage({id:"4xmHQa",defaultMessage:"Remove my access"}))(l),c?(p=(e=>e.formatMessage({id:"bsRTH6",defaultMessage:"Remove your access to this folder?"}))(l),E=u?(e=>e.formatMessage({id:"1aWCsg",defaultMessage:"You may still have access to this folder through a company group or parent folder."}))(l):(e=>e.formatMessage({id:"fchbsZ",defaultMessage:"If you continue, you won’t be able to access this folder anymore."}))(l),_&&(b=(e=>e.formatMessage({id:"lLVlO2",defaultMessage:"Keep a copy of this folder"}))(l))):(p=(e=>e.formatMessage({id:"FCMIIX",defaultMessage:"Remove your access to this file?"}))(l),E=(e=>e.formatMessage({id:"6NPSkt",defaultMessage:"If you continue, you won’t be able to access this file anymore."}))(l))):(h=(e=>e.formatMessage({id:"VVzPdA",defaultMessage:"Remove"}))(l),p=((e,t)=>e.formatMessage({id:"WJ0lPe",defaultMessage:"Remove {name}?"},{name:t}))(l,n),c?(u?d?(v(),E=((e,t,a)=>e.formatMessage({id:"pnMbuO",defaultMessage:"If you remove <strong>{name}</strong>, they won’t be able to see future changes to this shared folder. Keep in mind that anyone who can access <strong>{parentname}</strong> will still be able to access this folder."},{strong:e=>f.default.createElement("strong",null,e),name:t,parentname:a}))(l,n,d)):(v(),E=((e,t)=>e.formatMessage({id:"eBf70w",defaultMessage:"If you remove <strong>{name}</strong>, they won’t be able to see future changes to this shared folder. Keep in mind that anyone who can access the parent folder will still be able to access this folder."},{strong:e=>f.default.createElement("strong",null,e),name:t}))(l,n)):E=((e,t)=>e.formatMessage({id:"RL/0uv",defaultMessage:"If you remove <strong>{name}</strong>, they won’t be able to see future changes to this shared folder."},{strong:e=>f.default.createElement("strong",null,e),name:t}))(l,n),_&&(b=((e,t)=>e.formatMessage({id:"82sluj",defaultMessage:"Let {name} keep a copy of this shared folder"},{name:t}))(l,n))):s?(v(),E=(e=>e.formatMessage({id:"oax1/b",defaultMessage:"Keep in mind, if group members have a shared link to this file, they might still be able to view or edit it."}))(l)):(v(),E=(e=>e.formatMessage({id:"WhoBZ9",defaultMessage:"Keep in mind, if they have a shared link to this file, they might still be able to view or edit it."}))(l)))),"owner"===r&&(p=((e,t)=>e.formatMessage({id:"hWdhIJ",defaultMessage:"Make {name} the owner of this folder?"},{name:t}))(l,n),E=((e,t)=>e.formatMessage({id:"6cevm4",defaultMessage:"{name} will become the owner of all items in this folder. Only they will be able to unshare or change folder settings."},{name:t}))(l,n),h=(e=>e.formatMessage({id:"3Do/LR",defaultMessage:"Make owner"}))(l)),{title:p,body:E,confirmText:h,cancelText:g,optionLabel:b,shouldShowLink:M,linkText:S,linkHref:A}},Ia=({member:e,selectedAccessLevel:t,isConfirmationModalOpen:s,setIsConfirmationModalOpen:o})=>{const i=n.useIntl(),l=lt(),c=r.useOpenUrl(),{user:m}=a.useActiveUser(),[d,u]=f.useState(!1),_=ra(),g=sa(),p=oa(),{objectMetadata:E}=Tt(),h=dt(e,i),b=(e=>"group"in e&&void 0!==e.group)(e),M=ut(e,m),S=(e=>"user"in e&&void 0!==e.user&&e.user.disabled)(e),A=r.usePlatform()!==r.Platforms.DESKTOP,v=f.useRef(!1);f.useEffect((()=>{v.current||s&&(v.current=!0,l.select(Xe).emit(null))}),[s,l]);const{title:I,body:y,confirmText:C,cancelText:R,optionLabel:L,shouldShowLink:T,linkHref:w,linkText:N}=va(e,E,h,t,b,M,S,i);if(void 0===I)return null;const P=e=>mt(e,{".tag":"leave_a_copy"});return f.createElement(a.Modal,{open:s,isCentered:!0,withCloseButton:A?Re(i):void 0,onRequestClose:()=>o(!1)},f.createElement(a.Modal.Header,{hasBottomSpacing:"title-standard"},f.createElement(a.Modal.Title,null,I)),f.createElement(a.Modal.Body,{hasVerticalSpacing:!1},y,L?f.createElement("p",{style:{display:"flex",marginTop:"8px"}},f.createElement(a.Checkbox,{"aria-label":Be(i),checked:d,onClick:()=>{u(!d)},style:{marginRight:"var(--spacing__base_unit)"}}),L):null),f.createElement(a.Modal.Footer,null,T&&f.createElement(a.Link,{onClick:e=>{e.preventDefault(),c(r.formatUrl(w))},href:w},N),f.createElement("div",{style:{flex:1}}),f.createElement(a.Button,{variant:"opacity",onClick:()=>o(!1)},R),f.createElement(a.Button,{variant:"primary",onClick:()=>{const a=_t(e),n="dropbox_id"===a[".tag"]?a.dropbox_id:"";o(!1),"remove"===t&&(M?_(e,!1,P(e)&&d):g(e,!1,!1,P(e)&&d)),"owner"===t&&n&&p(n,e,h)}},C)))};Ia.displayName="ManageAccessModalConfirmationModal";const ya=({member:e})=>{var t;const s=Rt(),{objectMetadata:o,linksMetadata:l,seenStateInfo:c}=Tt(),m=n.useIntl(),{user:d}=a.useActiveUser(),{openLinkSettings:u}=i.useAtom(s.$props),_=i.useAtom(s.$tempMemberAccessLevelData),[g,p]=f.useState(),[E,h]=f.useState(!1),[b,M]=f.useState(!1),S=na(),A=sa(),v=Kt(),I=(e=>{if(!e)return{};const t={};return e.forEach((e=>{const{seen_state_user:{user_id:a,display_name:n,email:r,photo_circle_url:s,same_team:o}}=e,i={account_id:a,name:{given_name:"",surname:"",familiar_name:"",display_name:n,abbreviated_name:""},email:r||"",email_verified:!0,profile_photo_url:s,is_teammate:o,disabled:!1};t[a]=i})),t})(Z(c,l)),y=new Set(Object.keys(I));f.useEffect((()=>{v(E)}),[E,v]);const C=r.getAreMemberSelectorsEqual(null==_?void 0:_.member,_t(e)),R=Ca(e),L=C&&(null==_?void 0:_.accessLevel)?_.accessLevel:e.access_type,T="user"in e&&(null===(t=e.user)||void 0===t?void 0:t.disabled)||!1,w=L[".tag"],N=R===(null==d?void 0:d.account_id),P=e.is_inherited,F=a.getCanDoAction(o,{".tag":"update_confidentiality"})&&P,x=F||!a.getIsNonSharedFolder(o)&&a.getCanDoAction(o,{".tag":"relinquish_membership"});let D=Ra(e,R,o,w,N&&x,y,m,T);const k=(t,n)=>{const i={".tag":n},l=((e,t)=>{const a=Object.keys(r.AccessLevelWeight);return e!==t&&-1!==a.indexOf(e)&&-1!==a.indexOf(t)&&r.AccessLevelWeight[t]<r.AccessLevelWeight[e]})(w,n),c=n===a.MEMBER_ACTION.REMOVE,m=!c&&l;if(c||m){(e=>{s.$showSecurityBanner.set(!0),s.$securityBannerType.set(e)})(c?gt.RemoveAccess:gt.DowngradeAccess)}const d=a.getIsSharedFolder(o)?e.inherited_access_type:e.access_type,_=c||m&&d&&l,g=c&&P;var f;w!==n&&(p(n),F&&_?M(!0):g&&a.getIsFolder(o)&&!a.getIsInsideTeamFolderTree(o)?A(e,!1,!1,!1):"remove"===n||"owner"===n?h(!0):"manage_link_access"===n?(f="editor"===w?"edit_link_settings":"view_link_settings",t.preventDefault(),u({initialTab:f})):S(i,!1,e))},O=a.getIsFile(o)&&e.is_inherited;return P&&"viewer"===w&&(D=D.filter((e=>"editor"!==e.apiId))),0===D.length?null:1===D.length&&D[0].apiId===w||O?f.createElement(a.Button,{size:"small",variant:"transparent",hasNoUnderline:!0,style:{cursor:"default"}},f.createElement(a.Text,{color:"faint",size:"small"},Ie(m,L))):f.createElement(f.Fragment,null,f.createElement(a.Menu.Wrapper,null,(({getContentProps:t,getTriggerProps:n})=>f.createElement(f.Fragment,null,f.createElement(a.Button,{...n(),size:"small",variant:"transparent",withDropdownIcon:!0,hasNoUnderline:!0,"aria-label":m.formatMessage({id:"O+fOwG",defaultMessage:"Change access for {memberName}"},{memberName:dt(e)}),"data-uxa-log":"manage_access_dropdown_button","data-testid":"manage-access-dropdown-button"},f.createElement(a.Text,{size:"small"},Ie(m,L))),f.createElement(a.Menu.Content,{...t(),placement:"bottom-end",style:{width:300}},f.createElement(a.Menu.Segment,null,D.map((e=>f.createElement(a.Menu.SelectItem,{key:e.label,value:e.apiId,selected:w===e.apiId,disabled:e.disabled,onClick:t=>k(t,e.apiId),"data-testid":"manage-access-dropdown-button-select-item"},f.createElement(a.Menu.Row,{withTitle:e.label,withSubtitle:e.tooltip,style:e.variant&&"red"===e.variant?{color:"var(--color__alert__text)"}:void 0}))))))))),f.createElement(Ia,{member:e,selectedAccessLevel:g,isConfirmationModalOpen:E,setIsConfirmationModalOpen:h}),f.createElement(ba,{isOpen:b,member:e,selectedAccessLevel:g,onClose:()=>M(!1)}))};ya.displayName="ManageAccessMemberAccessDropdown";const Ca=e=>"user"in e&&null!=e.user?e.user.account_id:"group"in e&&null!=e.group?e.group.group_id:"invitee"in e&&null!=e.invitee&&"email"===e.invitee[".tag"]?e.invitee.email:"",Ra=(e,t,n,r,s,o,i,l)=>{const c=o.has(t),m=a.getIsFolder(n),d=function(e,t){return[["make_editor",{value:"editor",title:E(t),folder_description:M(t),file_description:S(t),collection_description:A(t)}],["make_viewer",{value:"viewer",title:h(t),folder_description:v(t),file_description:v(t),collection_description:I(t)}],["make_viewer_no_comment",{value:"viewer_no_comment",title:b(t),folder_description:y(t),file_description:y(t),collection_description:I(t)}],["make_owner",{value:"owner",title:t.formatMessage({id:"UBvfnM",defaultMessage:"Make owner"}),file_description:"",folder_description:"",collection_description:""}],["remove",{value:"remove",title:e?t.formatMessage({id:"xv0D2w",defaultMessage:"Remove my access"}):t.formatMessage({id:"HRdOei",defaultMessage:"Remove"}),file_description:"",folder_description:"",collection_description:""}],["manage_link_access",{value:"manage_link_access",title:t.formatMessage({id:"EQzfeF",defaultMessage:"Manage access"}),file_description:"",folder_description:"",collection_description:""}]]}(s,i),u={};if(e.permissions)for(const t of e.permissions)u[t.action[".tag"]]=t.allow;let _=[];for(const[e,t]of d){const a=La(i,u,c,r,e,t,m,s,l);a&&_.push(a)}const g=_.find((e=>"manage_link_access"===e.apiId));return g&&(_=[g]),_},La=(e,t,a,n,r,s,o,i,l)=>{if("manage_link_access"===s.value&&a)return{apiId:s.value,label:s.title,tooltip:e.formatMessage({id:"qze8JT",defaultMessage:"Change or remove their access in link settings"}),disabled:!1};if(((e,t,a,n,r,s)=>t===a||s&&e in s&&s[e]&&(!r||"remove"===t)||"remove"===t&&n)(r,s.value,n,i,l,t)){const e=o?s.folder_description:s.file_description,t="remove"===s.value?"red":"default";return{apiId:s.value,label:s.title,tooltip:e||"",variant:t}}},Ta=({member:e,accountDataMap:t})=>{const s=Rt(),{seenStateInfo:o}=Tt(),l=n.useIntl(),{user:c}=a.useActiveUser(),{isNonUserRelativeContext:m}=a.useSharingApiContext(),d=(null==c?void 0:c.is_team_admin)||!1,u=i.useAtom(s.$memberActionsInProgress),_="user"in e&&null!=e.user?t[e.user.account_id]:void 0,p=(e=>{const t={};if(!e)return t;for(const a of e.seen_state_info.seen_states)if(!W.isAnonymousSeenState(a)){const e=a.seen_state_user.sharing_access_type;if(e)switch(e[".tag"]){case"view_member_access":case"edit_member_access":const n=e.group_ids;for(const e of n)e in t||(t[e]=[]),t[e].push(a)}}return t})(o),E=Na(e,_),h=Pa(e,l),b=dt(e,l),M=Da(l,e,_),S=xa(l,e,p),A=Fa(e,c),v=_t(e),I="group"in e&&null!=e.group&&((null==e?void 0:e.group.is_member)||m||d)?`/team#groups/${e.group.group_id}`:void 0,y=(e=>e.formatMessage({id:"Xlgz9n",defaultMessage:"External member"}))(l),C=null==_?void 0:_.disabled,R=S.length>0;let L=!1;return u[r.getUniqueId(v)]&&(L=!0),f.createElement(f.Fragment,null,f.createElement(a.Box,{style:{display:"flex",alignItems:"center",height:"52px",padding:"0 8px 0 0"},"data-testid":"manage-access-member-list-item",role:"listitem"},f.createElement(a.Box,{style:{width:"36px",display:"flex",flexShrink:0,padding:"0px"}},f.createElement(a.Avatar,{hasNoOutline:!0,size:"standard",src:E},h)),f.createElement(a.Box,{style:{display:"flex",flexDirection:"column",minWidth:0},marginX:"Micro Small"},f.createElement(a.Box,{style:{display:"flex",alignItems:"center",minWidth:0}},f.createElement(a.Text,{variant:"label",size:"small",style:{display:"flex",minWidth:0}},f.createElement(a.Truncate,{lines:1,tooltipControlProps:{placement:"bottom"},observeParent:!0},b)),C&&f.createElement(f.Fragment,null,f.createElement(a.Box,{display:"flex",flexShrink:0,style:{padding:"0 2px"}},"·"),f.createElement(a.Box,{display:"flex",flexShrink:0},f.createElement(a.Text,{variant:"label",color:"error",size:"medium",tagName:"div"},(e=>e.formatMessage({id:"6jx51W",defaultMessage:"Disabled"}))(l)))),R&&f.createElement(wa,{lastSeenTimestamp:S,member:e},f.createElement(a.Text,{color:"faint",size:"small",variant:"label",style:{display:"flex",alignItems:"center"},tabIndex:0},f.createElement(a.UIIcon,{src:a.ShowLine,size:"small",style:{marginLeft:"4px"}})))),f.createElement(a.Box,{color:"Text Subtle",fontSize:"Text Small",style:{display:"flex",alignItems:"center",flexGrow:1}},M&&(I?f.createElement(a.Link,{href:I,target:"_blank",rel:"noopener noreferrer",variant:"monochromatic","data-uxa-log":"member_list_item_group_link","data-uxa-interactions":"click",hasNoUnderline:!0},M):f.createElement(a.Truncate,{lines:1,maxWidth:275,tooltipControlProps:{placement:"bottom"},observeParent:!0},M)),A&&f.createElement(f.Fragment,null,f.createElement(a.Tooltip,{title:y,placement:"bottom"},f.createElement(a.Box,{display:"flex",alignItems:"center",marginLeft:"Micro XSmall",color:"Warning Base",tabIndex:0},f.createElement(a.UIIcon,{src:g.ExternalMemberLine,height:18,width:18,"aria-label":y})))))),f.createElement(a.Box,{style:{marginLeft:"auto"}},L?f.createElement(a.Spinner,{style:{marginRight:"8px"},"aria-valuetext":"Loading xsmall",size:"xsmall"}):f.createElement(ya,{member:e}))),f.createElement(pa,{member:e}),f.createElement(ua,{member:e}),f.createElement(fa,{member:e}),f.createElement(_a,{member:e}))};Ta.displayName="ManageAccessMemberListItem";const wa=({member:e,lastSeenTimestamp:t,children:n})=>{const r="group"in e&&void 0!==e.group;return f.createElement(a.Tooltip,{title:f.createElement(a.Box,{display:"flex",flexDirection:"column",alignItems:"center"},t.map(((e,t)=>r?f.createElement(a.Tooltip.Text,{key:t,size:"small",color:"standard",withMargin:!1},e):f.createElement(a.Tooltip.Text,{key:t,size:"small",color:0!==t||r?"subtle":"standard",withMargin:!1},e))))},n)},Na=(e,t)=>{if("user"in e&&null!=e.user)return null==t?void 0:t.profile_photo_url},Pa=(e,t)=>"user"in e&&null!=e.user?r.getUserInitials(e.user.display_name,t.locale):"group"in e&&void 0!==e.group?r.getGroupInitials(e.group.group_name):"invitee"in e&&void 0!==e.invitee&&"email"===e.invitee[".tag"]?r.getUserInitials(e.invitee.email,t.locale):"",Fa=(e,t)=>{if("owner"===e.access_type[".tag"])return!1;const a=null==t?void 0:t.is_team;return"user"in e&&null!=e.user&&null!=e.user.email?!!a&&!e.user.same_team:"group"in e&&void 0!==e.group?!e.group.same_team:!("invitee"in e)||void 0===e.invitee||!!e.user&&!e.user.same_team},xa=(e,t,a)=>{const n=[];if("user"in t&&null!=t.user&&"time_last_seen"in t&&null!=t.time_last_seen){const a=t.time_last_seen;n.push(((e,t)=>{let a="";t&&(a=((e,t)=>e.formatMessage({id:"yobnDT",defaultMessage:"Viewed {time_str}"},{time_str:t}))(e,It(e,t)));return a})(e,new Date(a))),n.push(((e,t)=>e.formatDate(t,{day:"numeric",month:"short",year:"numeric"})+" "+e.formatTime(t,{hour:"numeric",minute:"numeric"}))(e,new Date(a)))}if("group"in t&&void 0!==t.group&&a){const r=t.group.group_id;if(r in a){const t=((e,t)=>{const a=[];let n=0,r=0,s=0;const o=[];t.forEach((e=>{const t=e.seen_state_user.display_name,r=e.when_last_seen;r&&(a.push([t,new Date(1e3*r)]),n+=1)})),r=n<=10?n:9,s=n-r;for(let t=0;t<r;t++){const[n,r]=a[t];o.push(ft(e,n,r))}return s>0&&o.push(Et(e,s)),o})(e,a[r]);n.push(...t)}}return n},Da=(e,t,a)=>{if("user"in t&&null!=t.user)return a?a.email_verified?t.user.email:null:t.user.email.endsWith("#")?null:t.user.email;if("group"in t&&null!=t.group){const a=t.group.member_count;return a?((e,t)=>t<=0?"":e.formatMessage({id:"XMHn5C",defaultMessage:"{count, plural, one{# member} other{# members}}"},{count:t}))(e,a):null}return"invitee"in t&&null!=t.invitee&&t.invitee[".tag"],null};a.injectInternalStyle("/static/metaserver/static/js/sharing/features/access-management/internals/access-management-modal/modal.module.out-vflgv6YrL.css",(e=>"._modalContent_nutfs_1{height:100%}._header-section_nutfs_5{align-items:center;display:flex;margin-bottom:-6px;padding:18px 12px 0 18px}._header-section-text-container_nutfs_12{line-height:18px;width:100%}._header-section-primary-text_nutfs_17{font-family:var(--dig-type__family__title)}._header-section-button-container_nutfs_21{align-items:center;display:flex;margin-left:auto}._access-management-people-list_nutfs_30{animation:_fade-in_nutfs_1 var(--duration__surface) var(--easing__transition) forwards;max-height:234px;overflow-y:auto;scrollbar-width:thin}._access-management-people-list-dropdown-default_nutfs_37{display:none;max-height:0}._access-management-people-list-dropdown-expand_nutfs_42{animation:_expand-member-list_nutfs_1 var(--duration__surface) var(--easing__transition) forwards;display:block}._access-management-people-list-dropdown-collapse_nutfs_47{animation:_collapse-member-list_nutfs_1 var(--duration__surface) var(--easing__transition) forwards;display:block}._access-management-people-list-dropdown-inherited-expand_nutfs_52{animation:_expand-member-list-inherited_nutfs_1 var(--duration__surface) var(--easing__transition) forwards}._access-management-people-list-dropdown-inherited-collapse_nutfs_57{animation:_collapse-member-list-inherited_nutfs_1 var(--duration__surface) var(--easing__transition) forwards}@media (prefers-reduced-motion:reduce){._access-management-people-list-dropdown-collapse_nutfs_47,._access-management-people-list-dropdown-expand_nutfs_42,._access-management-people-list-dropdown-inherited-collapse_nutfs_57,._access-management-people-list-dropdown-inherited-expand_nutfs_52{animation-timing-function:var(--easing__linear)}}._inherited-members-list-title-button_nutfs_73>span{display:flex;min-width:0}@keyframes _expand-member-list_nutfs_1{0%{max-height:0}to{max-height:300px;overflow-y:auto}}@keyframes _collapse-member-list_nutfs_1{0%{max-height:300px}to{max-height:0;visibility:hidden}}@keyframes _expand-member-list-inherited_nutfs_1{0%{max-height:0}to{max-height:352px;overflow-y:auto}}@keyframes _collapse-member-list-inherited_nutfs_1{0%{max-height:352px}to{max-height:0}}"));const ka={modalContent:"_modalContent_nutfs_1",headerSection:"_header-section_nutfs_5",headerSectionTextContainer:"_header-section-text-container_nutfs_12",headerSectionPrimaryText:"_header-section-primary-text_nutfs_17",headerSectionButtonContainer:"_header-section-button-container_nutfs_21",accessManagementPeopleList:"_access-management-people-list_nutfs_30",fadeIn:"_fade-in_nutfs_1",accessManagementPeopleListDropdownDefault:"_access-management-people-list-dropdown-default_nutfs_37",accessManagementPeopleListDropdownExpand:"_access-management-people-list-dropdown-expand_nutfs_42",expandMemberList:"_expand-member-list_nutfs_1",accessManagementPeopleListDropdownCollapse:"_access-management-people-list-dropdown-collapse_nutfs_47",collapseMemberList:"_collapse-member-list_nutfs_1",accessManagementPeopleListDropdownInheritedExpand:"_access-management-people-list-dropdown-inherited-expand_nutfs_52",expandMemberListInherited:"_expand-member-list-inherited_nutfs_1",accessManagementPeopleListDropdownInheritedCollapse:"_access-management-people-list-dropdown-inherited-collapse_nutfs_57",collapseMemberListInherited:"_collapse-member-list-inherited_nutfs_1",inheritedMembersListTitleButton:"_inherited-members-list-title-button_nutfs_73"},Oa=({inheritedMembers:e,accountDataMap:t})=>{const{objectMetadata:r}=Tt(),s=n.useIntl(),[o,i]=f.useState(!1),[l,c]=f.useState(!1),[m,d]=f.useState(!1),[u,g]=f.useState(!1),p=a.getParentFolderName(r),E=a.getOwnerTeamName(r)||"",h=a.getCanDoAction(r,a.UPDATE_CONFIDENTIALITY_TAG),b=[...e.filter((e=>e.is_inherited&&"group"in e)),...e.filter((e=>e.is_inherited&&!("group"in e)))],M=m?b:b.slice(0,5);f.useEffect((()=>{o||d(!1)}),[o]);const S=f.useCallback((()=>{i(!o),o&&c(!0)}),[o]);if(0===e.length)return null;const A=((e,t,a)=>t?e.formatMessage({id:"STwL82",defaultMessage:"Everyone with access to “{folder_name}”"},{folder_name:t}):e.formatMessage({id:"6fi/fQ",defaultMessage:"Everyone at {team_name}"},{team_name:a}))(s,p,E)||"";return f.createElement(f.Fragment,null,f.createElement(a.Box,null,f.createElement(a.Box,{display:"flex",alignItems:"center",width:"100%",cursor:"pointer",paddingY:"Micro Small",paddingRight:"Micro Small"},f.createElement(a.Box,{display:"flex",flexShrink:0,alignItems:"center",justifyContent:"center",backgroundColor:"Background Subtle",borderRadius:"Circular",style:{height:"36px",width:"36px"},onClick:S,"data-testid":"inherited-member-list-toggle"},f.createElement(_.FolderSharedDefaultSmall,{height:32,width:32})),f.createElement(a.StylelessButton,{className:ka.inheritedMembersListTitleButton,style:{display:"flex",cursor:"pointer",minWidth:0},onClick:S,"data-uxa-log":"inherited_member_list_toggle","aria-controls":"sm24-access-management-inherited-member-list","aria-expanded":o},f.createElement(a.Box,{display:"flex",flexDirection:"column",style:{marginLeft:"8px",minWidth:0}},f.createElement(a.Text,{size:"small",variant:"label",style:{lineHeight:"16px"}},f.createElement(a.Truncate,{lines:1,tooltipControlProps:{placement:"top"},observeParent:!0},A)),f.createElement(a.Box,{display:"flex",alignItems:"center",flexShrink:0},f.createElement(a.Text,{size:"small",color:"subtle",style:{marginRight:"4px"}},((e,t)=>e.formatMessage({id:"C2045v",defaultMessage:"{count, plural, one{# member} other{# members}}"},{count:t}))(s,e.length)),e.length>0?f.createElement(a.UIIcon,{src:o?a.ChevronUpLine:a.ChevronDownLine,size:"small"}):null)))),f.createElement(a.Box,{id:"sm24-access-management-inherited-member-list",display:o||l?"flex":"none",overflowY:"hidden",className:a.cx({[ka.accessManagementPeopleListDropdownInheritedExpand]:!m&&!l,[ka.accessManagementPeopleListDropdownInheritedCollapse]:l}),onAnimationEnd:()=>{c(!1)}},f.createElement(a.Box,{style:{width:"36px",display:"flex",justifyContent:"center",flexShrink:0}},f.createElement(a.Box,{backgroundColor:"Border Subtle - On Base",height:"100%",style:{width:"1px"}})),f.createElement(a.Box,{style:{display:"flex",flexDirection:"column",width:"100%",minWidth:"0"}},M.map(((e,n)=>f.createElement(a.Box,{key:n},f.createElement(Ta,{member:e,accountDataMap:t})))),e.length>5&&!m&&f.createElement(a.Box,null,f.createElement(a.Button,{variant:"outline",size:"small",onClick:()=>{d(!m)},style:{margin:"8px 12px 16px 4px"}},((e,t)=>e.formatMessage({id:"GHErP8",defaultMessage:"Show all {num_members} members"},{num_members:t}))(s,e.length))),h&&f.createElement(a.Box,{display:"flex",paddingX:"Micro Medium",paddingY:"Micro Small",justifyContent:"center"},f.createElement(a.Button,{variant:"transparent",size:"small",tone:"destructive",onClick:()=>g(!0)},(e=>e.formatMessage({id:"pO5Yj6",defaultMessage:"Remove inherited members"}))(s)))))),f.createElement(la,{isOpen:u,onClose:()=>g(!1)}))};Oa.displayName="ManageAccessMemberInheritedList";const Ba=()=>{const{objectMetadata:e,objectMembers:t,linksMetadata:n,seenStateInfo:r}=Tt(),{viewer:s}=a.useViewer(),o=Z(r,n),i=bt(o),l=t?[...t.groups,...t.invitees,...t.users,...i]:[],c=(t?[...t.users,...i]:[]).map((e=>e.user.account_id)),m=G(c),d=!m.isLoading&&!m.isError?m.output:{},u=((e,t)=>{if(!t)return!1;const n=!!a.getParentSharedFolderId(e);return null!=t.team_id&&!!a.getOwnerTeam(e)&&a.getOwnerTeamId(e)===t.team_dbtid&&n})(e,s),_=u?l.filter((e=>e.is_inherited&&null!=e.access_type&&"traverse"!==e.access_type[".tag"])):[],g=u?l.filter((e=>!e.is_inherited&&null!=e.access_type)):l,p=pt(_),E=pt(g);return f.createElement(a.Box,{style:{height:"100%",overflowY:"auto",scrollbarWidth:"thin"}},f.createElement(Oa,{inheritedMembers:p,accountDataMap:d}),E.map(((e,t)=>f.createElement(Ta,{key:t,member:e,accountDataMap:d}))))};Ba.displayName="ManageAccessMemberList";const ja=()=>{const e=Rt(),{objectMembers:t,linksMetadata:r,seenStateInfo:s}=Tt(),{customNoOtherMembersScreen:o}=i.useAtom(e.$props),l=n.useIntl(),c=lt(),m=i.useAtom(e.$objectIdentifier),d=f.useRef(!1);f.useEffect((()=>{d.current||(d.current=!0,c.select(qe).emit(null))}),[c]);const u=Z(s,r),_=bt(u);return t.groups.length>0||t.invitees.length>0||t.users.length>0||_.length>0?(d.current||(d.current=!0,c.select(qe).emit(null)),f.createElement(a.Box,{display:"flex",flexDirection:"column"},f.createElement(wt,null),f.createElement(Ba,null))):o||f.createElement(a.Box,{display:"flex",alignItems:"center",flexDirection:"column"},f.createElement(he,{style:{width:"200px",height:"200px"}}),f.createElement(a.Text,{style:{width:"260px",textAlign:"center"}},((e,t)=>e.formatMessage({id:"PDTyQ+",defaultMessage:"When specific people are invited to this {isFile, select, true {file} other {folder}}, they’ll be listed here."},{isFile:t}))(l,"file"===m[".tag"])))};ja.displayName="ContentMemberListInner";const $a=()=>{const e=Rt(),t=lt(),{objectMetadataResult:n,objectMembersResult:r,listSharedLinksResult:s,accountMetadataResult:o,seenStateInfoResult:l,onMemberListDataLoading:c,onObjectIdentifierChanged:m}=i.useAtom(e.$props),[d,_]=f.useState(!1),g=i.useAtom(e.$objectIdentifier),p=n.isLoading,E=!p&&n.isError,h=!p&&!E,b=r.isLoading&&!r.isFirstPageLoaded,M=!r.isLoading&&!r.isFirstPageLoaded&&r.isError,S=r.isFirstPageLoaded&&!r.isFirstPageOnly,A=!s.isLoading&&s.isError,v=!s.isLoading&&!s.isError,I=s.isLoading,y=!o.isLoading&&o.isError,C=!o.isLoading&&!y,R=o.isLoading,L=!l.isLoading&&l.isError,T=!l.isLoading&&!L,w=l.isLoading,N=p||b||I||R||w,P=h&&S&&v&&C&&T,F=E||M||A||y||L;if("function"==typeof c&&c(N),f.useEffect((()=>{P&&(i.batch((()=>{e.$objectMetadata.set(n.output),e.$objectMembers.set(r.allMembers),e.$linksMetadata.set(s.output),e.$accountMetadata.set(o.output),e.$seenStateInfo.set(l.output)})),_(!0))}),[P,n,r,s,o,l]),f.useEffect((()=>{if(h){const t=n.output.metadata_response;if("file_folder"===g[".tag"]&&t&&"folder_metadata"===t[".tag"]&&t.shared_folder_id){const a={".tag":"shared_folder",sharedFolderId:t.shared_folder_id,fileId:g.fileId};e.$objectIdentifier.set(a),"function"==typeof m&&m(a)}}}),[h,g,n,e.$objectIdentifier]),N)return f.createElement(a.Box,{style:{display:"flex",alignItems:"center",justifyContent:"center"},"data-testid":"content-member-list-loading-indicator"},f.createElement(a.Spinner,null));if(d)return f.createElement(ja,null);if(g.fileId&&F){t.select(it).emit(null);let e={".tag":"other"};return E&&n.error?e=n.error:M&&r.error?e=r.error:A&&s.error?e=s.error:L&&l.error&&(e=l.error),u.reportStack("Error fetching data for Content Member List",{severity:u.SEVERITY.CRITICAL,tags:["content-member-list"],silent:!0,exc_extra:{file_id:g.fileId,error:e}}),f.createElement(Ua,{errorReason:null==e?void 0:e[".tag"]})}return null};$a.displayName="ContentMemberListWithStore";const Ua=({errorReason:e})=>{const t=n.useIntl(),r=Rt(),{customErrorScreenWrapper:s}=i.useAtom(r.$props),o=((e,t)=>{switch(t){case"email_unverified":return e.formatMessage({id:"YQ+xBi",defaultMessage:"Verify your email to share this content."});case"invalid_oid":return e.formatMessage({id:"hBQISs",defaultMessage:"This content doesn’t exist."});case"no_access":return e.formatMessage({id:"S0dPqX",defaultMessage:"You don’t have access to this content."});default:return e.formatMessage({id:"0FW7bf",defaultMessage:"We ran into a problem loading the list of people who have access."})}})(t,e);return s?f.createElement(s,{errorMessage:o}):f.createElement(a.Box,{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",paddingY:"Macro Small"},f.createElement(d.BowlEmptySpot,{style:{width:"180px",height:"180px"}}),f.createElement(a.Text,{style:{width:"260px",textAlign:"center",marginTop:"16px"}},Se(t)))};Ua.displayName="ErrorFallback";const Ha=e=>f.createElement(Lt,{...e},f.createElement(a.ErrorBoundary,{FallbackComponent:({error:e})=>f.createElement(Ua,null),onError:e=>{u.reportException({err:e,severity:u.SEVERITY.CRITICAL,tags:["content-member-list"],exc_extra:{message:"Error loading Content Member List"}})}},f.createElement($a,null)));Ha.displayName="ContentMemberList",e.ContentMemberFacepileButton=ge,e.ContentMemberList=Ha,e.InbandEntryButton=j,e.PAP_Hover_FlexibleSharingEntrypointAction=w,e.PAP_Log_FlexibleSharingEntrypointActionDwellTime=N,e.PAP_View_ManageAccess=fe,e.TokenizerButton=U,e.classes=ka,e.formatSubtitleNoPermissions=e=>e.formatMessage({id:"ji4c03",defaultMessage:"This folder contains subfolders that you don’t own."}),e.formatSubtitleWithPermissionsFile=e=>e.formatMessage({id:"7453qx",defaultMessage:"When specific people are invited to this file, they’ll be listed here."}),e.formatSubtitleWithPermissionsFolder=e=>e.formatMessage({id:"rgZZgG",defaultMessage:"When specific people are invited to this folder, they’ll be listed here."}),e.formatTitleNoPermissions=e=>e.formatMessage({id:"66T/EA",defaultMessage:"Can’t manage people with access"}),e.formatTitleWithPermissions=e=>e.formatMessage({id:"f7F1sF",defaultMessage:"Keep track of people and permissions"}),e.getAccountBatch=async function(e){if(0===e.length)return{status:pe.SUCCESS,output:[]};const t=await a.getSharingApiv2ResponseWithErrors(a.getAccountBatchPackage.fetchQuery(c.queryClient,{apiArg:{account_ids:e}},{staleTime:3e5}));return"SUCCESS"===t.status?{status:pe.SUCCESS,output:{...t.output}}:"ERROR"===t.status?t:{status:pe.FATAL,error:{".tag":"api_error"}}},e.invalidateListSharedLinks=async function(e){const t=a.getContentIdOrPathFromObjectIdentifier(e);return a.sharingListSharedLinksPackage.invalidateQueries(c.queryClient,{path:t,direct_only:!0})},e.prefetchListSharedLinks=async function(e){const t=a.getContentIdOrPathFromObjectIdentifier(e);return a.sharingListSharedLinksPackage.prefetchQuery(c.queryClient,{apiArg:{path:t,direct_only:!0}})},e.sharingCheckJobStatus=xt,e.useAccountDataBatch=G,e.useListSharedLinks=z}));
//# sourceMappingURL=c_content-member-list_internals_content-member-list.js-vflJhINsz.map

//# debugId=cb3fb815-88d6-3f0a-a010-31fbad43b8d9