!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="86db48fb-17c0-348b-a8ee-857961f3d762")}catch(e){}}();
define(["require","exports","react","./e_file_viewer_static_scl_page_file","./c_core_i18n","./c_flows_conversions_conversion_actions","./c_dig-icons_assets_ui-icon_line_print","./c_action_plugins_open_in_action_dropdown","./c_lodash-es_lodash","./c_cloud_docs_open_with_utils","./c_file_viewer_components_titlebar_menu_content","./e_data_modules_stormcrow","./c_api_v2_routes_growth_provider","./e_core_exception","./c_src_sink_index","./c_bem","./c_hive_schemas_sharing-request_access_user_events","./e_edison","./c_pap-events_navigation_select_create_folder_action","./c_init_data_edison","./c_memoize-one","./c_react-use_misc_util","./c_api_v2_unauthed_client","./c_spectrum_util_raf_throttle","./c_core_notify","react-dom","./c_chat_chat_constants","./c_security_csrf_hmac","./c_react_jsx-runtime","./c_watermarking_utils_getImageDefaultSizes","metaserver/static/js/langpack","./c_dig-icons_assets_ui-icon_line_video","./c_dig-icons_assets_ui-icon_line_no-fill","./c_dig-icons_assets_ui-icon_line_pdf","./c_icon_templates_stateless_index","./c_spectrum_svg_icon_bundle","./c_shared_components_templates_modal_template","./c_profile_services_profile_services_link","./c_abuse_login_and_register_constants_fetch","./c_react_query_helpers_queries_login_and_register_constants","./c_api_v2_routes_team_members_internal_provider","./c_gdd_migration_ui_utils","./c_file_imports_gdrive_file_picker","./c_shortcuts_conversion_utils","./c_icon_shortcuts_icon","./c_spectrum-content-icon-compatibility_src_file_icon","./c_dig-content-icons_icons_file-unknown-large","./c_dig-content-icons_icons_file-link-large","./c_dig-content-icons_icons_folder-team-read-only-small","./c_dig-content-icons_icons_folder-shared-default-small","./c_dig-content-icons_icons_folder-base-default-large","./c_dig-content-icons_icons_folder-base-default-small","./c_icon_folder_icon","./c_ui_title_bubble","./c_ui_overlay","./c_extensions_open_button_utils","./c_spectrum_modal_utility_modal","./c_spectrum_button","./c_spectrum_tertiary_link","./c_icon_templates_actionable_index","./c_spectrum_icon_form_index","./c_ui_image","./c_ui_sprite","./c_dig-icons_assets_ui-icon_line_sidebar-show-right","./c_dig-icons_assets_ui-icon_line_admin-console"],(function(e,i,t,n,o,r,c,s,a,l,_,u,d,S,f,v,p,A,I,w,E,h,P,C,m,g,D,T,b,N,L,O,R,y,F,K,M,k,U,x,V,G,H,B,W,z,Y,j,q,X,Z,Q,$,J,ee,ie,te,ne,oe,re,ce,se,ae,le,_e){"use strict";function ue(e){if(e&&e.__esModule)return e;var i=Object.create(null);return e&&Object.keys(e).forEach((function(t){if("default"!==t){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(i,t,n.get?n:{enumerable:!0,get:function(){return e[t]}})}})),i.default=e,Object.freeze(i)}var de=ue(t);const Se={...n.fileActionCondition,filterValidFile:e=>{const i=n.fileActionCondition.filterValidFile(e);return!i||n.isPnmSuppressMoveSelected(i)||n.isEncryptedFile(i)?void 0:i}},fe=n.withActionCondition(Se,((i,t,o,r)=>({label:n.COPY_ACTION_STRING,userAction:n.UserAction.Copy,icon:n.CopyLine,action:{type:"click",handler:()=>new Promise((function(i,t){e(["./c_action_plugins_copy_action_action"],i,t)})).then((({copyActionWrapper:e})=>e({file:i.file,user:i.user,previewType:t,browseContext:o,browseExceptions:r})))},disabled:{disabled:!1}})),void 0),ve=n.withActionCondition(n.deleteActionCondition,((i,t,o,r,c)=>({label:n.DELETE_ACTION_STRING,icon:n.DeleteLine,userAction:n.UserAction.Delete,disabled:i.file.read_only?{disabled:!0,tooltipMessage:n.ACTION_DISABLED_STRING}:{disabled:!1},action:{type:"click",handler:()=>new Promise((function(i,t){e(["./c_action_plugins_delete_action_action"],i,t)})).then((({deleteActionWrapper:e})=>e({logUserAction:t,setDeleteFileModalOpenCallback:o,file:i.file,user:i.user,previewSurface:r,onFileChanged:c})))}})),void 0),pe=n.withActionCondition(n.duplicateFilesActionCondition,((e,i)=>({userAction:void 0,label:n.FIND_DUPLICATES_ACTION_STRING,accessibleLabel:n.FIND_DUPLICATES_ACTION_STRING,action:{type:"click",handler:async()=>i()},disabled:{disabled:!1},icon:n.DuplicateLine})),void 0),Ae=[n.SDKPreviewSurface.BROWSE,n.SDKPreviewSurface.FILE_LOCKING,n.SDKPreviewSurface.HELLOSIGN,n.SDKPreviewSurface.HOME,n.SDKPreviewSurface.INBAND_SHARE,n.SDKPreviewSurface.PHOTOS,n.SDKPreviewSurface.RECENTS,n.SDKPreviewSurface.SEARCH,n.SDKPreviewSurface.SHARED_COLLECTION,n.SDKPreviewSurface.SHARED_CONTENT_LINK,n.SDKPreviewSurface.SHARED_LINK,n.SDKPreviewSurface.SHARED_LINK_EMBED,n.SDKPreviewSurface.SHARED_COLLECTION,n.SDKPreviewSurface.STANDALONE_PREVIEW,n.SDKPreviewSurface.STARRED,n.SDKPreviewSurface.TRANSFER,n.SDKPreviewSurface.UNKNOWN,n.SDKPreviewSurface.VERSION_HISTORY,n.SDKPreviewSurface.FSS_DESKTOP_PREVIEW],Ie={filterValidFile:n.allowAllFiles,filterValidUser:n.filterLoggedInUser,shouldShowForPreviewSurface:n.filterSurfaceIn(Ae),shouldShowForPreviewType:n.alwaysShow},we=n.withActionCondition(Ie,((e,i)=>({userAction:void 0,icon:n.FileHistoryLine,label:n.FILE_ACTIVITY_ACTION_STRING,accessibleLabel:n.FILE_ACTIVITY_ACCESSIBILITY_STRING,action:{type:"click",handler:async()=>i()},disabled:{disabled:!1}})),void 0);const Ee=e=>{const{conversionActions:i,file:t}=e,n=i.filter((e=>e.actionGroup===r.ConversionActionGroup.VIDEO_SCALE)),o=i.filter((e=>e.actionGroup!==r.ConversionActionGroup.VIDEO_SCALE)),c=o.length>0?he(o,t,e):null,s=n.length>0?he(n,t,e):null;return de.default.createElement(de.default.Fragment,null,c,s)},he=(e,i,t)=>de.default.createElement(n.Menu.Segment,null,e.map((e=>{const r=i.bytes/Math.pow(1024,2),c=n.getConversionFileSizeLimitMB([n.file_extension(n.getFilename(i))],e.actionText),s=r>c,a=o.intl.formatMessage({id:"0vePbC",defaultMessage:"File is larger than the {fileSizeLimitMB}MB limit"},{fileSizeLimitMB:c}),l=de.default.createElement(n.Menu.ActionItem,{key:e.actionText,disabled:s,value:{handler:()=>(({file:e,user:i,action:t,encryptionOptions:o,logUserAction:r,context:c,shareToken:s,actionSurface:a="",sharedLinkInfo:l,sharePermissions:_,previewSurface:u})=>{if(r(n.UserAction.SelectSaveAs,c,{conversion_type:t.actionText,actionSurface:a}),i)t.convert([e],i,{shareToken:s,source:"preview"});else{const e=new URL(window.location.href);e.searchParams.set("save_as","true"),e.searchParams.set("save_as_action",t.actionText),window.history.replaceState(e.href,"",e.href),n.showAuthModal({mode:n.Mode.REGISTER,sharedLinkUrl:e.href,kind:n.LoginOrRegisterKind.POSTSAVEAS,encryptionOptions:o,loggingExtra:{signup_source:"save_as"},signupTag:n.RegistrationSource.SHMODEL_SAVE_AS_REGISTER,webSignInTag:n.getWebSignInTag(!1,u,_),authDialogPreviousElement:n.AuthDialogPreviousElementTag.SAVE_AS,sharedLinkInfo:l})}})({...t,action:e})},withLeftAccessory:de.default.createElement(n.UIIcon,{src:e.actionIcon,width:"20px",height:"20px"})},e.actionText);return s?de.default.createElement(n.Tooltip,{key:e.actionText,title:a,placement:"left",id:"flows-disabled-menu-item-tooltip"},de.default.createElement("div",null,l)):l}))),Pe=[n.SDKPreviewSurface.BROWSE,n.SDKPreviewSurface.FILE_LOCKING,n.SDKPreviewSurface.HELLOSIGN,n.SDKPreviewSurface.HOME,n.SDKPreviewSurface.INBAND_SHARE,n.SDKPreviewSurface.PHOTOS,n.SDKPreviewSurface.RECENTS,n.SDKPreviewSurface.SEARCH,n.SDKPreviewSurface.SHARED_CONTENT_LINK,n.SDKPreviewSurface.SHARED_LINK,n.SDKPreviewSurface.STANDALONE_PREVIEW,n.SDKPreviewSurface.STARRED,n.SDKPreviewSurface.FSS_DESKTOP_PREVIEW],Ce={filterValidFile:e=>!e||n.isInsideSharedFolder(e)||n.isEncryptedFile(e)?void 0:e,filterValidUser:e=>({user:e}),shouldShowForPreviewSurface:n.filterSurfaceIn(Pe),shouldShowForPreviewType:n.alwaysShow},me=n.withActionCondition(Ce,((e,i,t,o,s,a)=>{const l=function({getActiveFile:e,user:i},t){const{file:o,sharedLinkInfo:c,sharePermission:s}=e();return n.canConvertFile(o,s)&&n.canDownloadFile(c,s)?r.getConversionActionsForFiles(i,[o],{},t):[]}({getActiveFile:t,user:e.user},o);if(l.length)return{label:n.FILE_CONVERSION_STRING,userAction:n.UserAction.OpenSaveAs,disabled:{disabled:!1},icon:c.ConvertFileLine,action:{type:"menu",menu:de.default.createElement(Ee,{context:n.UserActionContext.FileMenu,conversionActions:l,encryptionOptions:s,file:e.file,logUserAction:i,user:e.user,sharedLinkInfo:t().sharedLinkInfo,sharePermissions:t().sharePermission,previewSurface:a})}}}),void 0),ge=e=>({userAction:void 0,disabled:{disabled:!1},action:{type:"click",handler:async()=>e()},label:n.INFO_ACTION_STRING,accessibleLabel:n.INFO_ACCESSIBILITY_STRING,icon:n.InfoLine}),De=n.withActionCondition(n.moveActionCondition,((i,t,o,r,c,s)=>({label:n.MOVE_ACTION_STRING,icon:n.MoveLine,userAction:n.UserAction.Move,disabled:i.file.read_only?{disabled:!0,tooltipMessage:n.ACTION_DISABLED_STRING}:{disabled:!1},action:{type:"click",handler:()=>new Promise((function(i,t){e(["./c_action_plugins_move_action_action"],i,t)})).then((({moveActionWrapper:e})=>e({file:i.file,user:i.user,previewType:t,previewSurface:o,onFileChanged:r,browseContext:c,browseExceptions:s})))}})),void 0);const Te=()=>{const{optionalIOClients:{printClient:e}}=n.useFileViewerContext(),i=function(){var e,i,t;const o=n.useRootPreviewMetadata();if(!o)return"";const{content:r}=o;return"image"===(null==r?void 0:r[".tag"])?null!==(e=null==r?void 0:r.full_size_src)&&void 0!==e?e:"":"ssr_doc"===(null==r?void 0:r[".tag"])?null!==(i=null==r?void 0:r.autoprint_url)&&void 0!==i?i:"":"text"===(null==r?void 0:r[".tag"])&&null!==(t=null==r?void 0:r.extracted_text)&&void 0!==t?t:""}(),t=n.useRootPreviewType();return de.default.useMemo((()=>()=>{i&&(null==e||e.print(i,t))}),[t,e,i])},be=[n.PreviewType.SsrDoc,n.PreviewType.Image,n.PreviewType.Text,n.PreviewType.Excel],Ne={shouldShowForPreviewSurface:n.alwaysShow,shouldShowForPreviewType:n.filterPreviewTypeIn(be),filterValidUser:e=>({user:e}),filterValidFile:(e,i,t)=>t||n.isEncryptedFile(e)?void 0:e},Le=n.withActionCondition(Ne,((e,i)=>({label:n.PRINT_ACTION_STRING,userAction:n.UserAction.Print,disabled:{disabled:!1},action:{type:"click",handler:async()=>i()},icon:c.PrintLine})),void 0),Oe=n.withActionCondition(n.renameActionConditions,((e,i)=>({label:n.RENAME_ACTION_STRING,icon:n.CursorLine,userAction:n.UserAction.Rename,action:{type:"click",handler:async()=>{i(!0)}},disabled:e.file.read_only?{disabled:!0,tooltipMessage:n.ACTION_DISABLED_STRING}:{disabled:!1}})),void 0),Re=n.withActionCondition(n.starActionConditions,((e,i,t,o,r)=>({label:o,icon:t,userAction:i?n.UserAction.Unstar:n.UserAction.Star,action:{type:"click",handler:async()=>r()},disabled:{disabled:!1}})),void 0),ye=o.defineMessage({id:"pB6h1Y",defaultMessage:"Archive files over 512 MB cannot be extracted"}),Fe=n.withActionCondition(n.unzipActionConditions,((i,t)=>{const o=i.file.bytes/1048576;return{label:n.UNZIP_ACTION_MESSAGE,icon:n.UnzipAction.actionIcon,disabled:o>=n.UNZIP_MAX_FILESIZE_MB?{disabled:!0,tooltipMessage:ye}:{disabled:!1},userAction:n.UserAction.Unzip,action:{type:"click",handler:()=>new Promise((function(i,t){e(["./c_action_plugins_unzip_action_action"],i,t)})).then((({unzipAction:e})=>e({user:i.user,file:i.file,shareToken:t})))}}}),void 0),Ke=[n.SDKPreviewSurface.BROWSE,n.SDKPreviewSurface.BACKUP,n.SDKPreviewSurface.FILE_LOCKING,n.SDKPreviewSurface.HELLOSIGN,n.SDKPreviewSurface.HOME,n.SDKPreviewSurface.INBAND_SHARE,n.SDKPreviewSurface.PHOTOS,n.SDKPreviewSurface.RECENTS,n.SDKPreviewSurface.SEARCH,n.SDKPreviewSurface.SHARED_CONTENT_LINK,n.SDKPreviewSurface.SHARED_LINK,n.SDKPreviewSurface.STANDALONE_PREVIEW,n.SDKPreviewSurface.STARRED,n.SDKPreviewSurface.POLLUX_DESKTOP_PREVIEW,n.SDKPreviewSurface.POLLUX_DESKTOP_SEARCH_PREVIEW],Me={filterValidFile:e=>function(e){const i=n.fileActionCondition.filterValidFile(e);return!!i&&!l.isCloudBasedDoc(i)&&!n.isWebShortcutByExtension(i.fq_path)}(e)?e:void 0,filterValidUser:n.filterLoggedInUser,shouldShowForPreviewSurface:n.filterSurfaceIn(Ke),shouldShowForPreviewType:n.alwaysShow};const ke=n.withActionCondition(Me,(i=>({label:n.VERSION_HISTORY_ACTION_STRING,icon:n.ClockLine,userAction:n.UserAction.VersionHistory,disabled:{disabled:!1},action:{type:"click",handler:()=>new Promise((function(i,t){e(["./c_action_plugins_version_history_action_action"],i,t)})).then((({versionHistoryActionWrapper:e})=>e(i.file,i.user)))}})),void 0);i.default=({contentProps:e})=>{var i,t;const{previewSurface:o,pluginArgs:r,fileConfig:c,hasOpenInActions:a}=n.usePluginMigrationContext(),{logUserAction:l}=n.useFileViewerContext(),d=n.useCurrentPreviewMetadata();n.useLogExposureOnce("copy_to_dropbox_folder_picker");const S=n.useExperimentVariant("copy_to_dropbox_folder_picker").variant,f=null!==(i=d.previewType)&&void 0!==i?i:n.PreviewType.Loading,v=r.getActiveFile().file,p=r.getActiveFile().sharePermission,A=r.user,I=n.useRootFile(),{data:w}=n.useFileContentMetadataQuery(I),E=n.useIsNestedArchiveFile(),h=null===(t=null==w?void 0:w.apiData)||void 0===t?void 0:t.metadata,{onFileChanged:P,browseContext:C,browseExceptions:m,canRestoreRevision:g,getActiveFile:D,shareToken:T,encryptionOptions:b,reduceUpsells:N,onRestoreRevision:L,userPresentableVerdict:O}=r,R=de.useMemo((()=>({file:v,user:A,previewSurface:o,previewType:f,sharePermission:p,isNestedArchiveFile:E,canRestoreRevision:g})),[v,g,E,o,f,p,A]),y=(e=>{const i=n.useSetLeftSidebarCallback(n.UserActionContext.FileMenu);return de.default.useMemo((()=>we(e,(()=>i(n.FILE_ACTIVITY_PLUGIN_ID)))),[e,i])})(R),F=(()=>{const e=n.useSetLeftSidebarCallback(n.UserActionContext.FileMenu);return de.default.useMemo((()=>ge((()=>e(n.INFO_BLADE_PLUGIN_ID)))),[e])})(),K=((e,i)=>{const{onPrint:t}=n.usePreviewControls(),o=Te(),r=n.useStabilizedCallback((()=>{null==t||t(),o()}));return de.default.useMemo((()=>i.enable_print?Le(e,r):void 0),[e,i.enable_print,r])})(R,c),M=((e,i)=>{const t=n.getStoreForStarred(),{isStarred:o,message:r,iconSrc:c,handleClick:s}=n.useStarControlWithStore({getActiveFile:i,user:e.user,starredStore:t});return de.default.useMemo((()=>Re(e,o,c,r,s)),[e,s,c,o,r])})(R,D),k=n.useToggleRenameStateCallback(),U=n.useSetDeleteFileModalOpenCallback(),x=((e,i)=>{const t=n.useRightSidebarId()===n.DUPLICATE_FILES_BLADE_PLUGIN_ID,o=n.useCloseSidebarCallback(i),r=n.useSetRightSidebarCallback(i),c=n.useDuplicateFilesExperimentVariant(),s=n.shouldShowDuplicateFiles(c,e.previewSurface),a=de.default.useCallback((()=>{t?o(n.DUPLICATE_FILES_BLADE_PLUGIN_ID):r(n.DUPLICATE_FILES_BLADE_PLUGIN_ID)}),[o,t,r]);return de.default.useMemo((()=>s?pe(e,a):void 0),[s,e,a])})(R,n.UserActionContext.FileMenu),V=n.useEmitter$2(),G=de.useCallback((e=>{n.isSharedFile(v)&&V.select(n.ON_CLICK_SHARED_CONTENT_ACTION).emit({actionElement:"action_bar",action:e})}),[V,v]),H=u.useQueryClient(),B=de.useMemo((()=>[[De(R,f,o,P,C,m),fe(R,f,C,m),ve(R,l,U,o,P),Oe(R,k)],[M],[F,ke(R),y],[s.makeOpenInAction(R,!!a),me(R,l,D,h,b,o),Fe(R,T),...n.makeDownloadActions(R,D,l,h,o,N,T,p,b,null==I?void 0:I.name,n.UserActionContext.FileMenu,H,G,O,S),n.makeRestoreAction(R,L)],[x],[K]]),[R,f,o,P,C,m,l,U,k,M,F,y,a,D,h,b,T,N,p,null==I?void 0:I.name,G,O,S,H,L,x,K]),W=de.useCallback((e=>l(e,n.UserActionContext.FileMenu)),[l]);return de.createElement(_.TitlebarMenuContent,{options:B,elementId:"file-menu",contentProps:e,logAction:W})}}));
//# sourceMappingURL=c_title_bar_dropdowns_titlebar_file_dropdown.after-display.js-vfl0l8CsM.map

//# debugId=86db48fb-17c0-348b-a8ee-857961f3d762