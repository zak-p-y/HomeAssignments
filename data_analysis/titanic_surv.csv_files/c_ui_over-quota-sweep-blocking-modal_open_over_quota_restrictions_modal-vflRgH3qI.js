!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="6fba319a-b71f-361a-b5b3-712c555332fe")}catch(e){}}();
define(["exports","react","./e_file_viewer_static_scl_page_file","./e_data_modules_stormcrow","./c_core_i18n","./c_ui_over-quota-sweep-blocking-modal_use_get_plans","./c_growth-components_over-quota-file-viewer-modal","./c_trial-cards_trial-plan-card","./c_api_v2_routes_growth_provider"],(function(e,t,a,o,n,i,l,r,s){"use strict";function d(e){return e&&e.__esModule?e:{default:e}}var u=d(t);const c=n.intl.formatMessage({id:"RwfIPM",defaultMessage:"Upgrade"}),_=n.intl.formatMessage({id:"Ts3pxe",defaultMessage:"Manage files"}),f=n.intl.formatMessage({id:"s+3YBE",defaultMessage:"Includes"}),v=e=>n.intl.formatMessage({id:"oZoBRB",defaultMessage:"Get {planSize}"},{planSize:e}),m=n.intl.formatMessage({id:"gAT+r8",defaultMessage:"View plans"}),g=n.intl.formatMessage({id:"fkOQG8",defaultMessage:"Download file"}),p=(e,t)=>n.intl.formatMessage({id:"Ju0e9k",defaultMessage:"You're using <b>{usedBytes} of {quotaBytes}</b> of your free Dropbox storage space. Upgrade to a plan that scales with your work—or your over-quota files may be deleted."},{usedBytes:e,quotaBytes:t,b:e=>u.default.createElement("strong",null,e)}),C=n.intl.formatMessage({id:"r5pMlA",defaultMessage:"Warning"}),y=n.intl.formatMessage({id:"gW6Dlh",defaultMessage:"Current plan"}),w=n.intl.formatMessage({id:"XHZW23",defaultMessage:"Upgrade to continue collaborating on shared files"}),h=e=>n.intl.formatMessage({id:"QRtV/H",defaultMessage:"<b>Sharing will be restricted on {restrictionsDate}</b> if you're still over your storage limit."},{restrictionsDate:e,b:e=>u.default.createElement("strong",null,e)}),b=n.intl.formatMessage({id:"ac6d5L",defaultMessage:"<b>Sharing will be restricted soon</b> if you’re still over your storage limit."},{b:e=>u.default.createElement("strong",null,e)}),M=n.intl.formatMessage({id:"tELEKM",defaultMessage:"Sharing is restricted because you’re over your storage limit."}),S=e=>n.intl.formatMessage({id:"+CKpIi",defaultMessage:"Upgrade to view {fileName}"},{fileName:e}),P=e=>n.intl.formatMessage({id:"8t0sN4",defaultMessage:"<b>Preview will be restricted on {restrictionsDate}</b> if you're still over your storage limit."},{restrictionsDate:e,b:e=>u.default.createElement("strong",null,e)}),k=n.intl.formatMessage({id:"D9G/dF",defaultMessage:"<b>Preview will be restricted soon</b> if you’re still over your storage limit."},{b:e=>u.default.createElement("strong",null,e)}),E=n.intl.formatMessage({id:"e3Hu53",defaultMessage:"Preview is restricted because you’re over your storage limit."}),x=n.intl.formatMessage({id:"cp1Kff",defaultMessage:"Upgrade to continue adding content"}),B=n.intl.formatMessage({id:"FMGZlv",defaultMessage:"You’ve exceeded your storage limit. Upgrade to get more storage."});a.injectInternalStyle("/static/js/growth-components/auto-layout-modal/index.module.out-vfliNuVaI.css",(e=>"._bannerSection_sofs2_1{margin-bottom:var(--dig-spacing__macro__small);margin-top:var(--dig-spacing__micro__small)}._sideBySideContentContainer_sofs2_6{align-items:stretch;column-gap:var(--dig-spacing__macro__small);display:flex;flex-direction:row}._sideBySideContentItem_sofs2_13{flex:1}._footer_sofs2_17{display:flex;flex-wrap:wrap-reverse;gap:var(--dig-spacing__dimension__8)}._autoLayoutModalMobile_sofs2_23{._bannerSection_sofs2_1{margin:var(--dig-spacing__micro__large) calc(var(--dig-spacing__macro__small)*-1)}._sideBySideContentContainer_sofs2_6{align-items:stretch;flex-direction:column;margin-top:var(--dig-spacing__macro__xsmall);row-gap:var(--dig-spacing__macro__small)}._sideBySideContentItem_sofs2_13{flex-grow:0}}._autoLayoutModalMobile_sofs2_23._mobileCentered_sofs2_43{._sideBySideContentContainer_sofs2_6{display:block}._title_sofs2_48{text-align:center}._sideBySideContentItem_sofs2_13{align-items:center;display:flex;justify-content:center}._secondSideBySideContentItem_sofs2_58{margin-top:var(--dig-spacing__dimension__24)}._footer_sofs2_17{align-items:center;flex-direction:column-reverse}._footerButton_sofs2_67{margin:auto}}"));const I="_bannerSection_sofs2_1",T="_sideBySideContentContainer_sofs2_6",U="_sideBySideContentItem_sofs2_13",L="_footer_sofs2_17",O="_autoLayoutModalMobile_sofs2_23",q="_mobileCentered_sofs2_43",N="_title_sofs2_48",D="_secondSideBySideContentItem_sofs2_58",R=({title:e,bannerOptions:t,firstChild:o,secondChild:n,primaryCtaText:i,primaryCtaOnClick:l,primaryCtaProps:r,secondaryCtaText:s,secondaryCtaOnClick:d,secondaryCtaProps:c,showCloseButton:_,onCloseButtonClick:f,width:v=600,centerMobileView:m=!1,minWidth:g=366})=>{const[p,C]=u.default.useState(window.innerWidth<=v);u.default.useLayoutEffect((()=>{function e(){C(window.innerWidth<=v)}return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[v]);const y=t&&u.default.createElement(a.Box,{className:I},u.default.createElement(a.Banner,{type:t.type,borderRadius:p?"None":"Large"},u.default.createElement(a.Banner.Message,null,t.text),t.ctaText&&u.default.createElement(a.Banner.Actions,null,u.default.createElement(a.Button,{variant:"transparent",onClick:t.ctaOnClick},t.ctaText)))),w=a.cx({[O]:p,[q]:p&&m});return u.default.createElement(a.Modal,{open:!0,withCloseButton:_?"Close":void 0,onRequestClose:e=>null==f?void 0:f(e),width:v,className:w,fullScreen:p,contentStyles:{minWidth:`${g}px`}},u.default.createElement(a.Modal.Header,null,p&&y,u.default.createElement(a.Modal.Title,{className:N},e)),u.default.createElement(a.Modal.Body,null,!p&&y,u.default.createElement(a.Box,{className:T},u.default.createElement(a.Box,{className:U},o),n&&u.default.createElement(a.Box,{className:a.cx(U,D)},n))),u.default.createElement(a.Modal.Footer,{className:L},s&&u.default.createElement(a.Button,{variant:"opacity",onClick:d,...c},s),u.default.createElement(a.Button,{variant:"primary",onClick:l,...r},i)))};R.displayName="AutoLayoutModal";var A;!function(e){e.Sharing="SHARING",e.Preview="PREVIEW",e.UploadOrCreate="UPLOAD_OR_CREATE"}(A||(A={}));const F=e=>{throw new Error(`Unhandled value: ${e}`)};function V(e){if(null==e)return"";const t=new Date(1e3*e);return n.intl.formatDate(t,{year:"numeric",month:"long",day:"numeric"})}function Q({viewMode:e,isMobileView:t,fileName:o,quotaUpsellInfo:i,warningMode:l,usedLessThanPlusQuota:d,filePreview:c,planContent:C,quotaUsedBytes:I,quotaAllocatedBytes:T,onViewPlansClick:U,onCloseClick:L,onDownloadFileClick:O,onManageFilesClick:q,onGetPlanClick:N}){const D=function(e,t){switch(e){case A.Sharing:return w;case A.Preview:return S(t||"");case A.UploadOrCreate:return x;default:return F(e)}}(e,o),R=function(e,t){var a;const o=null===(a=null==t?void 0:t.restrictions)||void 0===a?void 0:a.restrictions_start_time_utc_seconds;switch(e){case A.Sharing:return o?h(V(o)):b;case A.Preview:return o?P(V(o)):k;case A.UploadOrCreate:return B;default:return F(e)}}(e,i),Q=function(e){switch(e){case A.Sharing:return M;case A.Preview:return E;case A.UploadOrCreate:return B;default:return F(e)}}(e),H=void 0!==O&&e===A.Preview&&!l&&(!t||t&&!d),G={title:D,bannerOptions:{type:l?"warning":"alert",text:l?R:Q,ctaText:H?g:void 0,ctaOnClick:H?O:void 0},firstChild:u.default.createElement(u.default.Fragment,null),primaryCtaText:m,primaryCtaOnClick:U,showCloseButton:l||t,onCloseButtonClick:e=>L(e),width:706};if(d&&C){const o=function(e,t,o,n,i,l){var r,s,d,u,c;const v={heading:null===(r=null==e?void 0:e.INDIVIDUAL)||void 0===r?void 0:r.advertised_space_short_gb_rounded,productFamily:(null===(s=null==e?void 0:e.INDIVIDUAL)||void 0===s?void 0:s.display_name)||"",eyebrow:(null===(d=null==e?void 0:e.INDIVIDUAL)||void 0===d?void 0:d.display_name)||"",eyebrowSubtle:!0,primaryCtaText:_,primaryOnClick:l,bulletsHeader:t?void 0:f,boldHeading:!0,fillMode:"outline",cardSizeVariant:"narrow-full-height",bullets:t?[]:[[a.CheckmarkLine,(null===(c=null===(u=null==e?void 0:e.INDIVIDUAL)||void 0===u?void 0:u.features)||void 0===c?void 0:c[0])||""]],alternativeToPricingSectionText:y,stretchToFillHeight:!0,centerInFlexContainer:!0,headingMarginTopSmall:!0};return o||(v.quotaIndicatorInfo={usedBytes:n,quotaBytes:i,subtextVerbForm:"imperative",meterColor:"red"}),v}(C,t,l,I,T,q),n=function(e,t,o,n){var i,l,r,d,u,c,_,m,g,p,C,y,w,h,b,M;const S={planSelectorName:a.PlanTypes.plus,monthlyBillingByMonth:(null===(i=null==e?void 0:e.PLUS)||void 0===i?void 0:i.monthly_billing_by_month)||"",annualBillingByMonth:(null===(l=null==e?void 0:e.PLUS)||void 0===l?void 0:l.annual_billing_by_month)||"",advertisedYearlyPriceSavingsPercentage:(null===(r=null==e?void 0:e.PLUS)||void 0===r?void 0:r.advertised_yearly_price_savings_percentage)||"",includedTaxString:(null===(d=null==e?void 0:e.PLUS)||void 0===d?void 0:d.included_tax_string)||"",countryCode:s.getCountryCodeFromIP()||"US"},P={productFamily:(null===(u=null==e?void 0:e.PLUS)||void 0===u?void 0:u.display_name)||"",heading:(null===(c=null==e?void 0:e.PLUS)||void 0===c?void 0:c.advertised_space_short_gb_rounded)||"",eyebrow:(null===(_=null==e?void 0:e.PLUS)||void 0===_?void 0:_.display_name)||"",eyebrowSubtle:!0,primaryCtaText:v((null===(m=null==e?void 0:e.PLUS)||void 0===m?void 0:m.advertised_space_short_gb_rounded)||""),primaryOnClick:n,bulletsHeader:f,boldHeading:!0,cardSizeVariant:"narrow-full-height",pricingInfo:S,bullets:[[a.CheckmarkLine,(null===(p=null===(g=null==e?void 0:e.PLUS)||void 0===g?void 0:g.features)||void 0===p?void 0:p[0])||""],[a.CheckmarkLine,(null===(y=null===(C=null==e?void 0:e.PLUS)||void 0===C?void 0:C.features)||void 0===y?void 0:y[1])||""],[a.CheckmarkLine,(null===(h=null===(w=null==e?void 0:e.PLUS)||void 0===w?void 0:w.features)||void 0===h?void 0:h[2])||""]],stretchToFillHeight:!0,centerInFlexContainer:!0,headingMarginTopSmall:!0};return t||(P.quotaIndicatorInfo={usedBytes:o,quotaBytes:(null===(b=null==e?void 0:e.PLUS)||void 0===b?void 0:b.quota_bytes)||0,subtextVerbForm:"present_participle",meterColor:"black",quotaString:(null===(M=null==e?void 0:e.PLUS)||void 0===M?void 0:M.advertised_space_short_gb_rounded)||""}),P}(C,l,I,N);t?(G.firstChild=u.default.createElement(r.TrialPlanCard,{...n}),G.secondChild=u.default.createElement(r.TrialPlanCard,{...o})):(G.firstChild=u.default.createElement(r.TrialPlanCard,{...o}),G.secondChild=u.default.createElement(r.TrialPlanCard,{...n})),G.centerMobileView=!0,e!==A.Preview||l?G.primaryCtaProps=t?{variant:"transparent"}:{variant:"outline"}:t?(G.primaryCtaProps={variant:"opacity",size:"xlarge",fullWidth:!0,style:{maxWidth:"384px"}},void 0!==O&&(G.secondaryCtaProps={variant:"transparent",size:"large"},G.secondaryCtaText=g,G.secondaryCtaOnClick=O)):(G.firstChild=c,G.secondChild=u.default.createElement(r.TrialPlanCard,{...n}),G.primaryCtaProps={variant:"outline"},G.secondaryCtaText=_,G.secondaryCtaOnClick=q,G.secondaryCtaProps={variant:"transparent"})}else G.firstChild=u.default.createElement(a.Text,null,p(a.format_bytes(n.intl,I),a.format_bytes(n.intl,T))),G.secondaryCtaText=_,G.secondaryCtaOnClick=q,G.primaryCtaProps={variant:"primary"};return G}const H="OVER_QUOTA_RESTRICTIONS_MODAL",G=({action:e,continueCallback:o,abortCallback:r,filePreview:s,fileName:d,downloadFileHandler:c})=>{var f,v,y,w,h,b,M,P,k,E;const{plansInfo:x,isLoadingPlansInfo:B}=i.useGetPlans({planNames:["basic","plus"],revenueContentLocation:"oq_restrictions_modal"}),{user:I}=a.useActiveUser(),{quotaUpsellInfo:T,isLoadingQuotaUpsellInfo:U}=a.useQuotaUpsellInfo(I),L=t.useRef(!1),O=(null===(f=null==T?void 0:T.quota)||void 0===f?void 0:f.used)||0,q=function(e){switch(e){case"share_modal":case"share_link":case"share_add_people":case"transfer":case"photos_copy_link":case"share_qr_code":case"shared_page_create_shared_folder":return A.Sharing;case"file_viewer":case"quick_view":case"standalone_preview":return A.Preview;case"upload":case"create":return A.UploadOrCreate;default:return F(e)}}(e),[N,D]=u.default.useState(window.innerWidth<=706);u.default.useLayoutEffect((()=>{function e(){D(window.innerWidth<=706)}return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]);const V=(null===(w=null===(y=null===(v=null==T?void 0:T.quota)||void 0===v?void 0:v.allocation)||void 0===y?void 0:y.individual)||void 0===w?void 0:w.allocated)||0,G=q!==A.UploadOrCreate&&((null===(h=null==T?void 0:T.restrictions)||void 0===h?void 0:h.show_restrictions_warning)||!1),W=void 0!==(null===(b=null==T?void 0:T.quota)||void 0===b?void 0:b.used)&&void 0!==(null===(M=null==x?void 0:x.PLUS)||void 0===M?void 0:M.quota_bytes)&&T.quota.used<x.PLUS.quota_bytes,z=a.getOverQuotaReason(null==T?void 0:T.overquota_reason),j=null!==(P=i.getOrganicOrChurnedFromString(z))&&void 0!==P?P:"unlabeled",Y=null===(k=null==T?void 0:T.restrictions)||void 0===k?void 0:k.overquota_start_time_utc_seconds,K=Y?Date.now()/1e3-Y:void 0,Z=(null===(E=null==T?void 0:T.restrictions)||void 0===E?void 0:E.show_restrictions_warning)&&!!Y&&0!==Y,$=t.useMemo((()=>({overQuotaSweepBlockingModalAction:e,quotaLimit:V,quotaUsed:O,organicOrChurned:j,secondsOverquota:K,hardblocked:!G,planShown:x&&W?"plus":"none",restrictionsStartDateShown:Z})),[V,O,j,K,G,e,x,W,Z]);t.useEffect((()=>{B||U||L.current||(a.UDCL.logEvent({class:"quota",action:"shown",object:"overquota_restrictions_modal",properties:$},{tags:{overQuotaSweepBlockingModalAction:$.overQuotaSweepBlockingModalAction,hardblocked:$.hardblocked?"true":"false",organicOrChurned:$.organicOrChurned,restrictionsStartDateShown:$.restrictionsStartDateShown?"true":"false"}}),L.current=!0)}),[$,B,U]);const J=e=>{a.UDCL.logEvent({class:"quota",action:"select",object:"overquota_restrictions_modal",properties:{...$,actionElement:e}},{tags:{actionElement:e,overQuotaSweepBlockingModalAction:$.overQuotaSweepBlockingModalAction,hardblocked:$.hardblocked?"true":"false",organicOrChurned:$.organicOrChurned,restrictionsStartDateShown:$.restrictionsStartDateShown?"true":"false"}})};if(B||U)return null;const X=()=>{J("view_plans"),a.redirect("/out-of-space?_tk=oq_restrictions_modal"),r(),a.unmountModal(void 0,H)},ee=()=>{J("manage_files"),a.redirect("/home?_tk=oq_restrictions_modal&pathway=download_and_delete_tooltip_tour&sort_by_size_desc=true"),r(),a.unmountModal(void 0,H)};let te;c&&(te=()=>{J("download_file"),null==c||c()});if(q===A.Preview&&!G&&!W&&!N)return u.default.createElement(n.Provider,{value:n.intl},u.default.createElement(l.OverQuotaFileViewerModal,{open:!0,onClose:()=>{o(),a.unmountModal(void 0,H)},headerText:S(d||""),bodyText:p(a.format_bytes(n.intl,O),a.format_bytes(n.intl,V)),badgeText:C,ctaText:m,onCtaClick:X,filePreview:s,secondaryCtaText:_,secondaryCtaOnClick:ee,tertiaryCtaText:g,tertiaryCtaOnClick:te,showCloseButton:!1}));const ae=Q({viewMode:q,isMobileView:N,fileName:d,quotaUpsellInfo:T,warningMode:G,usedLessThanPlusQuota:W,filePreview:s,planContent:x,quotaUsedBytes:O,quotaAllocatedBytes:V,onViewPlansClick:X,onCloseClick:e=>{e.preventDefault(),e.stopPropagation(),J("close_button"),G?o():r(),a.unmountModal(void 0,H)},onDownloadFileClick:te,onManageFilesClick:ee,onGetPlanClick:()=>{J("get_plan"),a.redirect("/buy/plus?_tk=oq_restrictions_modal"),r(),a.unmountModal(void 0,H)}});return u.default.createElement(n.Provider,{value:n.intl},u.default.createElement(R,{...ae}))};G.displayName="FunctionalOverQuotaRestrictionsModal";const W=e=>{a.mountModal(u.default.createElement(o.QueryClientProvider,{client:o.queryClient},u.default.createElement(G,{action:e.action,continueCallback:e.continueCallback,abortCallback:e.abortCallback,filePreview:e.filePreview,fileName:e.fileName,downloadFileHandler:e.downloadFileHandler})),void 0,H)};var z=Object.freeze({__proto__:null,openOverQuotaRestrictionsModal:W});e.SHARING_ENFORCE_RESTRICTIONS=M,e.SHARING_RESTRICTION_WARNING=h,e.SHARING_RESTRICTION_WARNING_NO_DATE=b,e.UPGRADE=c,e.getRestrictionsDateString=V,e.openOverQuotaRestrictionsModal=W,e.open_over_quota_restrictions_modal_esnext=z}));
//# sourceMappingURL=c_ui_over-quota-sweep-blocking-modal_open_over_quota_restrictions_modal.js-vflgwDqBU.map

//# debugId=6fba319a-b71f-361a-b5b3-712c555332fe