!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="f1de348e-dd26-3de9-a2dd-ed7f97728488")}catch(e){}}();
define(["exports","react","./e_file_viewer_static_scl_page_file","./c_common_components_buttons","./c_core_i18n","./c_inband-screen_internals_share-modal-share","./c_content-member-list_internals_content-member-list","./c_memoize-one","./c_bem","./e_data_modules_stormcrow","./c_dig-components_combinations_index","./c_dig-components_metadata_index","./c_utils_dsx_dsx-react","./e_core_exception","./c_dig-icons_assets_ui-icon_line_settings"],(function(e,t,a,n,s,i,r,l,o,c,d,m,g,u,E){"use strict";function p(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(a){if("default"!==a){var n=Object.getOwnPropertyDescriptor(e,a);Object.defineProperty(t,a,n.get?n:{enumerable:!0,get:function(){return e[a]}})}})),t.default=e,Object.freeze(t)}var f=p(t);const b=e=>e.formatMessage({id:"azBLeN",defaultMessage:"Close"}),M=e=>e.formatMessage({id:"XAZa6R",defaultMessage:"Settings"}),L=e=>e.formatMessage({id:"fFhvfv",defaultMessage:"Couldn’t load member list"}),C=()=>f.createElement(a.Box,{style:{width:"100%"},marginTop:"Macro Small","data-testid":"people-list-placeholder"},f.createElement(a.Stack,{gap:"Macro Small"},Array.from({length:5}).map(((e,t)=>f.createElement(a.Box,{style:{padding:"0 8px 0 0",display:"flex",alignItems:"center",justifyContent:"center",height:"32px"},key:t},f.createElement(a.Box,{style:{paddingRight:"12px"}},f.createElement(a.Skeleton.Avatar,null)),f.createElement(a.Box,{style:{width:"100%",display:"flex",flexDirection:"column",justifyContent:"space-around"}},f.createElement(a.Stack,{gap:"Micro XSmall"},f.createElement(a.Skeleton.Box,{height:16,width:231}),f.createElement(a.Skeleton.Box,{height:12,width:139}))))))));C.displayName="PeopleListPlaceholder";const S=({objectIdentifier:e,inviteMessage:t,inviteTargets:a,setInviteMessage:n,setInviteTargets:s,onRequestClose:r,onStartInband:l})=>{const o=f.useCallback((e=>{n(e)}),[n]),c=f.useCallback((e=>{s(e)}),[s]),d=f.useCallback((()=>{s([]),n(""),r()}),[s,n,r]),m=f.useCallback((()=>{s([]),n(""),r()}),[s,n,r]);return f.createElement(i.Inband,{oid:e,inviteMessage:t,inviteTargets:a,onInviteMessageChange:o,hasUpdatedAccountMetadata:!1,onCloseClick:()=>{},onTargetsDropdownFocusChange:()=>{},onInviteTargetsChange:c,onShareStart:()=>{},onInbandShareSuccess:d,onShareFailure:m,onStartInband:l,shouldStyleForSM21:!0,onRefreshObjectMetadata:()=>{},onRefreshModal:()=>{},shouldTransitionAccessoryAreaEnter:!0})};var k;S.displayName="AccessManagementInband",function(e){e.BUTTON="button",e.INBAND="inband"}(k||(k={}));const h=({title:e,subtitle:t,adminConsoleInbandView:n})=>f.createElement(a.Box,{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",borderWidth:"2",borderStyle:"Solid",borderColor:"Border Subtle",borderRadius:"Large",height:"100%",style:{padding:n===k.INBAND?"35px 8px":"65px 8px"}},f.createElement(a.Title,{size:"small",color:"subtle",style:{textAlign:"center"}},e),f.createElement(a.Text,{color:"subtle",style:{textAlign:"center"}},t));h.displayName="CustomScreen";const I=({objectIdentifier:e,onRequestClose:t,onSettingsClick:n,adminConsoleInbandView:i,onObjectIdentifierChanged:l,onMemberListDataLoading:o})=>{const c=s.useIntl(),d=f.useCallback((()=>{t(),a.invalidateSharingObjectMetadata(e),r.invalidateListSharedLinks(e),a.invalidateObjectMembers(e)}),[e,t]),m=f.useCallback((()=>{n()}),[n]),g=f.useCallback((()=>{}),[]),u=f.useCallback((()=>{}),[]),E="function"==typeof l?l:()=>{},p=f.useMemo((()=>{const t=(e=>e.formatMessage({id:"SWV1dE",defaultMessage:"Keep track of people and permissions"}))(c),a=((e,t)=>e.formatMessage({id:"ajXUcE",defaultMessage:"When specific people are invited to this {isFile, select, true {file} other {folder}}, they’ll be listed here."},{isFile:t?"true":"false"}))(c,"file"===e[".tag"]);return f.createElement(h,{title:t,subtitle:a,adminConsoleInbandView:i})}),[i,c,e]);return f.createElement(r.ContentMemberList,{objectIdentifier:e,openLinkSettings:m,onRequestClose:t,onChangeConfidentiality:u,onTransferFolderOwnership:d,onObjectIdentifierChanged:E,onConfirmationModalShownChange:g,memberNameTruncationLimit:300,inheritedListTitleTruncationLimit:450,customNoOtherMembersScreen:p,customErrorScreenWrapper:({errorMessage:e})=>f.createElement(h,{title:L(c),subtitle:e,adminConsoleInbandView:i}),useSimpleDowngradeBanner:!0,onMemberListDataLoading:o})};I.displayName="AccessManagementMemberList";const x=({objectIdentifier:e,isOpen:t,setIsOpen:n})=>{const{user:i}=a.useActiveUser(),l=s.useIntl(),o=a.useSharingObjectMetadata(e.fileId),c=a.useObjectMembers(e),d=r.useAccountDataBatch(_(c,i)),m=!o.isLoading&&!o.isError,g=!d.isLoading&&!d.isError,u=c.isFirstPageLoaded&&c.isFirstPageOnly;return m&&u&&g?f.createElement(a.Box,{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",onClick:()=>{n(!t)},cursor:"pointer"},f.createElement(a.Box,{display:"flex",alignItems:"center",style:{width:"100%"}},f.createElement(a.Box,{marginRight:"Micro Small"},f.createElement(r.ContentMemberFacepileButton,{oid:e,disableRightChevron:!0,onClick:()=>{n(!t)},onView:()=>{}})),f.createElement(a.Text,{size:"small",style:{maxWidth:"calc(100% - 78px)"}},(e=>e.formatMessage({id:"cx2Oxf",defaultMessage:"People with access"}))(l))),f.createElement(a.Box,null,f.createElement(a.IconButton,{variant:"opacity",size:"small","aria-expanded":t,"aria-controls":"sm24-access-management-member-list","data-testid":"access-management-member-list-dropdown-toggle"},f.createElement(a.UIIcon,{src:t?a.ChevronUpLine:a.ChevronDownLine})))):null};x.displayName="AccessManagementMemberListDropdown";const _=(e,t)=>{const a=[];return e.isFirstPageLoaded&&e.isFirstPageOnly?(e.firstPage.users.map((e=>a.push(e.user.account_id))),0===e.firstPage.users.length&&t&&a.push(t.account_id),a):[]},y=(e,t)=>"editor"===t?e.formatMessage({id:"z7dGdQ",defaultMessage:"Link for editing"}):e.formatMessage({id:"gL4fDf",defaultMessage:"Link for viewing"}),v=(e,t,a,n)=>a?e.formatMessage({id:"Ee/uzy",defaultMessage:"Link settings are unavailable right now"}):n?e.formatMessage({id:"CMAwE0",defaultMessage:"Not available – you don’t have permission to create this link"}):t?e.formatMessage({id:"Hpj0Wp",defaultMessage:"Active"}):e.formatMessage({id:"yJ0Cty",defaultMessage:"Not created – set up in Settings"}),N=(e,t)=>"editor"===t?e.formatMessage({id:"vEhq9Y",defaultMessage:"Edit link settings"}):e.formatMessage({id:"ZFSdE4",defaultMessage:"View link settings"}),T={$props:g.atom({objectIdentifier:{".tag":"file",fileId:""},openLinkSettings:()=>{},listSharedLinksResult:{isLoading:!0},objectMetadataResult:{isLoading:!0}})},{StoreProvider:B,useStore:w}=g.defineStoreProvider((e=>({$props:e})),T),A=e=>{const t=r.useListSharedLinks(e.objectIdentifier),n=a.useSharingObjectMetadata(e.objectIdentifier.fileId);return f.createElement(B,{listSharedLinksResult:t,objectMetadataResult:n,...e})};A.displayName="Provider";const O=Symbol("ON_VIEW_MANAGE_ACCESS_LINKS"),j=Symbol("ON_FAILURE_RENDER"),{useEmitter:R,defaultEmitter:D}=a.defineLogger((async({event:e,getContextValue:t})=>{const n=t(a.Context$1),s=t(a.Context$2),i=t(a.Context$3),l={...a.getTags$4(n),...a.getTags$5(s),...a.getTags$6(i),isSm24:"true"},o={...a.getProperties$4(n),...a.getProperties$5(s),...a.getProperties$6(i)};e.key===O?a.UDCL.logEvent(r.PAP_View_ManageAccess({...o,manageAccessElement:"manage_access_links"}),{tags:{...l,element:"manage_access_links"}}):e.key===j&&a.UDCL.logEvent("ops.view_manage_access_failure",{tags:{...l,eventState:"failed",element:"manage_access_links"}})})),P=({iconSrc:e})=>e?f.createElement(a.Box,{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"Circular",backgroundColor:"Background Subtle",style:{width:"32px",height:"32px"}},f.createElement(a.UIIcon,{src:e,size:"standard"})):null;P.displayName="CircularIconContainer";const z=({iconSrc:e})=>f.createElement(a.List.Item,{padding:0},f.createElement(a.List.Accessory,null,f.createElement(P,{iconSrc:e})),f.createElement(a.List.Content,null,f.createElement(a.LabelGroupNamespace,{withLabel:f.createElement(a.Skeleton.Text,{size:"medium",width:230,borderRadius:"XSmall"}),withSubText:f.createElement(a.Skeleton.Text,{size:"small",width:140,borderRadius:"XSmall"})})));z.displayName="SkeletonListItem";const U=()=>f.createElement(a.List,{"data-testid":"manage-links-list-skeleton"},f.createElement(z,{iconSrc:a.EditLine}),f.createElement(z,{iconSrc:a.ShowLine}));U.displayName="ManageLinksSkeleton";const V=()=>{const e=w(),t=R(),{objectMetadataResult:n,listSharedLinksResult:s,openLinkSettings:i,objectIdentifier:l}=g.useAtom(e.$props),o=s.isLoading||s.isError?void 0:s.output,c=!s.isLoading&&s.isError,d=n.isLoading||n.isError?void 0:n.output,m=!n.isLoading&&n.isError||c,{editLink:u,viewLink:E}=(e=>({editLink:e?a.getEditLinkMetadata(e):null,viewLink:e?a.getViewLinkMetadata(e):null}))(o),{canCreateEditLink:p,canCreateViewLink:b}=(e=>({canCreateEditLink:e?a.getCanDoAction(e,a.CREATE_EDIT_LINK_TAG):void 0,canCreateViewLink:e?a.getCanDoAction(e,a.CREATE_VIEW_LINK_TAG):void 0}))(d),M=!p&&!b,L=!!u||p||M||m,C=!!E||b||M||m,S=e=>t=>{t.preventDefault(),i(e),r.invalidateListSharedLinks(l)},k={isLinkExisting:!!u,onLinkSettingsClick:!m&&p?S("edit_link_settings"):void 0,linkAccessLevel:a.EDITOR,iconSrc:a.EditLine,isError:m,isNoPermissions:!1===p},h={isLinkExisting:!!E,onLinkSettingsClick:!m&&b?S("view_link_settings"):void 0,linkAccessLevel:a.VIEWER,iconSrc:a.ShowLine,isError:m,isNoPermissions:!1===b};return f.useEffect((()=>{m||t.select(O).emit(null)}),[t,m]),f.createElement(a.List,{"data-testid":"manage-links-list",paddingY:0},L&&f.createElement(F,{...k}),C&&f.createElement(F,{...h}))};V.displayName="ManageLinksInner";const F=({isLinkExisting:e,linkAccessLevel:t,onLinkSettingsClick:n,iconSrc:i,isError:r,isNoPermissions:l})=>{const o=s.useIntl(),c=(null==t?void 0:t[".tag"])||"",g=e&&!r&&!l;return["viewer","editor"].includes(c)?f.createElement(a.List.Item,{paddingX:0},f.createElement(a.List.Accessory,null,f.createElement(P,{iconSrc:i})),f.createElement(a.List.Content,null,f.createElement(a.LabelGroupNamespace,{verticalAlignment:"center",labelGap:"0",withLabel:f.createElement(a.Text,{variant:"label"},y(o,c)),withMeta:f.createElement(m.Metadata2,{size:"small"},f.createElement(m.Metadata2.Item,null,f.createElement(m.Metadata2.ArbitraryIcon,{src:f.createElement(a.Badge,{variant:g?"success":"standard",style:g?void 0:{backgroundColor:"var(--dig-color__disabled__on-surface)"}}),style:{display:"flex",alignItems:"center",width:"auto",height:"100%",paddingRight:"4px"}}),f.createElement(m.Metadata2.Label,null,v(o,e,r,l))))})),f.createElement(a.List.Accessory,null,!!n&&f.createElement(d.IconButtonGroup,null,(({getButtonProps:e})=>f.createElement(a.IconButton,{variant:"borderless",onClick:n,"aria-label":N(o,c),"data-uxa-log":"sm24-manage-links-settings-button","data-uxa-interactions":"click",...e()},f.createElement(a.UIIcon,{src:E.SettingsLine})))))):null};F.displayName="ManageLinksListItem";const $=()=>{const e=w(),t=R(),{objectMetadataResult:a,listSharedLinksResult:n}=g.useAtom(e.$props),s=a.isLoading,i=!s&&a.isError,r=n.isLoading,l=!r&&n.isError,o=s||r;return(i||l)&&(t.select(j).emit(null),u.reportStack("Error fetching data for Manage Links.",{severity:u.SEVERITY.CRITICAL,tags:["manage-links"],silent:!0})),o?f.createElement(U,null):f.createElement(V,null)};$.displayName="ManageLinksWithStore";const W=e=>f.createElement(A,{...e},f.createElement(a.ErrorBoundary,{fallback:null,onError:e=>{u.reportException({err:e,severity:u.SEVERITY.CRITICAL,tags:["manage-links","sharing"],exc_extra:{message:"Error loading Manage Links"}})}},f.createElement($,null)));W.displayName="ManageLinks";const G=({objectIdentifier:e,onSettingsClick:t})=>{const a=f.useCallback((e=>{t&&t(e)}),[t]);return f.createElement(W,{objectIdentifier:e,openLinkSettings:a})};G.displayName="AccessManagementManageLinks";const X=({objectIdentifier:e,fileOrFolderName:t,isOpen:l,onRequestClose:o,onSettingsClick:c,isNonUserRelativeContext:d=!1})=>{const m=!d,g=a.useEmitter$3(),u=m?520:354,p=m?716:578,[L,h]=f.useState(e),[_,y]=f.useState(k.BUTTON),[v,N]=f.useState(!0),[T,B]=f.useState(!1),[w,A]=f.useState([]),[O,j]=f.useState(""),R=Date.now(),[D,P]=f.useState(null),z=f.useCallback((e=>{N(e)}),[]),U=()=>{o(),g.select(a.ON_CLICK_CLOSE_BUTTON).emit(null),r.invalidateListSharedLinks(L)},V=f.useCallback((()=>{g.select(a.ON_CLICK_SETTINGS_BUTTON).emit(null),c()}),[c,g]),F=f.useCallback((e=>{g.select(a.ON_CLICK_LINK_SETTINGS_BUTTON).emit(null),c(e)}),[c]),$=K()<600,W=f.useMemo((()=>_===k.INBAND),[_]),X=f.useCallback((()=>{B(!0),g.select(a.ON_CLICK_INBAND_ENTRY_BUTTON).emit(null)}),[B,g]),q=f.useCallback((()=>{y(k.INBAND)}),[y]),H=f.useCallback((()=>{P(!D),g.select(a.ON_CLICK_MEMBER_LIST_TOGGLE).emit(null)}),[D,g]),Y=f.useCallback((e=>{h(e)}),[]);return f.useEffect((()=>{a.Modal.setAppElement(document.body)}),[]),f.useEffect((()=>{e[".tag"]===L[".tag"]&&h(e)}),[e,L]),f.createElement(a.Modal,{contentStyles:{height:$?"100%":"auto"},width:540,isCentered:!0,open:l,onRequestClose:U,"aria-label":s.intl.formatMessage({id:"oP7zBj",defaultMessage:"Access Management Modal"}),"data-testid":"shareme24-modal"},f.createElement(a.Box,{"data-test-id":"access-management-modal"},f.createElement(a.Modal.Header,{className:r.classes.headerSection,style:{padding:"24px 24px 16px",marginBottom:"0",maxWidth:"100%"}},f.createElement((()=>{return f.createElement(f.Fragment,null,f.createElement(a.Box,{className:r.classes.headerSectionTextContainer},f.createElement(a.Text,{style:{display:"flex",justifyContent:"flex-start"},size:"large",isBold:!0,className:r.classes.headerSectionPrimaryText},(e=s.intl,l=t,e.formatMessage({id:"uXba7s",defaultMessage:"Manage access to {contentName}"},{contentName:i.Emstring.em_snippet(l,a.SNIPPET_SIZES.FOLDER_NAME)})))),f.createElement(a.Box,{className:r.classes.headerSectionButtonContainer},f.createElement(n.HeaderIconButton,{onClick:V,variant:"borderless","aria-label":M(s.intl),"data-testid":"access-management-settings-button"},f.createElement(a.UIIcon,{src:E.SettingsLine})),f.createElement(n.HeaderIconButton,{onClick:U,variant:"borderless","aria-label":b(s.intl),"data-testid":"access-management-close-button"},f.createElement(a.UIIcon,{src:a.CloseLine}))));var e,l}),null)),f.createElement(a.Modal.Body,{style:{minHeight:`${u}px`,maxHeight:$?"100%":`${p}px`,overflow:"hidden",display:"flex",flexDirection:"column"}},f.createElement(a.Box,{style:{flex:"0 0 auto"}},m&&f.createElement(a.Box,{marginBottom:"Micro Medium"},f.createElement(a.Text,{size:"medium",isBold:!0},s.intl.formatMessage({id:"XlibN2",defaultMessage:"People"}))),f.createElement(a.Box,{marginTop:"Micro Medium"},_===k.BUTTON&&f.createElement(r.TokenizerButton,{oid:L,onTokenizerButtonClick:X,componentViewTime:R}),T&&f.createElement(a.Box,{style:{display:_!==k.INBAND?"none":void 0}},f.createElement(S,{objectIdentifier:L,inviteMessage:O,inviteTargets:w,setInviteMessage:j,setInviteTargets:A,onRequestClose:o,onStartInband:q})))),f.createElement(a.Box,{display:"flex",flexDirection:"column",justifyContent:"flex-start",width:"100%",overflow:"hidden",marginBottom:"Micro Large"},W&&f.createElement(a.Box,{paddingX:"Micro Small",paddingTop:"Micro Large",borderTop:"Solid",borderWidth:"1",borderColor:"Border Subtle",marginTop:"Micro Medium","data-testid":"access-management-member-list-dropdown"},f.createElement(x,{objectIdentifier:L,isOpen:!!D,setIsOpen:H})),v&&f.createElement(C,null),f.createElement(a.Box,{className:a.cx(r.classes.accessManagementPeopleList,{[r.classes.accessManagementPeopleListDropdownDefault]:W&&!D,[r.classes.accessManagementPeopleListDropdownExpand]:W&&!0===D,[r.classes.accessManagementPeopleListDropdownCollapse]:W&&!1===D}),display:v?"none":void 0,width:"100%",marginTop:W?"Micro Small":"Micro Large",paddingX:W?"Micro Small":void 0,"data-testid":"sm24-access-management-member-list",id:"sm24-access-management-member-list"},f.createElement(I,{objectIdentifier:L,onRequestClose:o,onSettingsClick:F,adminConsoleInbandView:_,onObjectIdentifierChanged:Y,onMemberListDataLoading:z}))),m&&f.createElement(a.Box,{paddingTop:"Micro Medium",paddingBottom:"Micro Medium","data-testid":"access-management-manage-links"},f.createElement(a.Box,{paddingBottom:"Micro XSmall"},f.createElement(a.Text,{size:"medium",isBold:!0},(e=>e.formatMessage({id:"YZPZOn",defaultMessage:"Links"}))(s.intl))),f.createElement(G,{objectIdentifier:L,onSettingsClick:F})))))};X.displayName="AccessManagementModal";const K=()=>{const[e,t]=f.useState(window.innerWidth);return f.useEffect((()=>{const e=()=>t(window.innerWidth);return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),e};e.AccessManagementModalWithErrorBoundary=e=>f.createElement(a.ErrorBoundary$1,{componentTag:"access-management-modal",exceptionTags:["error_boundary:access_management_modal","access_management"],reportMetrics:!0,fallback:null},f.createElement(X,{...e}))}));
//# sourceMappingURL=c_internals_access-management-modal_modal.js-vflX20aEz.map

//# debugId=f1de348e-dd26-3de9-a2dd-ed7f97728488