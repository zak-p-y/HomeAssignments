!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="2e30cc8e-1376-309f-a958-e929d3f37200")}catch(e){}}();
define(["exports","./c_spectrum_util_raf_throttle","./c_pap-events_navigation_select_create_folder_action","./c_api_v2_routes_growth_provider","./c_memoize-one"],(function(e,t,s,n,r){"use strict";var o,i,a;e.ApiV2HeaderNames=void 0,(o=e.ApiV2HeaderNames||(e.ApiV2HeaderNames={})).DropboxApiArg="Dropbox-API-Arg",o.DropboxApiSelectAdmin="Dropbox-API-Select-Admin",o.DropboxPathRoot="X-Dropbox-Path-Root",o.DropboxUid="X-Dropbox-Uid",o.DropboxTeamId="X-Dropbox-Teamid",o.DropboxTeamAuthorization="X-Dropbox-Team-Authorization",o.CsrfToken="X-CSRF-Token",function(e){e[e.TeamAdminRole=0]="TeamAdminRole",e[e.MTARole=1]="MTARole",e[e.FederationAdminRole=2]="FederationAdminRole"}(i||(i={})),function(e){e[e.AdminAction=0]="AdminAction",e[e.AssumeAction=1]="AssumeAction",e[e.OnBehalfOfAction=2]="OnBehalfOfAction"}(a||(a={}));class d{static parse(e){const t=e[".tag"];return 2===Object.keys(e).length&&null!=e[t]?new p(t,e[t]):new c(t,e)}constructor(e,t,s){this.type=e,this.value=t,this.isScalar=s}}class p extends d{constructor(e,t=null){super(e,t,!0)}toJSON(){const e={".tag":this.type};return null!=this.value&&(e[this.type]=this.value),e}}class c extends d{constructor(e,t={}){super(e,t,!1)}toJSON(){return{".tag":this.type,...this.value||{}}}}class u extends Error{static parseResponse(e,t,s,n,r,o=null){var i,a;null==o&&(o=e in g?g[e]:e>=500?m:u);const d={raw:{status:e,responseBody:s},response:null,summary:null,error:{},headers:t,rpcPath:n};let p=s;try{const e=JSON.parse(s)||{};d.error=e.error,d.summary=e.error_summary||(null===(a=null===(i=e.error)||void 0===i?void 0:i.status)||void 0===a?void 0:a[".tag"])||"",e.user_message&&"string"==typeof e.user_message.text?p=e.user_message.text:"string"==typeof d.summary&&""!==d.summary&&(p=`error_summary: "${d.summary}"`)}catch(e){}d.response=p,n&&!p.startsWith("Error in call to API function")&&(p=`Error in call to API function ${n}: ${p}`);const c=Object.assign(new o(p),d);return r&&(c.stack=r),c}}class l extends u{}class h extends u{}class m extends u{}class f extends u{}function _(e){return e instanceof u}const g={400:class extends u{},401:l,409:h,429:f};class w extends Error{constructor(e,t){super(t),this.name="FetchAbortError",this.response=e}}class b extends Error{constructor(e,t){super(t),this.name="FetchFailError",this.response=e}}class E extends Error{constructor(e,t){super(t),this.name="FetchResponseError",this.response=e}}function x(e){return"FetchResponseError"===e.name}const T={idleTimeout:500,networkTimeout:6e4};class A{constructor(){this.pendingRequests=0,this.subscribers=new Set,this.didNetworkTimeOut=!1,this.next=e=>{this.subscribers.forEach((t=>t(e)))},this.startCleanupTimeout=()=>{this.abortCleanupTimeout();this.cleanupTimeout=window.setTimeout((()=>{this.didNetworkTimeOut=!0,this.pendingRequests=0,this.next("IDLE")}),T.networkTimeout)},this.abortCleanupTimeout=()=>{window.clearTimeout(this.cleanupTimeout),this.cleanupTimeout=void 0},this.increment=()=>{this.startCleanupTimeout(),0===this.pendingRequests&&this.next("BUSY"),this.pendingRequests+=1},this.decrement=()=>{this.abortCleanupTimeout(),1===this.pendingRequests?this.next("IDLE"):this.startCleanupTimeout(),this.pendingRequests=Math.max(this.pendingRequests-1,0)},this.subscribe=e=>{this.subscribers.add(e);return()=>{this.subscribers.delete(e)}}}}class R{constructor(){this.pendingResources=new Set,this.subscribers=new Set,this.didNetworkTimeOut=!1,this.next=e=>{this.subscribers.forEach((t=>t(e)))},this.startCleanupTimeout=()=>{this.abortCleanupTimeout();this.cleanupTimeout=window.setTimeout((()=>{this.didNetworkTimeOut=!0,this.pendingResources=new Set,this.next("IDLE")}),T.networkTimeout)},this.abortCleanupTimeout=()=>{window.clearTimeout(this.cleanupTimeout),this.cleanupTimeout=void 0},this.add=e=>{e instanceof HTMLImageElement&&!e.src||e instanceof HTMLImageElement&&e.complete||e instanceof HTMLLinkElement&&!e.href||e instanceof HTMLScriptElement&&!e.src||e instanceof HTMLIFrameElement&&!e.src||(this.startCleanupTimeout(),0===this.pendingResources.size&&this.next("BUSY"),this.pendingResources.add(e))},this.remove=e=>{this.abortCleanupTimeout(),this.pendingResources.delete(e),0===this.pendingResources.size?this.next("IDLE"):this.startCleanupTimeout()},this.subscribe=e=>{this.subscribers.add(e);return()=>{this.subscribers.delete(e)}},(null===window||void 0===window?void 0:window.MutationObserver)&&window.addEventListener("load",(()=>{new MutationObserver((e=>{e.forEach((e=>{e.addedNodes.forEach((e=>{e instanceof HTMLScriptElement||e instanceof HTMLLinkElement||e instanceof HTMLImageElement||e instanceof HTMLIFrameElement?this.add(e):e.hasChildNodes()&&e instanceof HTMLElement&&e.querySelectorAll("img").forEach(this.add)}))}))})).observe(window.document.documentElement,{childList:!0,subtree:!0}),["load","error"].forEach((e=>{window.document.addEventListener(e,(e=>{(e.target instanceof HTMLScriptElement||e.target instanceof HTMLLinkElement||e.target instanceof HTMLImageElement||e.target instanceof HTMLIFrameElement)&&this.remove(e.target)}),{capture:!0})}))}))}}class v{constructor(){this.incrementAjaxCount=()=>{},this.decrementAjaxCount=()=>{},this.isIdle=()=>!0,this.didNetworkTimeOut=()=>!1,this.resetDidNetworkTimeOut=()=>{},this.subscribe=()=>()=>{}}}class y{constructor(){this.ajaxIdleObservable=new A,this.resourceLoadingIdleObservable=new R,this.subscribers=new Set,this.ajaxIdle=!0,this.scriptLoadingIdle=!0,this.handleUpdate=e=>t=>{const s=this.ajaxIdle&&this.scriptLoadingIdle;"AJAX"===e&&(this.ajaxIdle="IDLE"===t),"RESOURCE_LOADING"===e&&(this.scriptLoadingIdle="IDLE"===t);const n=this.ajaxIdle&&this.scriptLoadingIdle;s!==n&&this.next(n?"IDLE":"BUSY")},this.next=e=>{this.subscribers.forEach((t=>t(e)))},this.incrementAjaxCount=()=>this.ajaxIdleObservable.increment(),this.decrementAjaxCount=()=>this.ajaxIdleObservable.decrement(),this.isIdle=()=>this.ajaxIdle&&this.scriptLoadingIdle,this.didNetworkTimeOut=()=>this.ajaxIdleObservable.didNetworkTimeOut||this.resourceLoadingIdleObservable.didNetworkTimeOut,this.resetDidNetworkTimeOut=()=>{this.ajaxIdleObservable.didNetworkTimeOut=!1,this.resourceLoadingIdleObservable.didNetworkTimeOut=!1},this.subscribe=e=>{this.subscribers.add(e);return()=>{this.subscribers.delete(e)}},this.ajaxIdleObservable.subscribe(this.handleUpdate("AJAX")),this.resourceLoadingIdleObservable.subscribe(this.handleUpdate("RESOURCE_LOADING"))}}let I;const C=()=>n.isServerSide()||"undefined"==typeof window?new v:(I||(I=new y),I),k=C().incrementAjaxCount,O=C().decrementAjaxCount;function S(e){const t={};return e.forEach(((e,s)=>{t[s]=e})),t}class L{executeRpc(e,t,n,r,o,i){return new Promise(((a,d)=>{s.incrementAjaxCount(),k();const p=()=>{s.decrementAjaxCount(),O()};return fetch(e.toString(),{method:"POST",mode:"same-origin",credentials:"same-origin",headers:{...t,"Content-Type":r},body:n,signal:o}).then((e=>e.text().then((t=>({response:e,responseText:t}))))).then((({response:e,responseText:t})=>{if(e.ok)return{response:e,responseText:t};throw new E(e,t)})).then((({response:e,responseText:t})=>(p(),a({headers:S(e.headers),result:JSON.parse(t)})))).catch((t=>(p(),x(t)?d(u.parseResponse(t.response.status,S(t.response.headers),t.message,e.getPath(),i)):d(u.parseResponse(0,{},"Fetch network failure - message aborted or user offline",e.getPath(),i)))))}))}executeBinaryRpc(e,t,n,r,o){return new Promise(((i,a)=>(s.incrementAjaxCount(),k(),fetch(e.toString(),{method:"POST",mode:"same-origin",credentials:"same-origin",headers:{...t,"Content-Type":r},body:n,signal:o}).then((e=>e.ok?e.arrayBuffer().then((t=>({response:e,responseData:t}))):e.text().then((t=>{throw new E(e,t)})))).then((({response:e,responseData:t})=>i({headers:S(e.headers),result:t}))).catch((t=>x(t)?a(u.parseResponse(t.response.status,S(t.response.headers),t.message,e.getPath())):a(u.parseResponse(0,{},"Fetch network failure - message aborted or user offline",e.getPath())))).finally((()=>{s.decrementAjaxCount(),O()})))))}}function j(){if(!window.ensemble)return void 0!==n.getYapsProject()&&void 0!==n.getYapsDeployment()?`${n.getYapsProject()}:${n.getYapsDeployment()}`:void 0;const e=window.ensemble.getPageletInfoForExceptionReporting().filter((e=>void 0!==e.yaps_deployment&&void 0!==e.yaps_project));return 0!==e.length?e.sort(((e,t)=>e.pagelet_name<t.pagelet_name?-1:1)).map((e=>`${e.yaps_project}:${e.yaps_deployment}`)).join(";"):void 0}class H extends L{}class D{constructor(e,t=!1){this.uploadEndpoints=new Set(["backups/upload_session/append","files/alpha/upload","files/paper/create","files/paper/update","files/upload","files/upload_v2","files/upload_session/append_v2","files/upload_session/append_batch","files/upload_session/finish","files/upload_session/finish_v2","files/upload_session/start","paper/cloud_docs/update","paper/desktop/spaces/upload_log","paper/desktop/upload_log","paper/docs/create","paper/docs/update","support_attachments/upload","hellosign/self_sign","hellosign/send_signature_request","ungated_file_conv_block/convert_to_pdf"]),this.downloadEndpoints=new Set(["backups/download","backups/download_zip","files/download","files/download_zip","files/export","files/get_preview","files/get_thumbnail_v2","paper/docs/download","sharing/get_shared_link_file","sharing/export_shared_link","hellosign/convert_to_pdf_download","privacy_request/fs_user_get_export"]),this.supportedUploadEndpoints=new Set(["backups/upload_session/append","files/paper/create","files/paper/update","files/upload","files/upload_v2","files/upload_session/append_v2","files/upload_session/append_batch","files/upload_session/finish","files/upload_session/finish_v2","files/upload_session/start","paper/cloud_docs/update","paper/desktop/spaces/upload_log","paper/desktop/upload_log","paper/docs/create","paper/docs/update","support_attachments/upload","hellosign/self_sign","hellosign/send_signature_request","ungated_file_conv_block/convert_to_pdf"]),this.supportedDownloadEndpoints=new Set(["backups/download","backups/download_zip","files/download","files/get_thumbnail_v2","sharing/get_shared_link_file","sharing/export_shared_link","hellosign/convert_to_pdf_download","privacy_request/fs_user_get_export"]),this.transport=e||new H,this.ns=N.bind(this),this.skipCsrf=t}_upload(e,t,s,n){return this._uploadWithResponseHeaders(e,t,s,n).then((e=>e.result))}_uploadWithResponseHeaders(t,s,n,r){if(!this.uploadEndpoints.has(t))throw new Error(t+" does not use the content-upload endpoint format");if(!this.supportedUploadEndpoints.has(t))throw new Error(t+" is not in the supported list of content-upload endpoints");const o={...this.csrfHeaders(),[e.ApiV2HeaderNames.DropboxApiArg]:this.http_header_safe_json(s),...this._headers(r)};if("string"==typeof n||void 0===n)return this.executeRpc(t,o,n||"","application/octet-stream",r.signal);{const e=new Blob([n],{type:"application/octet-stream"});return this.executeRpc(t,o,e,"application/octet-stream",r.signal)}}_download(e,t,s,n){return this._downloadWithResponseHeaders(e,t,s,n).then((e=>e.result))}_downloadWithResponseHeaders(t,s,n,r){if(void 0===r||!r.hasOwnProperty("dangerouslyFetchUserContent")||!r.dangerouslyFetchUserContent)throw new Error("download requires explicit acknowledgement of the risk");if(!this.downloadEndpoints.has(t))throw new Error(t+" does not use the content-download endpoint format");if(!this.supportedDownloadEndpoints.has(t))throw new Error(t+" is not in the supported list of content-download endpoints");const o={...this.csrfHeaders(),[e.ApiV2HeaderNames.DropboxApiArg]:this.http_header_safe_json(s),...this._headers(n)};return this.executeBinaryRpc(t,o,"","application/octet-stream",n.signal)}_rpc(e,t,s,n){return this._rpcWithResponseHeaders(e,t,s,n).then((e=>e.result))}_rpcWithResponseHeaders(e,t,s,n){const r={...this.csrfHeaders(),...this._headers(s)};if(this.downloadEndpoints.has(e))throw new Error(e+' does not use the rpc endpoint format. Use "download" instead');if(this.uploadEndpoints.has(e))throw new Error(e+' does not use the rpc endpoint format. Use "upload" instead');const o=JSON.stringify(t||null);return this.executeRpc(e,r,o,"application/json",s.signal,n)}csrfHeaders(){return this.skipCsrf||n.getPageAuthChannel()===n.AuthChannel.OAUTH_TOKEN?{}:{[e.ApiV2HeaderNames.CsrfToken]:r.mustReadCsrfToken()}}async executeRpc(e,s,n,o,i,a){const d=window.location.hostname===t.getDomains().CLIENT_WEB_WEBSERVER?t.getDomains().CLIENT_WEB_WEBSERVER:t.getDomains().WEBSERVER;const p=j();p&&(s["x-dropbox-client-yaps-attribution"]=p);const c=new r.URI({scheme:"https",authority:d,path:"/2/"+e,query:undefined});return await this.transport.executeRpc(c,s,n,o,i,a)}async executeBinaryRpc(e,s,n,o,i){const a=window.location.hostname===t.getDomains().CLIENT_WEB_WEBSERVER?t.getDomains().CLIENT_WEB_WEBSERVER:t.getDomains().WEBSERVER;const d=new r.URI({scheme:"https",authority:a,path:"/2/"+e,query:undefined});return await this.transport.executeBinaryRpc(d,s,n,o,i)}http_header_safe_json(e){return JSON.stringify(e).replace(/[\u007f-\uffff]/g,(function(e){return"\\u"+("000"+e.charCodeAt(0).toString(16)).slice(-4)}))}}function N(e){const t=this,s=(new Error).stack;return{rpc:function(n,r,o){return t._rpc(e+"/"+n,r,o,s)},rpcWithResponseHeaders:function(n,r,o){return t._rpcWithResponseHeaders(e+"/"+n,r,o,s)},upload:function(s,n,r,o){return t._upload(e+"/"+s,n,r,o)},uploadWithResponseHeaders:function(s,n,r,o){return t._uploadWithResponseHeaders(e+"/"+s,n,r,o)},download:function(s,n,r,o){return t._download(e+"/"+s,n,r,o)},downloadWithResponseHeaders:function(s,n,r,o){return t._downloadWithResponseHeaders(e+"/"+s,n,r,o)}}}var F=Object.freeze({__proto__:null,UnAuthedApiV2Client:class extends D{constructor(e){super(e,!0)}_headers(e){return{...e.headers}}}});e.ApiError=u,e.ApiV2ClientBase=D,e.AppError=h,e.CONFIG=T,e.FetchAbortError=w,e.FetchAsyncTransport=L,e.FetchFailError=b,e.FetchResponseError=E,e.FetchSyncTransport=class{executeRpc(e,t,n,r,o){return s.incrementAjaxCount(),k(),fetch(e.toString(),{method:"POST",mode:"same-origin",credentials:"same-origin",headers:{...t,"Content-Type":r},keepalive:!0,body:n,signal:o}).finally((()=>{s.decrementAjaxCount(),O()})),Promise.resolve({headers:{},result:{}})}executeBinaryRpc(e,t,n,r,o){return s.incrementAjaxCount(),k(),fetch(e.toString(),{method:"POST",mode:"same-origin",credentials:"same-origin",headers:{...t,"Content-Type":r},keepalive:!0,body:n,signal:o}).finally((()=>{s.decrementAjaxCount(),O()})),Promise.resolve({headers:{},result:new ArrayBuffer(0)})}},e.RateLimitError=f,e.ServerError=m,e.Union=d,e.UnionScalar=p,e.catchApiError=function(e){return function(t){if(_(t))return e(t);throw t}},e.decrementAjaxCount=O,e.errorIsFetchAbortError=function(e){return"FetchAbortError"===e.name},e.errorIsFetchFailError=function(e){return"FetchFailError"===e.name},e.errorIsFetchResponseError=x,e.filterApiError=e=>e instanceof u?e:void 0,e.getAttributionHeader=j,e.getNetworkIdleObservable=C,e.incrementAjaxCount=k,e.isApiError=_,e.isAppError=function(e){return e instanceof h},e.isAuthError=function(e){return e instanceof l},e.isRateLimitError=function(e){return e instanceof f},e.isServerError=function(e){return e instanceof m},e.unauthed_client_esnext=F}));
//# sourceMappingURL=c_api_v2_unauthed_client.js-vfl6QrVrP.map

//# debugId=2e30cc8e-1376-309f-a958-e929d3f37200