!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="1daa0fce-0380-318c-a938-1428a0de055d")}catch(e){}}();
define(["require","exports","./c_api_v2_unauthed_client","./c_api_v2_routes_growth_provider","./c_pap-events_navigation_select_create_folder_action","./c_memoize-one","./e_file_viewer_static_scl_page_file","./c_spectrum_util_raf_throttle","./e_data_modules_stormcrow","./e_edison","./c_bem","./c_core_i18n","./c_ui_over-quota-sweep-blocking-modal_show_over_quota_modal_or_continue","./c_upload_kit_lib_types","react","./c_stacks_lib_api"],(function(e,r,n,a,t,i,o,s,l,_,d,c,E,S,f,T){"use strict";function u(e){if(e&&e.__esModule)return e;var r=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}})),r.default=e,Object.freeze(r)}var O=u(f);var g,m,A,p,F,I,R;r.UserFlow=void 0,(g=r.UserFlow||(r.UserFlow={})).TRANSFER_MANAGEMENT_MODAL="transfer_management_modal",g.MANAGEMENT_LIST_VIEW="management_list_view",g.CREATION="creation",g.RECIPIENT="recipient",g.BROWSE="browse",g.TRANSFER_CREATION_MODAL="transfer_creation_modal",r.ModalVisibilityChange=void 0,(m=r.ModalVisibilityChange||(r.ModalVisibilityChange={})).OPEN="open",m.CANCEL="cancel",m.OK="ok",r.SettingsVisibilityChange=void 0,(A=r.SettingsVisibilityChange||(r.SettingsVisibilityChange={})).OPEN="open",A.CLOSE="close",r.TransferListView=void 0,(p=r.TransferListView||(r.TransferListView={}))[p.Active=0]="Active",p[p.Expired=1]="Expired",p[p.All=2]="All",r.Actions=void 0,(F=r.Actions||(r.Actions={})).ChangeSettingsModalState="FileTransfers/ChangeSettingsModalState",F.ChangeConfirmTransferDeletionModalState="FileTransfers/ChangeConfirmTransferDeletionModalState",F.LogCopyTransferLink="FileTransfers/LogCopyTransferLink",F.DeleteTransferSummary="FileTransfers/DeleteTransferSummary",F.ExpireTransferSummary="FileTransfers/ExpireTransferSummary",F.ReactivateTransferSummary="FileTransfers/ReactivateTransferSummary",F.FinishedEditing="FileTransfers/FinishedEditing",F.HideOnboardingStep="FileTransfers/HideOnboardingStep",F.InitApp="FileTransfers/InitApp",F.LogAllItemsUploaded="FileTransfers/LogAllItemsUploaded",F.LogAutoDownload="FileTransfers/LogAutoDownload",F.LogOnboarding="FileTransfers/LogOnboarding",F.LogEmailFeedback="FileTransfers/LogEmailFeedback",F.LogUpsell="FileTransfers/LogUpsell",F.MarkOnboardingStepComplete="FileTransfers/MarkOnboardingStepComplete",F.MarkServerRestrictedFiles="FileTransfers/MarkServerRestrictedFiles",F.MetadataUpdated="FileTransfers/MetadataUpdated",F.SendTransferViaEmail="FileTransfers/SendTransferViaEmail",F.ReceivedTransferRowClick="FileTransfers/ReceivedTransferRowClick",F.TransferManagementTabClick="FileTransfers/TransferManagementTabClick",F.SetActiveUserId="FileTransfers/SetActiveUserId",F.SetBackground="FileTransfers/SetBackground",F.SetBackgroundPreview="FileTransfers/SetBackroundPreview",F.SetLogo="FileTransfers/SetLogo",F.SaveLogo="FileTransfers/SaveLogo",F.SetCurrentTransfer="FileTransfers/SetCurrentTransfer",F.SetExpiration="FileTransfers/SetExpiration",F.SetIsShared="FileTransfers/SetShareStatus",F.SetIsShareComplete="FileTransfer/SetShareComplete",F.ChangeManagementModalState="FileTransfers/ChangeManagementModalState",F.SetProductConfig="FileTransfers/SetProductConfig",F.SetRecipients="FileTransfers/SetRecipients",F.SetShareUrl="FileTransfers/SetShareUrl",F.SetFileTransfersUserMetadata="FileTransfers/SetFileTransfersUserMetadata",F.UpdateTransferSummaries="FileTransfers/UpdateTransferSummaries",F.UpdateReceivedTransferSummaries="FileTransfers/UpdateReceivedTransferSummaries",F.ViewFeedbackForm="FileTransfers/ViewFeedbackForm",F.TemporarilySaveEmailFormInfo="FileTransfers/TemporarilySaveEmailFormInfo",F.ClearSavedEmailFormInfo="FileTransfers/ClearSavedEmailFormInfo",F.LogInternetDisconnected="FileTransfers/LogInternetDisconnected",F.LogOnboardingStepShown="FileTransfers/LogOnboardingStepShown",F.MarkOnboardingStepShown="FileTransfers/MarkOnboardingStepShown",F.LogShareError="FileTransfers/LogShareError",F.UpdateSettingsFromManagementModal="FileTransfers/UpdateSettingsFromManagementModal",F.LogSettingsClicked="LogSettingsClicked",F.RemoveReceivedTransferFromList="FileTransfers/RemoveReceivedTransferFromList",F.LogRemoveReceivedTransferClicked="FileTransfers/LogRemoveReceivedTransferClicked",F.LogViewReplayFileTransferPrompt="FileTransfers/ViewReplayFileTransferPrompt",F.LogClickReplayFileTransferPrompt="FileTransfers/ClickReplayFileTransferPrompt",F.LogClickDownloadSUSIFooter="FileTransfers/LogClickDownloadSUSIFooter",F.LogHeadlessBrowserDetected="FileTransfers/LogHeadlessBrowserDetected",r.ExpirationOption=void 0,(I=r.ExpirationOption||(r.ExpirationOption={}))[I.SEVEN_DAYS=7]="SEVEN_DAYS",I[I.THIRTY_DAYS=30]="THIRTY_DAYS",I[I.NINETY_DAYS=90]="NINETY_DAYS",I[I.CUSTOM=0]="CUSTOM",function(e){e.EXPIRED="expired",e.SHARED="shared"}(R||(R={}));var D,N,L;r.ExpirationOption.SEVEN_DAYS,r.ExpirationOption.SEVEN_DAYS,r.ExpirationOption.THIRTY_DAYS,function(e){e.WAITING="waiting",e.FAILED="failed",e.UPLOADING="uploading",e.COMPLETED="completed"}(D||(D={})),s.computeDomains(null!==(N=window.__DEV_SERVER_HOSTNAME__)&&void 0!==N?N:"")[0].WEB_STATIC_CLOUDFLARE_CDN_HOST,s.computeDomains(null!==(L=window.__DEV_SERVER_HOSTNAME__)&&void 0!==L?L:"")[0].WEB_STATIC_CLOUDFLARE_CDN_HOST;const C="NULL";var v,h,M;!function(e){e.CUSTOMIZE_DESIGN="customize_design",e.DOWNLOAD_ALL="download_all",e.DISABLE_DOWNLOAD_NOTIFICATIONS="disable_download_notifications",e.EMAIL_JUST_VERIFIED="email_just_verified",e.EMAIL_TYPE="email_type",e.FEEDBACK="feedback",e.LIKE_EMAIL="like_email",e.RECP_TRACKING="ftref",e.SAVE_TO_DROPBOX="s2d",e.SEND_REMINDERS="send_reminders",e.MANAGEMENT_RECEIVED_DOWNLOAD="management_received_download"}(v||(v={})),function(e){e[e.ADD_FILES=0]="ADD_FILES",e[e.UPLOAD_PROGRESS=1]="UPLOAD_PROGRESS",e[e.REDESIGNED_EMAIL_SENT_CONFIRMATION=2]="REDESIGNED_EMAIL_SENT_CONFIRMATION",e[e.REDESIGNED_SHARE_LINK_CONFIRMATION=3]="REDESIGNED_SHARE_LINK_CONFIRMATION"}(h||(h={})),function(e){e[e.VIEW_FILES=0]="VIEW_FILES",e[e.DOWNLOAD_CONFIRMATION=1]="DOWNLOAD_CONFIRMATION"}(M||(M={}));var w;!function(e){e.CUSTOM_BACKGROUND="custom_background",e.EXPIRATION="expiration",e.EXPIRED_TRANSFERS="expired_transfers",e.OVER_LIMIT="over_limit",e.PASSWORD="password",e.TRANSFER_LOGO="transfer_logo",e.SHOW_WHO_HAS_DOWNLOADED="show_who_has_downloaded",e.MANAGE_PAGE_UPSELL_BANNER="manage_page_upsell_banner",e.SHARING_SETTINGS_UPSELL_BANNER="sharing_settings_upsell_banner"}(w||(w={}));var b,y;o.format_bytes$1(107374182400,0),o.format_bytes$1(268435456e3,0),function(e){e.ABOUT_PAGE="about",e.CREATE_PAGE="create",e.VIEW_PAGE="view",e.VIEW_EXPIRED_PAGE="view_expired",e.VIEW_DELETED_PAGE="view_deleted",e.LIST_PAGE="list"}(b||(b={})),function(e){e.TRY_PROFESSIONAL="try_professional",e.BUY_PROFESSIONAL="buy_professional",e.CONTACT_ADMIN="contact_admin",e.TRY_BUSINESS_ADVANCED="try_business_advanced",e.BUY_TRANSFER="buy_transfer"}(y||(y={}));var P,U,k,V,B,G;r.UploadStatus=void 0,(P=r.UploadStatus||(r.UploadStatus={}))[P.Waiting=0]="Waiting",P[P.Uploading=1]="Uploading",P[P.Success=2]="Success",P[P.Error=3]="Error",function(e){e.Dropbox="dropbox",e.Computer="computer",e.Transfer="transfer"}(U||(U={})),r.OriginalFileSource=void 0,(k=r.OriginalFileSource||(r.OriginalFileSource={})).Dropbox="dropbox",k.Computer="computer",k.Unknown="unknown",function(e){e.DRAG_DROP="drag_drop",e.DROPBOX_CHOOSER_ADDITIONAL="dropbox_chooser_additional",e.DROPBOX_CHOOSER_INITIAL="dropbox_chooser_initial",e.UPLOAD_BUTTON_ADDITIONAL="upload_button_additional",e.UPLOAD_BUTTON_INITIAL="upload_button_initial",e.DESKTOP_CONTEXT_MENU="desktop_context_menu",e.PAGELET_ON_LOAD="pagelet_on_load",e.TRANSFER_CREATION_MODAL_ON_LOAD="transfer_creation_modal_on_load"}(V||(V={})),function(e){e.EmptyFile="empty_file",e.IgnoredFile="ignored_file",e.OverMaxFileSize="over_max_file_size",e.PointerFile="pointer_file",e.TemporaryFile="temporary_file",e.InvalidChar="invalid_char",e.TimeOut="time_out",e.NotFound="not_found",e.NoPermission="no_permission",e.Restricted="restricted",e.InvalidArgs="invalid_args",e.Unknown="unknown"}(B||(B={})),function(e){e.CancelButton="cancel_button",e.WindowClose="window_close"}(G||(G={}));var x;function W(e){return r=>function(e){return e.value?e.value[".tag"]:"other"}(r)===e}!function(e){e[e.NOT_STARTED=0]="NOT_STARTED",e[e.DOWNLOADING=1]="DOWNLOADING",e[e.ERROR=2]="ERROR",e[e.PAUSED=3]="PAUSED",e[e.FETCHING_TOKENS=4]="FETCHING_TOKENS",e[e.CANCELED=5]="CANCELED",e[e.COMPLETED=6]="COMPLETED"}(x||(x={}));const H=W("image"),Y=W("video");const K="custom:get_all_stacks",q=o.getCustomRequestQueryKey(K),Q=o.createCustomRequestQuery({requestMethod:K,queryFn:()=>async()=>{const e=(await T.GetStacksRoutes(new o.ActiveUserApiV2Client).rpc("query_stacks",{fields:{name:!0,max_hlc:!0,sharing_data:!0},stack_types:{fss_stacks:!0}},{})).stacks||[];return e.sort(((e,r)=>{var n,a;const t=e.max_hlc_micros||0,i=r.max_hlc_micros||0,o=null===(n=e.user_data)||void 0===n?void 0:n.is_pinned;return!!o==!!(null===(a=r.user_data)||void 0===a?void 0:a.is_pinned)?i-t:o?-1:1})),{apiData:e,pkgData:null}},getQueryKey:q});r.COMPLETED_TRANSFER_BROWSE_ENTRY_ONBOARDING="completedTransferBrowseEntryOnboarding",r.CUSTOM_BACKGROUND_ID="custom",r.CUSTOM_LOGO_ID="custom_logo",r.NULL_FILE_TRANSFER_KEY=C,r.asyncAddToStack=async(r,n,a,t,i)=>{(e=>{e.invalidateQueries({queryKey:q()}),Q.prefetchQuery(e,{})})(n);const{AddToStackModal:s}=await new Promise((function(r,n){e(["./c_stacks_add_to_stack"],r,n)}));return o.Modal$1.showInstance(O.createElement(l.QueryClientProvider,{client:n},O.createElement(c.Provider,{value:r},O.createElement(s,{files:t,navigate:a,stackName:i}))))},r.asyncShowBrowseEntryPointOnboardingModal=r=>{new Promise((function(r,n){e(["./c_file_transfers_containers_browse_entry_point_onboarding_modal"],r,n)})).then((({showBrowseEntryPointOnboardingModal:e})=>e(r)))},r.folderEligibleForTransfer=e=>!o.File.isNoAccessSharedFolder(e),r.getLocalStorageBooleanValueForKey=function(e){const r=localStorage.getItem(e);return null===r?null:"true"===r},r.getTransferFilesKey=function(e){return e||C},r.isAtRoot=function(e){return null===function(e){let r;if("dest"in e)r=e.dest;else if("fullPath"in e){if(!e.fullPath)return null;r=e.fullPath,"/"===r.charAt(0)&&(r=e.fullPath.substring(1))}else{if(!("path"in e))throw new Error("file must be either PluploadFile, StateFileInfo, or FileSystemEntry");if(!e.path)return null;r=e.path}const n=r.split("/");if(n.length<=1)return null;return n[0]}(e)},r.isColorBackground=function(e){return!!e.color_hex&&!e.asset},r.isImageBackground=function(e){return!!e.asset&&H(e.asset)},r.isVideoBackground=function(e){return!!e.asset&&Y(e.asset)},r.redirectToCreateTransferWithFiles=(e,r)=>{E.showOQModalOrContinue({action:"transfer",continueCallback:function(){const n=function(e){return e.map((e=>e.file_id.replace("id:",""))).join(".")}(e);var a;o.Snackbar.sync(c.intl.formatMessage({id:"EmOY+w",defaultMessage:"Creating new transfer..."}),!1,"create-transfer"),o.redirect((a={referrer:r,fileids:n},new i.URI({scheme:"https",authority:s.getDomains().WEBSERVER,path:"/transfer",query:a}).toString()))},abortCallback:()=>{}})},r.setLocalStorageValueForKey=function(e,r){localStorage.setItem(e,r.toString())},r.shouldShowTransferInSplitShare=(e,r)=>e&&r.length>0&&!r.some((e=>e.is_cloud_doc))&&!r.some(o.File.isNoAccessSharedFolder),r.useAllStacks=()=>Q.useQuery({})}));
//# sourceMappingURL=c_stacks_async_add_to_stack.js-vflKo-az2.map

//# debugId=1daa0fce-0380-318c-a938-1428a0de055d