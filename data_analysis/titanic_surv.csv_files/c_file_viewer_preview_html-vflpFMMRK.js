!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="9e4bb9eb-c4f0-305c-b71c-e7b9b7850120")}catch(e){}}();
define(["exports","./e_file_viewer_static_scl_page_file","react","./c_file_viewer_preview_error_open_in_dropdown","./c_file_viewer_ui_header","./c_api_v2_routes_growth_provider","./e_core_exception","./c_src_sink_index","./c_bem","./c_lodash-es_lodash","./c_hive_schemas_sharing-request_access_user_events","./e_edison","./c_pap-events_navigation_select_create_folder_action","./c_init_data_edison","./c_memoize-one","./c_react-use_misc_util","./e_data_modules_stormcrow","./c_chat_chat_constants","./c_api_v2_unauthed_client","./c_spectrum_util_raf_throttle","./c_core_i18n","metaserver/static/js/langpack","./c_core_notify","react-dom","./c_security_csrf_hmac","./c_react_jsx-runtime","./c_watermarking_utils_getImageDefaultSizes"],(function(e,t,r,i,s,n,a,o,d,l,c,u,h,g,p,m,_,w,f,v,C,y,F,E,P,S,O){"use strict";function M(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(r){if("default"!==r){var i=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:function(){return e[r]}})}})),t.default=e,Object.freeze(t)}var K=M(r),k={};!function(e){var t;Object.defineProperty(e,"__esModule",{value:!0}),(t=e.Key||(e.Key={}))[t.Backspace=8]="Backspace",t[t.Tab=9]="Tab",t[t.Enter=13]="Enter",t[t.Shift=16]="Shift",t[t.Ctrl=17]="Ctrl",t[t.Alt=18]="Alt",t[t.PauseBreak=19]="PauseBreak",t[t.CapsLock=20]="CapsLock",t[t.Escape=27]="Escape",t[t.Space=32]="Space",t[t.PageUp=33]="PageUp",t[t.PageDown=34]="PageDown",t[t.End=35]="End",t[t.Home=36]="Home",t[t.LeftArrow=37]="LeftArrow",t[t.UpArrow=38]="UpArrow",t[t.RightArrow=39]="RightArrow",t[t.DownArrow=40]="DownArrow",t[t.Insert=45]="Insert",t[t.Delete=46]="Delete",t[t.Zero=48]="Zero",t[t.ClosedParen=48]="ClosedParen",t[t.One=49]="One",t[t.ExclamationMark=49]="ExclamationMark",t[t.Two=50]="Two",t[t.AtSign=50]="AtSign",t[t.Three=51]="Three",t[t.PoundSign=51]="PoundSign",t[t.Hash=51]="Hash",t[t.Four=52]="Four",t[t.DollarSign=52]="DollarSign",t[t.Five=53]="Five",t[t.PercentSign=53]="PercentSign",t[t.Six=54]="Six",t[t.Caret=54]="Caret",t[t.Hat=54]="Hat",t[t.Seven=55]="Seven",t[t.Ampersand=55]="Ampersand",t[t.Eight=56]="Eight",t[t.Star=56]="Star",t[t.Asterik=56]="Asterik",t[t.Nine=57]="Nine",t[t.OpenParen=57]="OpenParen",t[t.A=65]="A",t[t.B=66]="B",t[t.C=67]="C",t[t.D=68]="D",t[t.E=69]="E",t[t.F=70]="F",t[t.G=71]="G",t[t.H=72]="H",t[t.I=73]="I",t[t.J=74]="J",t[t.K=75]="K",t[t.L=76]="L",t[t.M=77]="M",t[t.N=78]="N",t[t.O=79]="O",t[t.P=80]="P",t[t.Q=81]="Q",t[t.R=82]="R",t[t.S=83]="S",t[t.T=84]="T",t[t.U=85]="U",t[t.V=86]="V",t[t.W=87]="W",t[t.X=88]="X",t[t.Y=89]="Y",t[t.Z=90]="Z",t[t.LeftWindowKey=91]="LeftWindowKey",t[t.RightWindowKey=92]="RightWindowKey",t[t.SelectKey=93]="SelectKey",t[t.Numpad0=96]="Numpad0",t[t.Numpad1=97]="Numpad1",t[t.Numpad2=98]="Numpad2",t[t.Numpad3=99]="Numpad3",t[t.Numpad4=100]="Numpad4",t[t.Numpad5=101]="Numpad5",t[t.Numpad6=102]="Numpad6",t[t.Numpad7=103]="Numpad7",t[t.Numpad8=104]="Numpad8",t[t.Numpad9=105]="Numpad9",t[t.Multiply=106]="Multiply",t[t.Add=107]="Add",t[t.Subtract=109]="Subtract",t[t.DecimalPoint=110]="DecimalPoint",t[t.Divide=111]="Divide",t[t.F1=112]="F1",t[t.F2=113]="F2",t[t.F3=114]="F3",t[t.F4=115]="F4",t[t.F5=116]="F5",t[t.F6=117]="F6",t[t.F7=118]="F7",t[t.F8=119]="F8",t[t.F9=120]="F9",t[t.F10=121]="F10",t[t.F11=122]="F11",t[t.F12=123]="F12",t[t.NumLock=144]="NumLock",t[t.ScrollLock=145]="ScrollLock",t[t.SemiColon=186]="SemiColon",t[t.Equals=187]="Equals",t[t.Comma=188]="Comma",t[t.Dash=189]="Dash",t[t.Period=190]="Period",t[t.UnderScore=189]="UnderScore",t[t.PlusSign=187]="PlusSign",t[t.ForwardSlash=191]="ForwardSlash",t[t.Tilde=192]="Tilde",t[t.GraveAccent=192]="GraveAccent",t[t.OpenBracket=219]="OpenBracket",t[t.ClosedBracket=221]="ClosedBracket",t[t.Quote=222]="Quote"}(k);class N{constructor(e,t=(e=>JSON.parse(e.data)),r=(e=>JSON.stringify(e))){this._window=window,this.handleUntrustedMessage=e=>{if(!this.isOriginAllowed(e.origin))return;let t;try{t=this.receiveMessageConverter(e)}catch(e){return}null!=t.action&&this.handleTrustedMessage(e,t)},this.allowedOrigins=e,this.receiveMessageConverter=t,this.sendMessageConverter=r}getWindow(){return this._window}setWindow(e){this._window=e}startListening(){this.getWindow().addEventListener("message",this.handleUntrustedMessage)}stopListening(){this.getWindow().removeEventListener("message",this.handleUntrustedMessage)}regexIn(e,t){for(const r of t){if(r instanceof RegExp&&e.match(r))return!0;if("string"==typeof r&&r===e)return!0}return!1}static stripStandardPort(e){return"http://"===e.substr(0,7)?e.replace(/:80$/,""):"https://"===e.substr(0,8)?e.replace(/:443$/,""):e}isOriginAllowed(e){return this.regexIn(N.stripStandardPort(e),this.allowedOrigins)}packagePostMessage(e,t){const r={action:e,parameters:t};return this.sendMessageConverter(r)}}class A extends N{constructor(){super(...arguments),this.trustedChildOriginForPosting=null,this.validActionsFromChild=[],this.trustedMessageFromChildHandler=null,this.getChildIframes=()=>[]}configureChildMessaging(e,t,r){if("string"==typeof e){const t=e;this.getChildIframes=()=>[].slice.call(document.querySelectorAll(t),0)}else this.getChildIframes=e;this.trustedChildOriginForPosting=null,this.validActionsFromChild=r,this.trustedMessageFromChildHandler=t}startListening(){super.startListening(),this.postMessageToChildren("parent-ready")}getTrustedChildOriginForPosting(){if(null!=this.trustedChildOriginForPosting)return this.trustedChildOriginForPosting;const e=this.getChildIframes();for(const t of e){const e=""+t.getAttribute("src"),r=this.getOriginFromUrl(e);if(this.isOriginAllowed(r))return this.updateChildOrigin(r),this.trustedChildOriginForPosting}return this.trustedChildOriginForPosting}childIsValidated(){return null!=this.trustedChildOriginForPosting}isNumber(e){return!isNaN(parseInt(e,10))}getOriginFromUrl(e){const t=document.createElement("a");t.href=e;const r=t.origin;if(r)return"null"===r?"*":r;const i=this.isNumber(t.port)?`:${t.port}`:"";return`${t.protocol}//${t.hostname}${i}`}postMessageToChildren(e,t={}){const r=this.getChildIframes();this.postMessageToChildElements(r,e,t)}resetOriginsForPosting(){this.trustedChildOriginForPosting=null}updateChildOrigin(e){"null"===e&&(e="*"),this.trustedChildOriginForPosting=e}handleTrustedMessage(e,t){this.updateChildOrigin(e.origin),"child-requesting-parent-origin"===t.action&&this.postMessageToChildren("parent-ready"),-1!==this.validActionsFromChild.indexOf(t.action)&&null!=this.trustedMessageFromChildHandler&&this.trustedMessageFromChildHandler(t)}postMessageToChildElements(e,t,r={}){const i=this.getTrustedChildOriginForPosting();if(null==i)return;const s=this.packagePostMessage(t,r);e.forEach((e=>{e.contentWindow&&e.contentWindow.postMessage(s,i)}))}}class b extends A{constructor(e){const t=e.map((e=>`https://${e}`));t.push("null"),t.push(RegExp(".*previews.*.dropboxusercontent.com")),super(t)}}t.injectInternalStyle("/static/js/file_viewer/preview_html/preview-html.module.out-vfl06p2QL.css",(e=>"._app_1i0md_1{align-items:flex-end;display:flex;flex:1;flex-grow:1;height:100%;justify-content:center;position:relative;width:100%}._app-with-padding_1i0md_12{padding:30px 50px}._previewContent_1i0md_16{background:var(--dig-color__background__base);border:none;display:flex;flex:1;height:100%}"));const L={FAILED:"failed",KEYDOWN_KEYS:"get-keydown-keys-handled-by-parent",KEYDOWN:"keydown",VIEWER_READY:"viewer-ready",ACTIVE_MOUSE:"active-mouse"},x=Object.values(L),D="print",T="keydown-keys-handled-by-parent",I="previewhtml",R={[k.Key.RightArrow]:{altKey:!0,ctrlKey:!0,metaKey:!0},[k.Key.LeftArrow]:{altKey:!0,ctrlKey:!0,metaKey:!0},[k.Key.Backspace]:{altKey:!0,ctrlKey:!0,metaKey:!0},[k.Key.Delete]:{altKey:!0,ctrlKey:!0,metaKey:!0},[k.Key.Escape]:{altKey:!0,ctrlKey:!0,metaKey:!0},[k.Key.F]:{altKey:!0,ctrlKey:!0,metaKey:!0}},W=e=>{const{fileConfig:r,isRawHtml:n,fileMetadata:a,previewMetadata:o,previewKey:d,onRenderSucceeded:l,previewSessionId:c,setLocalError:u,header:h}=e,g=o&&o.preview_url,p=a&&a.file_name,m=K.useRef(),_=t.useRenderSucceededWithLogging(c,l),w=e=>{var r,s;if((e=>x.includes(e.action))(e))switch(e.action){case L.FAILED:const n=null===(r=null==e?void 0:e.parameters)||void 0===r?void 0:r.rivieraStatusCode;if(n===t.RivieraStatus.PasswordProtected){const e=i.isMSOfficeFile(p)?t.FVErrorCode.OfficeFilePasswordProtected:t.FVErrorCode.PasswordProtected;u(new t.FVError(e,t.ErrorLifecycle.Render))}else null!=n&&u(new t.FVError(t.FVErrorCode.RivieraDataFetchFailure,t.ErrorLifecycle.Render));break;case L.VIEWER_READY:_();break;case L.KEYDOWN_KEYS:null===(s=m.current)||void 0===s||s.postMessageToChildren(T,{keycodes:R});break;case L.KEYDOWN:const a=new KeyboardEvent("keydown",e.parameters);document.dispatchEvent(a);break;case L.ACTIVE_MOUSE:window.dispatchEvent(new MouseEvent("mousemove"))}};K.useEffect((()=>{if(!n)return m.current=new b([]),m.current.configureChildMessaging(`iframe.${I}`,w,x),m.current.startListening(),m.current.postMessageToChildren(T,{keycodes:[]}),()=>{var e;null===(e=m.current)||void 0===e||e.stopListening()}}),[]);const f=t.useStabilizedCallback((()=>{n&&_()})),v=t.useStabilizedCallback((()=>{var e;null===(e=m.current)||void 0===e||e.postMessageToChildren(D,{context:t.UserActionContext.Toolbar})})),{setPrintCallback:C}=t.usePreviewControls();K.useEffect((()=>(null==C||C(v),()=>{null==C||C(void 0)})),[v,C]);const y=r.enable_print&&(e=>!(e&&t.isNestedArchiveFilePreviewKey(e)))(d)?"allow-modals allow-scripts":"allow-scripts";return K.createElement(s.ContentHeader,{header:h},K.createElement("div",{className:t.cx("_app_1i0md_1",{"_app-with-padding_1i0md_12":n})},K.createElement("iframe",{title:p,name:"preview-content",src:g,sandbox:y,className:t.cx(I,"_previewContent_1i0md_16"),onLoad:f,"data-testid":"fvsdk_html_iframe"})))};W.displayName="UnconnectedPreviewHTML";const H=e=>{const{previewKey:r}=e,i=t.useCurrentFileMetadata(),s=t.usePreviewMetadataForPreviewKey(r);return s?K.createElement(W,{...e,fileMetadata:i,previewMetadata:s}):null};H.displayName="PreviewHTML",e.PreviewHTML=H}));
//# sourceMappingURL=c_file_viewer_preview_html.js-vfldSF3QD.map

//# debugId=9e4bb9eb-c4f0-305c-b71c-e7b9b7850120