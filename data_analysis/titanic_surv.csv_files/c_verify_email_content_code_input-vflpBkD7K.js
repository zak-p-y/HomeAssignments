!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="3c215c68-e490-3ff0-b3ca-b0a0086900ae")}catch(e){}}();
define(["exports","react","./e_file_viewer_static_scl_page_file","./c_core_i18n","./c_api_v2_unauthed_client"],(function(e,t,a,r,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var o=n(t);a.injectInternalStyle("/static/metaserver/static/js/auth/verify_email/content/default.module.out-vflED8wbl.css",(e=>"._resend-button_1k60n_1{color:var(--Primary-On-Surface,#0057e0)}._code-text-input-wrapper_1k60n_5{border-radius:8px;height:80px;padding:0}._code-text-input-wrapper_1k60n_5._code-text-input-wrapper--xsmall_1k60n_15{height:60px}._code-text-input-wrapper_1k60n_5 input._code-text-input_1k60n_5[type=text]{font-size:28px;line-height:1em;padding:var(--dig-spacing__micro__xlarge);text-align:center;width:1ch}._code-text-input-wrapper_1k60n_5 input._code-text-input-small_1k60n_29[type=text]{font-size:28px;line-height:1em;padding:var(--dig-spacing__micro__large);text-align:center;width:1ch}._code-text-input-wrapper_1k60n_5 input._code-text-input-xsmall_1k60n_37[type=text]{font-size:28px;line-height:1em;padding:var(--dig-spacing__micro__medium);text-align:center;width:1ch}@media (max-width:456px){._code-text-input-wrapper_1k60n_5{height:80px}._code-text-input-wrapper_1k60n_5 input._code-text-input_1k60n_5[type=text]{font-size:20px;padding:0 var(--dig-spacing__micro__large)}._verify-email-wrapper_1k60n_55{max-width:456px}}"));var l;function c(e){return{class:"verify_email",action:"start",object:"email_verification_component_code_input",properties:e}}!function(e){e.DEFAULT="default",e.CODE="code"}(l||(l={}));const s=r.intl.formatMessage({id:"HSJula",defaultMessage:"Double-check the code and try again."}),_=r.intl.formatMessage({id:"UDcbjZ",defaultMessage:"Too many attempts. Please try again later."}),d=r.intl.formatMessage({id:"9Hycd5",defaultMessage:"Unable to verify code. Please try again later."});var u;!function(e){e.ATTEMPT_RATE_EXCEEDED="err_attempt_rate_exceeded",e.VERIFICATION_CODE_INVALID="err_verification_code_invalid",e.OTHER="err_other"}(u||(u={}));const p={attempt_rate_exceeded:u.ATTEMPT_RATE_EXCEEDED,verification_code_invalid:u.VERIFICATION_CODE_INVALID,incorrect_email_mfa:u.VERIFICATION_CODE_INVALID};e.CodeInput=e=>{const n=t.useRef(Array.from({length:6},(()=>t.createRef()))),[m,f]=t.useState(Array(6).fill("")),[g,E]=t.useState(e.twoFactorError||null),[x,v]=t.useState(!1),[y,h]=t.useState(!1),D=t.useRef("code-input-error-message");t.useEffect((()=>{x||e.twoFactorError&&(k(),h(!0),E(e.twoFactorError))}),[e.twoFactorError,x]);const C=(e,t)=>{f(m.map(((a,r)=>r===e?t:a)))},k=()=>{f(Array(6).fill("")),T(0)};t.useEffect((()=>{const t=m.join("");e.onCodeChange&&e.onCodeChange(t),t.length>0&&(h(!1),E(null)),m.every((e=>""!==e))&&w()}),[m]);const w=async()=>{var t,r;if(!x){try{v(!0),E(null),a.UDCL.logStart(c({actionSurface:e.surface,verifyEmailComponent:l.CODE}),{tags:{action_surface:e.surface,verify_email_component:l.CODE}}),await e.onSubmit(m.join("")),a.UDCL.logEnd(c({actionSurface:e.surface,verifyEmailComponent:l.CODE,eventState:"success"}),{tags:{action_surface:e.surface,verify_email_component:l.CODE}}),h(!1),e.onSuccess&&e.onSuccess()}catch(n){const o=null===(r=null===(t=i.filterApiError(n))||void 0===t?void 0:t.error)||void 0===r?void 0:r[".tag"],m=p[o];m?(a.UDCL.logEnd(c({actionSurface:e.surface,verifyEmailComponent:l.CODE,eventState:"rejected"}),{tags:{action_surface:e.surface,verify_email_component:l.CODE,verify_email_fail_reason:m}}),m===u.ATTEMPT_RATE_EXCEEDED?E(_):E(s)):(a.UDCL.logEnd(c({actionSurface:e.surface,verifyEmailComponent:l.CODE,eventState:"failed"}),{tags:{action_surface:e.surface,verify_email_component:l.CODE,verify_email_fail_reason:u.OTHER}}),E(d)),e.onError&&e.onError(n),h(!0),k()}v(!1)}},T=e=>{if(!(e>=6)&&e<6&&e>=0){const t=n.current[e].current;t.focus(),t.select()}},I=e=>e.replace(/[^\d]/g,""),S="small"===e.size?"small":"medium";return o.default.createElement(a.FormRow,null,o.default.createElement(a.Split,{gap:"small"===e.size?"Micro Small":"xsmall"===e.size?{small:"Micro Large",xsmall:"Micro Small"}:"Micro Large",alignX:"center"},m.map(((t,i)=>o.default.createElement(a.Split.Item,{key:`code-text-input-${i}`},o.default.createElement(a.TextInput,{id:`code-text-input-${i}`,"data-testid":`code-test-input-${i}`,ref:n.current[i],autoFocus:0===i,isInvalid:y&&0===i,"aria-errormessage":y?D.current:void 0,"aria-describedby":y?D.current:void 0,maxLength:1,width:1,size:S,"aria-label":r.intl.formatMessage({id:"yIGE4g",defaultMessage:"Email code verification input field {index}"},{index:i+1}),className:"small"===e.size?"_code-text-input-small_1k60n_29":"xsmall"===e.size?"_code-text-input-xsmall_1k60n_37":"_code-text-input_1k60n_5",wrapperProps:{className:a.cx("_code-text-input-wrapper_1k60n_5",{"_code-text-input-wrapper--xsmall_1k60n_15":"xsmall"===e.size})},onChange:t=>((t,a)=>{const r=I(t.target.value);e.logCodeFilled&&e.logCodeFilled(),r.length>0&&(C(a,r),T(a+1))})(t,i),onKeyDown:e=>((e,t)=>{"e"===e.key?e.preventDefault():"Backspace"===e.key?(T(t-1),C(t,""),e.preventDefault()):"ArrowUp"===e.key||"ArrowDown"===e.key?e.preventDefault():"ArrowLeft"===e.key?(T(t-1),e.preventDefault()):"ArrowRight"===e.key?(T(t+1),e.preventDefault()):e.key>="0"&&e.key<="9"&&m[t]===e.key&&(e.preventDefault(),T(t+1))})(e,i),onFocus:e=>e.target.select(),onPaste:e=>((e,t)=>{e.preventDefault();const a=e.clipboardData,r=I(a.getData("Text"));if(0===r.length)return;const i=t+r.length,n=[...m.slice(0,t),...r.split(""),...m.slice(r.length+t)].slice(0,6);f(n),T(i)})(e,i),value:t,autoComplete:"one-time-code",disabled:!!e.disabled}))))),o.default.createElement(o.default.Fragment,null,null!==g&&o.default.createElement(a.Box,{marginTop:"16",paddingTop:"2",paddingBottom:"8",paddingLeft:"12",paddingRight:"12"},o.default.createElement(a.FormHelperText,{variant:"alert"},o.default.createElement(a.Box,{display:"flex",alignItems:"center",role:"alert","aria-live":"assertive","aria-atomic":"true",id:D.current},o.default.createElement(a.UIIcon,{src:a.FailLine,size:"medium"}),o.default.createElement(a.Text,{color:"error",size:"medium"},g))))))}}));
//# sourceMappingURL=c_verify_email_content_code_input.js-vflNmnc1d.map

//# debugId=3c215c68-e490-3ff0-b3ca-b0a0086900ae